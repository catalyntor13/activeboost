module.exports=[44988,56325,63411,43233,4775,92352,22360,88274,69e3,18899,e=>{"use strict";let t,i,r=Symbol.for("drizzle:entityKind");function n(e,t){if(!e||"object"!=typeof e)return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,r))throw Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let i=Object.getPrototypeOf(e).constructor;if(i)for(;i;){if(r in i&&i[r]===t[r])return!0;i=Object.getPrototypeOf(i)}return!1}Symbol.for("drizzle:hasOwnEntityKind"),e.s(["entityKind",()=>r,"is",()=>n],44988);class s{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static [r]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}e.s(["Column",()=>s],56325);class o{static [r]="ColumnBuilder";config;constructor(e,t,i){this.config={name:e,keyAsName:""===e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:i,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){""===this.config.name&&(this.config.name=e)}}let a=Symbol.for("drizzle:Name");class l{static [r]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:t,columns:i,foreignColumns:r}=e();return{name:t,columns:i,foreignTable:r[0].table,foreignColumns:r}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=void 0===e?"no action":e,this}onDelete(e){return this._onDelete=void 0===e?"no action":e,this}build(e){return new u(e,this)}}class u{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static [r]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:i}=this.reference(),r=t.map(e=>e.name),n=i.map(e=>e.name),s=[this.table[a],...r,i[0].table[a],...n];return e??`${s.join("_")}_fk`}}function c(e,...t){return e(...t)}function h(e,t){return`${e[a]}_${t.join("_")}_unique`}e.s(["ForeignKeyBuilder",()=>l],63411);class f{constructor(e,t){this.name=t,this.columns=e}static [r]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new p(e,this.columns,this.nullsNotDistinctConfig,this.name)}}class d{static [r]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new f(e,this.name)}}class p{constructor(e,t,i,r){this.table=e,this.columns=t,this.name=r??h(this.table,this.columns.map(e=>e.name)),this.nullsNotDistinct=i}static [r]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}function g(e,t,i){for(let r=t;r<e.length;r++){let n=e[r];if("\\"===n){r++;continue}if('"'===n)return[e.slice(t,r).replace(/\\/g,""),r+1];if(!i&&(","===n||"}"===n))return[e.slice(t,r).replace(/\\/g,""),r]}return[e.slice(t).replace(/\\/g,""),e.length]}e.s(["UniqueConstraintBuilder",()=>f,"uniqueKeyName",()=>h],43233);class m extends o{foreignKeyConfigs=[];static [r]="PgColumnBuilder";array(e){return new v(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:i,actions:r})=>c((i,r)=>{let n=new l(()=>({columns:[e],foreignColumns:[i()]}));return r.onUpdate&&n.onUpdate(r.onUpdate),r.onDelete&&n.onDelete(r.onDelete),n.build(t)},i,r))}buildExtraConfigColumn(e){return new b(e,this.config)}}class y extends s{constructor(e,t){t.uniqueName||(t.uniqueName=h(e,[t.name])),super(e,t),this.table=e}static [r]="PgColumn"}class b extends y{static [r]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}}class w{static [r]="IndexedColumn";constructor(e,t,i,r){this.name=e,this.keyAsName=t,this.type=i,this.indexConfig=r}name;keyAsName;type;indexConfig}class v extends m{static [r]="PgArrayBuilder";constructor(e,t,i){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=i}build(e){let t=this.config.baseBuilder.build(e);return new S(e,this.config,t)}}class S extends y{constructor(e,t,i,r){super(e,t),this.baseColumn=i,this.range=r,this.size=t.size}size;static [r]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(e){return"string"==typeof e&&(e=function(e){let[t]=function e(t,i=0){let r=[],n=i,s=!1;for(;n<t.length;){let o=t[n];if(","===o){(s||n===i)&&r.push(""),s=!0,n++;continue}if(s=!1,"\\"===o){n+=2;continue}if('"'===o){let[e,i]=g(t,n+1,!0);r.push(e),n=i;continue}if("}"===o)return[r,n+1];if("{"===o){let[i,s]=e(t,n+1);r.push(i),n=s;continue}let[a,l]=g(t,n,!1);r.push(a),n=l}return[r,n]}(e,1);return t}(e)),e.map(e=>this.baseColumn.mapFromDriverValue(e))}mapToDriverValue(e,t=!1){let i=e.map(e=>null===e?null:n(this.baseColumn,S)?this.baseColumn.mapToDriverValue(e,!0):this.baseColumn.mapToDriverValue(e));return t?i:function e(t){return`{${t.map(t=>Array.isArray(t)?e(t):"string"==typeof t?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}(i)}}e.s(["IndexedColumn",()=>w,"PgColumn",()=>y,"PgColumnBuilder",()=>m],4775);class C extends m{static [r]="PgEnumObjectColumnBuilder";constructor(e,t){super(e,"string","PgEnumObjectColumn"),this.config.enum=t}build(e){return new P(e,this.config)}}class P extends y{static [r]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}let T=Symbol.for("drizzle:isPgEnum");class x extends m{static [r]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new _(e,this.config)}}class _ extends y{static [r]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}}class E{static [r]="Subquery";constructor(e,t,i,r=!1,n=[]){this._={brand:"Subquery",sql:e,selectedFields:t,alias:i,isWith:r,usedTables:n}}}class A extends E{static [r]="WithSubquery"}e.s(["Subquery",()=>E,"WithSubquery",()=>A],92352);let q={startActiveSpan:(e,r)=>t?(i||(i=t.trace.getTracer("drizzle-orm","0.45.1")),c((t,i)=>i.startActiveSpan(e,e=>{try{return r(e)}catch(i){throw e.setStatus({code:t.SpanStatusCode.ERROR,message:i instanceof Error?i.message:"Unknown error"}),i}finally{e.end()}}),t,i)):r()};e.s(["tracer",()=>q],22360);let L=Symbol.for("drizzle:ViewBaseConfig");e.s(["ViewBaseConfig",()=>L],88274);let B=Symbol.for("drizzle:Schema"),N=Symbol.for("drizzle:Columns"),I=Symbol.for("drizzle:ExtraConfigColumns"),k=Symbol.for("drizzle:OriginalName"),O=Symbol.for("drizzle:BaseName"),M=Symbol.for("drizzle:IsAlias"),Q=Symbol.for("drizzle:ExtraConfigBuilder"),D=Symbol.for("drizzle:IsDrizzleTable");class R{static [r]="Table";static Symbol={Name:a,Schema:B,OriginalName:k,Columns:N,ExtraConfigColumns:I,BaseName:O,IsAlias:M,ExtraConfigBuilder:Q};[a];[k];[B];[N];[I];[O];[M]=!1;[D]=!0;[Q]=void 0;constructor(e,t,i){this[a]=this[k]=e,this[B]=t,this[O]=i}}function $(e){return e[a]}function F(e){return`${e[B]??"public"}.${e[a]}`}e.s(["Columns",()=>N,"IsAlias",()=>M,"Schema",()=>B,"Table",()=>R,"getTableName",()=>$,"getTableUniqueName",()=>F],69e3);class j{static [r]="FakePrimitiveParam"}function U(e){return null!=e&&"function"==typeof e.getSQL}class K{static [r]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new V([this])}}class V{constructor(e){for(const t of(this.queryChunks=e,e))if(n(t,R)){const e=t[R.Symbol.Schema];this.usedTables.push(void 0===e?t[R.Symbol.Name]:e+"."+t[R.Symbol.Name])}}static [r]="SQL";decoder=H;shouldInlineParams=!1;usedTables=[];append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return q.startActiveSpan("drizzle.buildSQL",t=>{let i=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":i.sql,"drizzle.query.params":JSON.stringify(i.params)}),i})}buildQueryFromSourceParams(e,t){let i=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:r,escapeName:o,escapeParam:a,prepareTyping:l,inlineParams:u,paramStartIndex:c}=i;var h=e.map(e=>{if(n(e,K))return{sql:e.value.join(""),params:[]};if(n(e,z))return{sql:o(e.value),params:[]};if(void 0===e)return{sql:"",params:[]};if(Array.isArray(e)){let t=[new K("(")];for(let[i,r]of e.entries())t.push(r),i<e.length-1&&t.push(new K(", "));return t.push(new K(")")),this.buildQueryFromSourceParams(t,i)}if(n(e,V))return this.buildQueryFromSourceParams(e.queryChunks,{...i,inlineParams:u||e.shouldInlineParams});if(n(e,R)){let t=e[R.Symbol.Schema],i=e[R.Symbol.Name];return{sql:void 0===t||e[M]?o(i):o(t)+"."+o(i),params:[]}}if(n(e,s)){let i=r.getColumnCasing(e);if("indexes"===t.invokeSource)return{sql:o(i),params:[]};let n=e.table[R.Symbol.Schema];return{sql:e.table[M]||void 0===n?o(e.table[R.Symbol.Name])+"."+o(i):o(n)+"."+o(e.table[R.Symbol.Name])+"."+o(i),params:[]}}if(n(e,en)){let t=e[L].schema,i=e[L].name;return{sql:void 0===t||e[L].isAlias?o(i):o(t)+"."+o(i),params:[]}}if(n(e,G)){if(n(e.value,et))return{sql:a(c.value++,e),params:[e],typings:["none"]};let t=null===e.value?null:e.encoder.mapToDriverValue(e.value);if(n(t,V))return this.buildQueryFromSourceParams([t],i);if(u)return{sql:this.mapInlineParam(t,i),params:[]};let r=["none"];return l&&(r=[l(e.encoder)]),{sql:a(c.value++,t),params:[t],typings:r}}return n(e,et)?{sql:a(c.value++,e),params:[e],typings:["none"]}:n(e,V.Aliased)&&void 0!==e.fieldAlias?{sql:o(e.fieldAlias),params:[]}:n(e,E)?e._.isWith?{sql:o(e._.alias),params:[]}:this.buildQueryFromSourceParams([new K("("),e._.sql,new K(") "),new z(e._.alias)],i):e&&"function"==typeof e&&T in e&&!0===e[T]?e.schema?{sql:o(e.schema)+"."+o(e.enumName),params:[]}:{sql:o(e.enumName),params:[]}:U(e)?e.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([e.getSQL()],i):this.buildQueryFromSourceParams([new K("("),e.getSQL(),new K(")")],i):u?{sql:this.mapInlineParam(e,i),params:[]}:{sql:a(c.value++,e),params:[e],typings:["none"]}});let f={sql:"",params:[]};for(let e of h)f.sql+=e.sql,f.params.push(...e.params),e.typings?.length&&(f.typings||(f.typings=[]),f.typings.push(...e.typings));return f}mapInlineParam(e,{escapeString:t}){if(null===e)return"null";if("number"==typeof e||"boolean"==typeof e)return e.toString();if("string"==typeof e)return t(e);if("object"==typeof e){let i=e.toString();return"[object Object]"===i?t(JSON.stringify(e)):t(i)}throw Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return void 0===e?this:new V.Aliased(this,e)}mapWith(e){return this.decoder="function"==typeof e?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class z{constructor(e){this.value=e}static [r]="Name";brand;getSQL(){return new V([this])}}function W(e){return"object"==typeof e&&null!==e&&"mapToDriverValue"in e&&"function"==typeof e.mapToDriverValue}let H={mapFromDriverValue:e=>e},J={mapToDriverValue:e=>e};({...H,...J});class G{constructor(e,t=J){this.value=e,this.encoder=t}static [r]="Param";brand;getSQL(){return new V([this])}}function Y(e,...t){let i=[];for(let[r,n]of((t.length>0||e.length>0&&""!==e[0])&&i.push(new K(e[0])),t.entries()))i.push(n,new K(e[r+1]));return new V(i)}(Z=Y||(Y={})).empty=function(){return new V([])},Z.fromList=function(e){return new V(e)},Z.raw=function(e){return new V([new K(e)])},Z.join=function(e,t){let i=[];for(let[r,n]of e.entries())r>0&&void 0!==t&&i.push(t),i.push(n);return new V(i)},Z.identifier=function(e){return new z(e)},Z.placeholder=function(e){return new et(e)},Z.param=function(e,t){return new G(e,t)};var Z,X=V||(V={});class ee{constructor(e,t){this.sql=e,this.fieldAlias=t}static [r]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new ee(this.sql,this.fieldAlias)}}X.Aliased=ee;class et{constructor(e){this.name=e}static [r]="Placeholder";getSQL(){return new V([this])}}function ei(e,t){return e.map(e=>{if(n(e,et)){if(!(e.name in t))throw Error(`No value for placeholder "${e.name}" was provided`);return t[e.name]}if(n(e,G)&&n(e.value,et)){if(!(e.value.name in t))throw Error(`No value for placeholder "${e.value.name}" was provided`);return e.encoder.mapToDriverValue(t[e.value.name])}return e})}let er=Symbol.for("drizzle:IsDrizzleView");class en{static [r]="View";[L];[er]=!0;constructor({name:e,schema:t,selectedFields:i,query:r}){this[L]={name:e,originalName:e,schema:t,selectedFields:i,query:r,isExisting:!r,isAlias:!1}}getSQL(){return new V([this])}}s.prototype.getSQL=function(){return new V([this])},R.prototype.getSQL=function(){return new V([this])},E.prototype.getSQL=function(){return new V([this])},e.s(["Param",()=>G,"Placeholder",()=>et,"SQL",()=>V,"StringChunk",()=>K,"View",()=>en,"fillPlaceholders",()=>ei,"isDriverValueEncoder",()=>W,"isSQLWrapper",()=>U,"sql",()=>Y],18899)},75225,e=>{"use strict";var t=e.i(56325),i=e.i(44988),r=e.i(69e3),n=e.i(18899);function s(e,s){return!(0,n.isDriverValueEncoder)(s)||(0,n.isSQLWrapper)(e)||(0,i.is)(e,n.Param)||(0,i.is)(e,n.Placeholder)||(0,i.is)(e,t.Column)||(0,i.is)(e,r.Table)||(0,i.is)(e,n.View)?e:new n.Param(e,s)}let o=(e,t)=>n.sql`${e} = ${s(t,e)}`,a=(e,t)=>n.sql`${e} <> ${s(t,e)}`;function l(...e){let t=e.filter(e=>void 0!==e);if(0!==t.length)return new n.SQL(1===t.length?t:[new n.StringChunk("("),n.sql.join(t,new n.StringChunk(" and ")),new n.StringChunk(")")])}function u(...e){let t=e.filter(e=>void 0!==e);if(0!==t.length)return new n.SQL(1===t.length?t:[new n.StringChunk("("),n.sql.join(t,new n.StringChunk(" or ")),new n.StringChunk(")")])}function c(e){return n.sql`not ${e}`}let h=(e,t)=>n.sql`${e} > ${s(t,e)}`,f=(e,t)=>n.sql`${e} >= ${s(t,e)}`,d=(e,t)=>n.sql`${e} < ${s(t,e)}`,p=(e,t)=>n.sql`${e} <= ${s(t,e)}`;function g(e,t){return Array.isArray(t)?0===t.length?n.sql`false`:n.sql`${e} in ${t.map(t=>s(t,e))}`:n.sql`${e} in ${s(t,e)}`}function m(e,t){return Array.isArray(t)?0===t.length?n.sql`true`:n.sql`${e} not in ${t.map(t=>s(t,e))}`:n.sql`${e} not in ${s(t,e)}`}function y(e){return n.sql`${e} is null`}function b(e){return n.sql`${e} is not null`}function w(e){return n.sql`exists ${e}`}function v(e){return n.sql`not exists ${e}`}function S(e,t,i){return n.sql`${e} between ${s(t,e)} and ${s(i,e)}`}function C(e,t,i){return n.sql`${e} not between ${s(t,e)} and ${s(i,e)}`}function P(e,t){return n.sql`${e} like ${t}`}function T(e,t){return n.sql`${e} not like ${t}`}function x(e,t){return n.sql`${e} ilike ${t}`}function _(e,t){return n.sql`${e} not ilike ${t}`}e.s(["and",()=>l,"between",()=>S,"eq",()=>o,"exists",()=>w,"gt",()=>h,"gte",()=>f,"ilike",()=>x,"inArray",()=>g,"isNotNull",()=>b,"isNull",()=>y,"like",()=>P,"lt",()=>d,"lte",()=>p,"ne",()=>a,"not",()=>c,"notBetween",()=>C,"notExists",()=>v,"notIlike",()=>_,"notInArray",()=>m,"notLike",()=>T,"or",()=>u])},4313,56923,1727,38257,48209,93486,3090,67751,94093,18612,e=>{"use strict";var t=e.i(56325),i=e.i(44988),r=e.i(18899),n=e.i(92352),s=e.i(69e3),o=e.i(88274);function a(e,o,a){let l={},u=e.reduce((e,{path:u,field:c},h)=>{let f;f=(0,i.is)(c,t.Column)?c:(0,i.is)(c,r.SQL)?c.decoder:(0,i.is)(c,n.Subquery)?c._.sql.decoder:c.sql.decoder;let d=e;for(let[e,r]of u.entries())if(e<u.length-1)r in d||(d[r]={}),d=d[r];else{let e=o[h],n=d[r]=null===e?null:f.mapFromDriverValue(e);if(a&&(0,i.is)(c,t.Column)&&2===u.length){let e=u[0];e in l?"string"==typeof l[e]&&l[e]!==(0,s.getTableName)(c.table)&&(l[e]=!1):l[e]=null===n&&(0,s.getTableName)(c.table)}}return e},{});if(a&&Object.keys(l).length>0)for(let[e,t]of Object.entries(l))"string"!=typeof t||a[t]||(u[e]=null);return u}function l(e,t){let i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(let[e,t]of i.entries())if(t!==r[e])return!1;return!0}function u(e,n){let o=Object.entries(n).filter(([,e])=>void 0!==e).map(([n,o])=>(0,i.is)(o,r.SQL)||(0,i.is)(o,t.Column)?[n,o]:[n,new r.Param(o,e[s.Table.Symbol.Columns][n])]);if(0===o.length)throw Error("No values to set");return Object.fromEntries(o)}function c(e,t){for(let i of t)for(let t of Object.getOwnPropertyNames(i.prototype))"constructor"!==t&&Object.defineProperty(e.prototype,t,Object.getOwnPropertyDescriptor(i.prototype,t)||Object.create(null))}function h(e){return e[s.Table.Symbol.Columns]}function f(e){return(0,i.is)(e,n.Subquery)?e._.alias:(0,i.is)(e,r.View)?e[o.ViewBaseConfig].name:(0,i.is)(e,r.SQL)?void 0:e[s.Table.Symbol.IsAlias]?e[s.Table.Symbol.Name]:e[s.Table.Symbol.BaseName]}function d(e,t){return{name:"string"==typeof e&&e.length>0?e:"",config:"object"==typeof e?e:t}}function p(e){if("object"!=typeof e||null===e||"Object"!==e.constructor.name)return!1;if("logger"in e){let t=typeof e.logger;return"boolean"===t||"object"===t&&"function"==typeof e.logger.logQuery||"undefined"===t}if("schema"in e){let t=typeof e.schema;return"object"===t||"undefined"===t}if("casing"in e){let t=typeof e.casing;return"string"===t||"undefined"===t}if("mode"in e)return"default"===e.mode&&"planetscale"===e.mode&&void 0===e.mode;if("connection"in e){let t=typeof e.connection;return"string"===t||"object"===t||"undefined"===t}if("client"in e){let t=typeof e.client;return"object"===t||"function"===t||"undefined"===t}return 0===Object.keys(e).length}"undefined"==typeof TextDecoder||new TextDecoder,e.s(["applyMixins",()=>c,"getColumnNameAndConfig",()=>d,"getTableColumns",()=>h,"getTableLikeName",()=>f,"haveSameKeys",()=>l,"isConfig",()=>p,"mapResultRow",()=>a,"mapUpdateSet",()=>u,"orderSelectedFields",()=>function e(o,a){return Object.entries(o).reduce((o,[l,u])=>{if("string"!=typeof l)return o;let c=a?[...a,l]:[l];return(0,i.is)(u,t.Column)||(0,i.is)(u,r.SQL)||(0,i.is)(u,r.SQL.Aliased)||(0,i.is)(u,n.Subquery)?o.push({path:c,field:u}):(0,i.is)(u,s.Table)?o.push(...e(u[s.Table.Symbol.Columns],c)):o.push(...e(u,c)),o},[])}],4313);var g=s,m=e.i(4775),y=m;class b extends y.PgColumnBuilder{static [i.entityKind]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...i}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:i}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...i}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:i}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class w extends b{static [i.entityKind]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new v(e,this.config)}}class v extends m.PgColumn{static [i.entityKind]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class S extends b{static [i.entityKind]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new C(e,this.config)}}class C extends m.PgColumn{static [i.entityKind]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}function P(e,t){let{name:i,config:r}=d(e,t);return"number"===r.mode?new w(i):new S(i)}var T=m;class x extends T.PgColumnBuilder{static [i.entityKind]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new _(e,this.config)}}class _ extends T.PgColumn{static [i.entityKind]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}}class E extends T.PgColumnBuilder{static [i.entityKind]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new A(e,this.config)}}class A extends T.PgColumn{static [i.entityKind]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}function q(e,t){let{name:i,config:r}=d(e,t);return"number"===r.mode?new x(i):new E(i)}var L=m;class B extends L.PgColumnBuilder{static [i.entityKind]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new N(e,this.config)}}class N extends L.PgColumn{static [i.entityKind]="PgBoolean";getSQLType(){return"boolean"}}function I(e){return new B(e??"")}var k=m;class O extends k.PgColumnBuilder{static [i.entityKind]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new M(e,this.config)}}class M extends k.PgColumn{static [i.entityKind]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function Q(e,t={}){let{name:i,config:r}=d(e,t);return new O(i,r)}var D=m;class R extends D.PgColumnBuilder{static [i.entityKind]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new $(e,this.config)}}class $ extends D.PgColumn{static [i.entityKind]="PgCidr";getSQLType(){return"cidr"}}function F(e){return new R(e??"")}var j=m;class U extends j.PgColumnBuilder{static [i.entityKind]="PgCustomColumnBuilder";constructor(e,t,i){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=i}build(e){return new K(e,this.config)}}class K extends j.PgColumn{static [i.entityKind]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return"function"==typeof this.mapFrom?this.mapFrom(e):e}mapToDriverValue(e){return"function"==typeof this.mapTo?this.mapTo(e):e}}function V(e){return(t,i)=>{let{name:r,config:n}=d(t,i);return new U(r,n,e)}}var z=m,W=m;class H extends W.PgColumnBuilder{static [i.entityKind]="PgDateColumnBaseBuilder";defaultNow(){return this.default(r.sql`now()`)}}class J extends H{static [i.entityKind]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new G(e,this.config)}}class G extends z.PgColumn{static [i.entityKind]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return"string"==typeof e?new Date(e):e}mapToDriverValue(e){return e.toISOString()}}class Y extends H{static [i.entityKind]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Z(e,this.config)}}class Z extends z.PgColumn{static [i.entityKind]="PgDateString";getSQLType(){return"date"}mapFromDriverValue(e){return"string"==typeof e?e:e.toISOString().slice(0,-14)}}function X(e,t){let{name:i,config:r}=d(e,t);return r?.mode==="date"?new J(i):new Y(i)}e.s(["PgDate",()=>G,"PgDateString",()=>Z,"date",()=>X],56923);var ee=m;class et extends ee.PgColumnBuilder{static [i.entityKind]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new ei(e,this.config)}}class ei extends ee.PgColumn{static [i.entityKind]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return"string"==typeof e?Number.parseFloat(e):e}}function er(e){return new et(e??"")}var en=m;class es extends en.PgColumnBuilder{static [i.entityKind]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new eo(e,this.config)}}class eo extends en.PgColumn{static [i.entityKind]="PgInet";getSQLType(){return"inet"}}function ea(e){return new es(e??"")}var el=m;class eu extends b{static [i.entityKind]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new ec(e,this.config)}}class ec extends el.PgColumn{static [i.entityKind]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return"string"==typeof e?Number.parseInt(e):e}}function eh(e){return new eu(e??"")}var ef=m;class ed extends ef.PgColumnBuilder{static [i.entityKind]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new ep(e,this.config)}}class ep extends ef.PgColumn{static [i.entityKind]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}}function eg(e,t={}){let{name:i,config:r}=d(e,t);return new ed(i,r)}var em=m;class ey extends em.PgColumnBuilder{static [i.entityKind]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new eb(e,this.config)}}class eb extends em.PgColumn{static [i.entityKind]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function ew(e){return new ey(e??"")}e.s(["PgJson",()=>eb,"json",()=>ew],1727);var ev=m;class eS extends ev.PgColumnBuilder{static [i.entityKind]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new eC(e,this.config)}}class eC extends ev.PgColumn{static [i.entityKind]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if("string"==typeof e)try{return JSON.parse(e)}catch{}return e}}function eP(e){return new eS(e??"")}e.s(["PgJsonb",()=>eC,"jsonb",()=>eP],38257);var eT=m;class ex extends eT.PgColumnBuilder{static [i.entityKind]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new e_(e,this.config)}}class e_ extends eT.PgColumn{static [i.entityKind]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,i,r]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(i),Number.parseFloat(r)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}class eE extends eT.PgColumnBuilder{static [i.entityKind]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new eA(e,this.config)}}class eA extends eT.PgColumn{static [i.entityKind]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,i,r]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(i),c:Number.parseFloat(r)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}function eq(e,t){let{name:i,config:r}=d(e,t);return r?.mode&&"tuple"!==r.mode?new eE(i):new ex(i)}var eL=m;class eB extends eL.PgColumnBuilder{static [i.entityKind]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new eN(e,this.config)}}class eN extends eL.PgColumn{static [i.entityKind]="PgMacaddr";getSQLType(){return"macaddr"}}function eI(e){return new eB(e??"")}var ek=m;class eO extends ek.PgColumnBuilder{static [i.entityKind]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new eM(e,this.config)}}class eM extends ek.PgColumn{static [i.entityKind]="PgMacaddr8";getSQLType(){return"macaddr8"}}function eQ(e){return new eO(e??"")}var eD=m;class eR extends eD.PgColumnBuilder{static [i.entityKind]="PgNumericBuilder";constructor(e,t,i){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=i}build(e){return new e$(e,this.config)}}class e$ extends eD.PgColumn{static [i.entityKind]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return"string"==typeof e?e:String(e)}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class eF extends eD.PgColumnBuilder{static [i.entityKind]="PgNumericNumberBuilder";constructor(e,t,i){super(e,"number","PgNumericNumber"),this.config.precision=t,this.config.scale=i}build(e){return new ej(e,this.config)}}class ej extends eD.PgColumn{static [i.entityKind]="PgNumericNumber";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return"number"==typeof e?e:Number(e)}mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class eU extends eD.PgColumnBuilder{static [i.entityKind]="PgNumericBigIntBuilder";constructor(e,t,i){super(e,"bigint","PgNumericBigInt"),this.config.precision=t,this.config.scale=i}build(e){return new eK(e,this.config)}}class eK extends eD.PgColumn{static [i.entityKind]="PgNumericBigInt";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function eV(e,t){let{name:i,config:r}=d(e,t),n=r?.mode;return"number"===n?new eF(i,r?.precision,r?.scale):"bigint"===n?new eU(i,r?.precision,r?.scale):new eR(i,r?.precision,r?.scale)}e.s(["PgNumeric",()=>e$,"numeric",()=>eV],48209);var ez=m;class eW extends ez.PgColumnBuilder{static [i.entityKind]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new eH(e,this.config)}}class eH extends ez.PgColumn{static [i.entityKind]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,i]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(i)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}class eJ extends ez.PgColumnBuilder{static [i.entityKind]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new eG(e,this.config)}}class eG extends ez.PgColumn{static [i.entityKind]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if("string"==typeof e){let[t,i]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(i)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}function eY(e,t){let{name:i,config:r}=d(e,t);return r?.mode&&"tuple"!==r.mode?new eJ(i):new eW(i)}var eZ=m;function eX(e,t){let i=new DataView(new ArrayBuffer(8));for(let r=0;r<8;r++)i.setUint8(r,e[t+r]);return i.getFloat64(0,!0)}function e0(e){let t=function(e){let t=[];for(let i=0;i<e.length;i+=2)t.push(Number.parseInt(e.slice(i,i+2),16));return new Uint8Array(t)}(e),i=0,r=t[0];i+=1;let n=new DataView(t.buffer),s=n.getUint32(i,1===r);if(i+=4,0x20000000&s&&(n.getUint32(i,1===r),i+=4),(65535&s)==1){let e=eX(t,i),r=eX(t,i+=8);return i+=8,[e,r]}throw Error("Unsupported geometry type")}class e1 extends eZ.PgColumnBuilder{static [i.entityKind]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new e2(e,this.config)}}class e2 extends eZ.PgColumn{static [i.entityKind]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return e0(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}class e6 extends eZ.PgColumnBuilder{static [i.entityKind]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new e5(e,this.config)}}class e5 extends eZ.PgColumn{static [i.entityKind]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=e0(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}function e8(e,t){let{name:i,config:r}=d(e,t);return r?.mode&&"tuple"!==r.mode?new e6(i):new e1(i)}var e3=m;class e4 extends e3.PgColumnBuilder{static [i.entityKind]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new e7(e,this.config)}}class e7 extends e3.PgColumn{static [i.entityKind]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>"string"==typeof e?Number.parseFloat(e):e}function e9(e){return new e4(e??"")}var te=m;class tt extends te.PgColumnBuilder{static [i.entityKind]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new ti(e,this.config)}}class ti extends te.PgColumn{static [i.entityKind]="PgSerial";getSQLType(){return"serial"}}function tr(e){return new tt(e??"")}var tn=m;class ts extends b{static [i.entityKind]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new to(e,this.config)}}class to extends tn.PgColumn{static [i.entityKind]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>"string"==typeof e?Number(e):e}function ta(e){return new ts(e??"")}var tl=m;class tu extends tl.PgColumnBuilder{static [i.entityKind]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new tc(e,this.config)}}class tc extends tl.PgColumn{static [i.entityKind]="PgSmallSerial";getSQLType(){return"smallserial"}}function th(e){return new tu(e??"")}var tf=m;class td extends tf.PgColumnBuilder{static [i.entityKind]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new tp(e,this.config)}}class tp extends tf.PgColumn{static [i.entityKind]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function tg(e,t={}){let{name:i,config:r}=d(e,t);return new td(i,r)}var tm=m;class ty extends H{constructor(e,t,i){super(e,"string","PgTime"),this.withTimezone=t,this.precision=i,this.config.withTimezone=t,this.config.precision=i}static [i.entityKind]="PgTimeBuilder";build(e){return new tb(e,this.config)}}class tb extends tm.PgColumn{static [i.entityKind]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`time${e}${this.withTimezone?" with time zone":""}`}}function tw(e,t={}){let{name:i,config:r}=d(e,t);return new ty(i,r.withTimezone??!1,r.precision)}e.s(["PgTime",()=>tb,"time",()=>tw],93486);var tv=m;class tS extends H{static [i.entityKind]="PgTimestampBuilder";constructor(e,t,i){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=i}build(e){return new tC(e,this.config)}}class tC extends tv.PgColumn{static [i.entityKind]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":` (${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}mapFromDriverValue(e){return"string"==typeof e?new Date(this.withTimezone?e:e+"+0000"):e}mapToDriverValue=e=>e.toISOString()}class tP extends H{static [i.entityKind]="PgTimestampStringBuilder";constructor(e,t,i){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=i}build(e){return new tT(e,this.config)}}class tT extends tv.PgColumn{static [i.entityKind]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){let e=void 0===this.precision?"":`(${this.precision})`;return`timestamp${e}${this.withTimezone?" with time zone":""}`}mapFromDriverValue(e){if("string"==typeof e)return e;let t=e.toISOString().slice(0,-1).replace("T"," ");if(this.withTimezone){let i=e.getTimezoneOffset();return`${t}${i<=0?"+":"-"}${Math.floor(Math.abs(i)/60).toString().padStart(2,"0")}`}return t}}function tx(e,t={}){let{name:i,config:r}=d(e,t);return r?.mode==="string"?new tP(i,r.withTimezone??!1,r.precision):new tS(i,r?.withTimezone??!1,r?.precision)}e.s(["PgTimestamp",()=>tC,"PgTimestampString",()=>tT,"timestamp",()=>tx],3090);var t_=m;class tE extends t_.PgColumnBuilder{static [i.entityKind]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(r.sql`gen_random_uuid()`)}build(e){return new tA(e,this.config)}}class tA extends t_.PgColumn{static [i.entityKind]="PgUUID";getSQLType(){return"uuid"}}function tq(e){return new tE(e??"")}e.s(["PgUUID",()=>tA,"uuid",()=>tq],67751);var tL=m;class tB extends tL.PgColumnBuilder{static [i.entityKind]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new tN(e,this.config)}}class tN extends tL.PgColumn{static [i.entityKind]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function tI(e,t={}){let{name:i,config:r}=d(e,t);return new tB(i,r)}var tk=m;class tO extends tk.PgColumnBuilder{static [i.entityKind]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new tM(e,this.config)}}class tM extends tk.PgColumn{static [i.entityKind]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function tQ(e,t){let{name:i,config:r}=d(e,t);return new tO(i,r)}var tD=m;class tR extends tD.PgColumnBuilder{static [i.entityKind]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new t$(e,this.config)}}class t$ extends tD.PgColumn{static [i.entityKind]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function tF(e,t){let{name:i,config:r}=d(e,t);return new tR(i,r)}var tj=m;class tU extends tj.PgColumnBuilder{static [i.entityKind]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new tK(e,this.config)}}class tK extends tj.PgColumn{static [i.entityKind]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function tV(e,t){let{name:i,config:r}=d(e,t);return new tU(i,r)}var tz=m;class tW extends tz.PgColumnBuilder{static [i.entityKind]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new tH(e,this.config)}}class tH extends tz.PgColumn{static [i.entityKind]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(e=>Number.parseFloat(e))}}function tJ(e,t){let{name:i,config:r}=d(e,t);return new tW(i,r)}let tG=Symbol.for("drizzle:PgInlineForeignKeys"),tY=Symbol.for("drizzle:EnableRLS");class tZ extends g.Table{static [i.entityKind]="PgTable";static Symbol=Object.assign({},g.Table.Symbol,{InlineForeignKeys:tG,EnableRLS:tY});[tG]=[];[tY]=!1;[g.Table.Symbol.ExtraConfigBuilder]=void 0;[g.Table.Symbol.ExtraConfigColumns]={}}let tX=(e,t,i)=>(function(e,t,i,r,n=e){let s=new tZ(e,r,n),o="function"==typeof t?t({bigint:P,bigserial:q,boolean:I,char:Q,cidr:F,customType:V,date:X,doublePrecision:er,inet:ea,integer:eh,interval:eg,json:ew,jsonb:eP,line:eq,macaddr:eI,macaddr8:eQ,numeric:eV,point:eY,geometry:e8,real:e9,serial:tr,smallint:ta,smallserial:th,text:tg,time:tw,timestamp:tx,uuid:tq,varchar:tI,bit:tQ,halfvec:tF,sparsevec:tV,vector:tJ}):t,a=Object.fromEntries(Object.entries(o).map(([e,t])=>{t.setName(e);let i=t.build(s);return s[tG].push(...t.buildForeignKeys(i,s)),[e,i]})),l=Object.fromEntries(Object.entries(o).map(([e,t])=>(t.setName(e),[e,t.buildExtraConfigColumn(s)]))),u=Object.assign(s,a);return u[g.Table.Symbol.Columns]=a,u[g.Table.Symbol.ExtraConfigColumns]=l,i&&(u[tZ.Symbol.ExtraConfigBuilder]=i),Object.assign(u,{enableRLS:()=>(u[tZ.Symbol.EnableRLS]=!0,u)})})(e,t,i,void 0);e.s(["PgTable",()=>tZ,"pgTable",()=>tX],94093);let t0=tX("orders",{id:tr("id").primaryKey(),customer_name:tg("customer_name").notNull(),customer_email:tg("customer_email").notNull(),customer_phone:tg("customer_phone").notNull(),customer_address:tg("customer_address").notNull(),mollieOrderId:tg("mollie_order_id").unique(),paymentStatus:tg("payment_status").default("pending"),createdAt:tx("created_at").defaultNow(),updatedAt:tx("updated_at").defaultNow(),email_sent:I("email_sent").default(!1),follow_up_sent:I("follow_up_sent").default(!1),orderDetails:eP("order_details").notNull().$type()}),t1=tX("products",{id:tr("id").primaryKey(),productName:tg("name").notNull(),productPrice:eh("price").notNull(),description:tg("description"),variants:eP("variants").$type()});e.s(["orders",0,t0,"products",0,t1],18612)},77035,e=>{"use strict";var t,i,r,n,s,o,a=Object.create,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyNames,h=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty,d=(e,t)=>l(e,"name",{value:t,configurable:!0}),p=(e,t)=>()=>(e&&(t=e(e=0)),t),g=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),m=(e,t)=>{for(var i in t)l(e,i,{get:t[i],enumerable:!0})},y=(e,t,i,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of c(t))f.call(e,n)||n===i||l(e,n,{get:()=>t[n],enumerable:!(r=u(t,n))||r.enumerable});return e},b=(e,t,i)=>(i=null!=e?a(h(e)):{},y(!t&&e&&e.__esModule?i:l(i,"default",{value:e,enumerable:!0}),e)),w=e=>y(l({},"__esModule",{value:!0}),e),v=(e,t,i)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?l(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i},S=g(e=>{T(),e.byteLength=l,e.toByteArray=c,e.fromByteArray=p;var t,i,r=[],n=[],s="u">typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0,i=o.length;t<i;++t)r[t]=o[t],n[o.charCodeAt(t)]=t;function a(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");-1===i&&(i=t);var r=i===t?0:4-i%4;return[i,r]}function l(e){var t=a(e),i=t[0],r=t[1];return(i+r)*3/4-r}function u(e,t,i){return(t+i)*3/4-i}function c(e){var t,i,r=a(e),o=r[0],l=r[1],c=new s(u(e,o,l)),h=0,f=l>0?o-4:o;for(i=0;i<f;i+=4)t=n[e.charCodeAt(i)]<<18|n[e.charCodeAt(i+1)]<<12|n[e.charCodeAt(i+2)]<<6|n[e.charCodeAt(i+3)],c[h++]=t>>16&255,c[h++]=t>>8&255,c[h++]=255&t;return 2===l&&(t=n[e.charCodeAt(i)]<<2|n[e.charCodeAt(i+1)]>>4,c[h++]=255&t),1===l&&(t=n[e.charCodeAt(i)]<<10|n[e.charCodeAt(i+1)]<<4|n[e.charCodeAt(i+2)]>>2,c[h++]=t>>8&255,c[h++]=255&t),c}function h(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function f(e,t,i){for(var r=[],n=t;n<i;n+=3)r.push(h((e[n]<<16&0xff0000)+(e[n+1]<<8&65280)+(255&e[n+2])));return r.join("")}function p(e){for(var t,i=e.length,n=i%3,s=[],o=0,a=i-n;o<a;o+=16383)s.push(f(e,o,o+16383>a?a:o+16383));return 1===n?s.push(r[(t=e[i-1])>>2]+r[t<<4&63]+"=="):2===n&&s.push(r[(t=(e[i-2]<<8)+e[i-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")}n[45]=62,n[95]=63,d(a,"getLens"),d(l,"byteLength"),d(u,"_byteLength"),d(c,"toByteArray"),d(h,"tripletToBase64"),d(f,"encodeChunk"),d(p,"fromByteArray")}),C=g(e=>{T(),e.read=function(e,t,i,r,n){var s,o,a=8*n-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=i?n-1:0,f=i?-1:1,d=e[t+h];for(h+=f,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+e[t+h],h+=f,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=r;c>0;o=256*o+e[t+h],h+=f,c-=8);if(0===s)s=1-u;else{if(s===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),s-=u}return(d?-1:1)*o*Math.pow(2,s-r)},e.write=function(e,t,i,r,n,s){var o,a,l,u=8*s-n-1,c=(1<<u)-1,h=c>>1,f=5960464477539062e-23*(23===n),d=r?0:s-1,p=r?1:-1,g=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?t+=f/l:t+=f*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=c?(a=0,o=c):o+h>=1?(a=(t*l-1)*Math.pow(2,n),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;e[i+d]=255&a,d+=p,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;e[i+d]=255&o,d+=p,o/=256,u-=8);e[i+d-p]|=128*g}}),P=g(e=>{T();var t=S(),i=C(),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function n(){try{let e=new Uint8Array(1),t={foo:d(function(){return 42},"foo")};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch{return!1}}function s(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,i){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return c(e)}return a(e,t,i)}function a(e,t,i){if("string"==typeof e)return h(e,t);if(ArrayBuffer.isView(e))return p(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(eo(e,ArrayBuffer)||e&&eo(e.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(eo(e,SharedArrayBuffer)||e&&eo(e.buffer,SharedArrayBuffer)))return g(e,t,i);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return o.from(r,t,i);let n=m(e);if(n)return n;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e,t,i){return l(e),e<=0?s(e):void 0!==t?"string"==typeof i?s(e).fill(t,i):s(e).fill(t):s(e)}function c(e){return l(e),s(e<0?0:0|y(e))}function h(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw TypeError("Unknown encoding: "+t);let i=0|w(e,t),r=s(i),n=r.write(e,t);return n!==i&&(r=r.slice(0,n)),r}function f(e){let t=e.length<0?0:0|y(e.length),i=s(t);for(let r=0;r<t;r+=1)i[r]=255&e[r];return i}function p(e){if(eo(e,Uint8Array)){let t=new Uint8Array(e);return g(t.buffer,t.byteOffset,t.byteLength)}return f(e)}function g(e,t,i){let r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),o.prototype),r}function m(e){if(o.isBuffer(e)){let t=0|y(e.length),i=s(t);return 0===i.length||e.copy(i,0,0,t),i}return void 0!==e.length?"number"!=typeof e.length||ea(e.length)?s(0):f(e):"Buffer"===e.type&&Array.isArray(e.data)?f(e.data):void 0}function y(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function b(e){return+e!=e&&(e=0),o.alloc(+e)}function w(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||eo(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let i=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===i)return 0;let n=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return et(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return en(e).length;default:if(n)return r?-1:et(e).length;t=(""+t).toLowerCase(),n=!0}}function v(e,t,i){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0)||(i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Q(this,t,i);case"utf8":case"utf-8":return I(this,t,i);case"ascii":return O(this,t,i);case"latin1":case"binary":return M(this,t,i);case"base64":return N(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,i);default:if(r)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function P(e,t,i){let r=e[t];e[t]=e[i],e[i]=r}function x(e,t,i,r,n){if(0===e.length)return -1;if("string"==typeof i?(r=i,i=0):i>0x7fffffff?i=0x7fffffff:i<-0x80000000&&(i=-0x80000000),ea(i*=1)&&(i=n?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(n)return -1;i=e.length-1}else if(i<0)if(!n)return -1;else i=0;if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:_(e,t,i,r,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):_(e,[t],i,r,n);throw TypeError("val must be string, number or Buffer")}function _(e,t,i,r,n){let s,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,i/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(d(u,"read"),n){let r=-1;for(s=i;s<a;s++)if(u(e,s)===u(t,-1===r?0:s-r)){if(-1===r&&(r=s),s-r+1===l)return r*o}else -1!==r&&(s-=s-r),r=-1}else for(i+l>a&&(i=a-l),s=i;s>=0;s--){let i=!0;for(let r=0;r<l;r++)if(u(e,s+r)!==u(t,r)){i=!1;break}if(i)return s}return -1}function E(e,t,i,r){let n;i=Number(i)||0;let s=e.length-i;r?(r=Number(r))>s&&(r=s):r=s;let o=t.length;for(r>o/2&&(r=o/2),n=0;n<r;++n){let r=parseInt(t.substr(2*n,2),16);if(ea(r))break;e[i+n]=r}return n}function A(e,t,i,r){return es(et(t,e.length-i),e,i,r)}function q(e,t,i,r){return es(ei(t),e,i,r)}function L(e,t,i,r){return es(en(t),e,i,r)}function B(e,t,i,r){return es(er(t,e.length-i),e,i,r)}function N(e,i,r){return 0===i&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(i,r))}function I(e,t,i){i=Math.min(e.length,i);let r=[],n=t;for(;n<i;){let t=e[n],s=null,o=t>239?4:t>223?3:t>191?2:1;if(n+o<=i){let i,r,a,l;switch(o){case 1:t<128&&(s=t);break;case 2:(192&(i=e[n+1]))==128&&(l=(31&t)<<6|63&i)>127&&(s=l);break;case 3:i=e[n+1],r=e[n+2],(192&i)==128&&(192&r)==128&&(l=(15&t)<<12|(63&i)<<6|63&r)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:i=e[n+1],r=e[n+2],a=e[n+3],(192&i)==128&&(192&r)==128&&(192&a)==128&&(l=(15&t)<<18|(63&i)<<12|(63&r)<<6|63&a)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,o=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),n+=o}return k(r)}function k(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let i="",r=0;for(;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return i}function O(e,t,i){let r="";i=Math.min(e.length,i);for(let n=t;n<i;++n)r+=String.fromCharCode(127&e[n]);return r}function M(e,t,i){let r="";i=Math.min(e.length,i);for(let n=t;n<i;++n)r+=String.fromCharCode(e[n]);return r}function Q(e,t,i){let r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);let n="";for(let r=t;r<i;++r)n+=el[e[r]];return n}function D(e,t,i){let r=e.slice(t,i),n="";for(let e=0;e<r.length-1;e+=2)n+=String.fromCharCode(r[e]+256*r[e+1]);return n}function R(e,t,i){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>i)throw RangeError("Trying to access beyond buffer length")}function $(e,t,i,r,n,s){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw RangeError('"value" argument is out of bounds');if(i+r>e.length)throw RangeError("Index out of range")}function F(e,t,i,r,n){G(t,r,n,e,i,7);let s=Number(t&BigInt(0xffffffff));e[i++]=s,s>>=8,e[i++]=s,s>>=8,e[i++]=s,s>>=8,e[i++]=s;let o=Number(t>>BigInt(32)&BigInt(0xffffffff));return e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,i}function j(e,t,i,r,n){G(t,r,n,e,i,7);let s=Number(t&BigInt(0xffffffff));e[i+7]=s,s>>=8,e[i+6]=s,s>>=8,e[i+5]=s,s>>=8,e[i+4]=s;let o=Number(t>>BigInt(32)&BigInt(0xffffffff));return e[i+3]=o,o>>=8,e[i+2]=o,o>>=8,e[i+1]=o,o>>=8,e[i]=o,i+8}function U(e,t,i,r,n,s){if(i+r>e.length||i<0)throw RangeError("Index out of range")}function K(e,t,r,n,s){return t*=1,r>>>=0,s||U(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function V(e,t,r,n,s){return t*=1,r>>>=0,s||U(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}e.Buffer=o,e.SlowBuffer=b,e.INSPECT_MAX_BYTES=50,e.kMaxLength=0x7fffffff,o.TYPED_ARRAY_SUPPORT=n(),!o.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),d(n,"typedArraySupport"),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:d(function(){if(o.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:d(function(){if(o.isBuffer(this))return this.byteOffset},"get")}),d(s,"createBuffer"),d(o,"Buffer"),o.poolSize=8192,d(a,"from"),o.from=function(e,t,i){return a(e,t,i)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),d(l,"assertSize"),d(u,"alloc"),o.alloc=function(e,t,i){return u(e,t,i)},d(c,"allocUnsafe"),o.allocUnsafe=function(e){return c(e)},o.allocUnsafeSlow=function(e){return c(e)},d(h,"fromString"),d(f,"fromArrayLike"),d(p,"fromArrayView"),d(g,"fromArrayBuffer"),d(m,"fromObject"),d(y,"checked"),d(b,"SlowBuffer"),o.isBuffer=d(function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},"isBuffer"),o.compare=d(function(e,t){if(eo(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),eo(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,r=t.length;for(let n=0,s=Math.min(i,r);n<s;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:+(r<i)},"compare"),o.isEncoding=d(function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),o.concat=d(function(e,t){let i;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let r=o.allocUnsafe(t),n=0;for(i=0;i<e.length;++i){let t=e[i];if(eo(t,Uint8Array))n+t.length>r.length?(o.isBuffer(t)||(t=o.from(t)),t.copy(r,n)):Uint8Array.prototype.set.call(r,t,n);else if(o.isBuffer(t))t.copy(r,n);else throw TypeError('"list" argument must be an Array of Buffers');n+=t.length}return r},"concat"),d(w,"byteLength"),o.byteLength=w,d(v,"slowToString"),o.prototype._isBuffer=!0,d(P,"swap"),o.prototype.swap16=d(function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)P(this,t,t+1);return this},"swap16"),o.prototype.swap32=d(function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)P(this,t,t+3),P(this,t+1,t+2);return this},"swap32"),o.prototype.swap64=d(function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)P(this,t,t+7),P(this,t+1,t+6),P(this,t+2,t+5),P(this,t+3,t+4);return this},"swap64"),o.prototype.toString=d(function(){let e=this.length;return 0===e?"":0==arguments.length?I(this,0,e):v.apply(this,arguments)},"toString"),o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=d(function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},"equals"),o.prototype.inspect=d(function(){let t="",i=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(t+=" ... "),"<Buffer "+t+">"},"inspect"),r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=d(function(e,t,i,r,n){if(eo(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||i>e.length||r<0||n>this.length)throw RangeError("out of range index");if(r>=n&&t>=i)return 0;if(r>=n)return -1;if(t>=i)return 1;if(t>>>=0,i>>>=0,r>>>=0,n>>>=0,this===e)return 0;let s=n-r,a=i-t,l=Math.min(s,a),u=this.slice(r,n),c=e.slice(t,i);for(let e=0;e<l;++e)if(u[e]!==c[e]){s=u[e],a=c[e];break}return s<a?-1:+(a<s)},"compare"),d(x,"bidirectionalIndexOf"),d(_,"arrayIndexOf"),o.prototype.includes=d(function(e,t,i){return -1!==this.indexOf(e,t,i)},"includes"),o.prototype.indexOf=d(function(e,t,i){return x(this,e,t,i,!0)},"indexOf"),o.prototype.lastIndexOf=d(function(e,t,i){return x(this,e,t,i,!1)},"lastIndexOf"),d(E,"hexWrite"),d(A,"utf8Write"),d(q,"asciiWrite"),d(L,"base64Write"),d(B,"ucs2Write"),o.prototype.write=d(function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(i)?(i>>>=0,void 0===r&&(r="utf8")):(r=i,i=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let n=this.length-t;if((void 0===i||i>n)&&(i=n),e.length>0&&(i<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let s=!1;for(;;)switch(r){case"hex":return E(this,e,t,i);case"utf8":case"utf-8":return A(this,e,t,i);case"ascii":case"latin1":case"binary":return q(this,e,t,i);case"base64":return L(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,t,i);default:if(s)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},"write"),o.prototype.toJSON=d(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON"),d(N,"base64Slice"),d(I,"utf8Slice"),d(k,"decodeCodePointsArray"),d(O,"asciiSlice"),d(M,"latin1Slice"),d(Q,"hexSlice"),d(D,"utf16leSlice"),o.prototype.slice=d(function(e,t){let i=this.length;e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);let r=this.subarray(e,t);return Object.setPrototypeOf(r,o.prototype),r},"slice"),d(R,"checkOffset"),o.prototype.readUintLE=o.prototype.readUIntLE=d(function(e,t,i){e>>>=0,t>>>=0,i||R(e,t,this.length);let r=this[e],n=1,s=0;for(;++s<t&&(n*=256);)r+=this[e+s]*n;return r},"readUIntLE"),o.prototype.readUintBE=o.prototype.readUIntBE=d(function(e,t,i){e>>>=0,t>>>=0,i||R(e,t,this.length);let r=this[e+--t],n=1;for(;t>0&&(n*=256);)r+=this[e+--t]*n;return r},"readUIntBE"),o.prototype.readUint8=o.prototype.readUInt8=d(function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},"readUInt8"),o.prototype.readUint16LE=o.prototype.readUInt16LE=d(function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},"readUInt16LE"),o.prototype.readUint16BE=o.prototype.readUInt16BE=d(function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},"readUInt16BE"),o.prototype.readUint32LE=o.prototype.readUInt32LE=d(function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},"readUInt32LE"),o.prototype.readUint32BE=o.prototype.readUInt32BE=d(function(e,t){return e>>>=0,t||R(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},"readUInt32BE"),o.prototype.readBigUInt64LE=eu(d(function(e){Y(e>>>=0,"offset");let t=this[e],i=this[e+7];(void 0===t||void 0===i)&&Z(e,this.length-8);let r=t+256*this[++e]+65536*this[++e]+0x1000000*this[++e],n=this[++e]+256*this[++e]+65536*this[++e]+0x1000000*i;return BigInt(r)+(BigInt(n)<<BigInt(32))},"readBigUInt64LE")),o.prototype.readBigUInt64BE=eu(d(function(e){Y(e>>>=0,"offset");let t=this[e],i=this[e+7];(void 0===t||void 0===i)&&Z(e,this.length-8);let r=0x1000000*t+65536*this[++e]+256*this[++e]+this[++e],n=0x1000000*this[++e]+65536*this[++e]+256*this[++e]+i;return(BigInt(r)<<BigInt(32))+BigInt(n)},"readBigUInt64BE")),o.prototype.readIntLE=d(function(e,t,i){e>>>=0,t>>>=0,i||R(e,t,this.length);let r=this[e],n=1,s=0;for(;++s<t&&(n*=256);)r+=this[e+s]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*t)),r},"readIntLE"),o.prototype.readIntBE=d(function(e,t,i){e>>>=0,t>>>=0,i||R(e,t,this.length);let r=t,n=1,s=this[e+--r];for(;r>0&&(n*=256);)s+=this[e+--r]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},"readIntBE"),o.prototype.readInt8=d(function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-((255-this[e]+1)*1):this[e]},"readInt8"),o.prototype.readInt16LE=d(function(e,t){e>>>=0,t||R(e,2,this.length);let i=this[e]|this[e+1]<<8;return 32768&i?0xffff0000|i:i},"readInt16LE"),o.prototype.readInt16BE=d(function(e,t){e>>>=0,t||R(e,2,this.length);let i=this[e+1]|this[e]<<8;return 32768&i?0xffff0000|i:i},"readInt16BE"),o.prototype.readInt32LE=d(function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},"readInt32LE"),o.prototype.readInt32BE=d(function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},"readInt32BE"),o.prototype.readBigInt64LE=eu(d(function(e){Y(e>>>=0,"offset");let t=this[e],i=this[e+7];return(void 0===t||void 0===i)&&Z(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(i<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+0x1000000*this[++e])},"readBigInt64LE")),o.prototype.readBigInt64BE=eu(d(function(e){Y(e>>>=0,"offset");let t=this[e],i=this[e+7];return(void 0===t||void 0===i)&&Z(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(0x1000000*this[++e]+65536*this[++e]+256*this[++e]+i)},"readBigInt64BE")),o.prototype.readFloatLE=d(function(e,t){return e>>>=0,t||R(e,4,this.length),i.read(this,e,!0,23,4)},"readFloatLE"),o.prototype.readFloatBE=d(function(e,t){return e>>>=0,t||R(e,4,this.length),i.read(this,e,!1,23,4)},"readFloatBE"),o.prototype.readDoubleLE=d(function(e,t){return e>>>=0,t||R(e,8,this.length),i.read(this,e,!0,52,8)},"readDoubleLE"),o.prototype.readDoubleBE=d(function(e,t){return e>>>=0,t||R(e,8,this.length),i.read(this,e,!1,52,8)},"readDoubleBE"),d($,"checkInt"),o.prototype.writeUintLE=o.prototype.writeUIntLE=d(function(e,t,i,r){if(e*=1,t>>>=0,i>>>=0,!r){let r=Math.pow(2,8*i)-1;$(this,e,t,i,r,0)}let n=1,s=0;for(this[t]=255&e;++s<i&&(n*=256);)this[t+s]=e/n&255;return t+i},"writeUIntLE"),o.prototype.writeUintBE=o.prototype.writeUIntBE=d(function(e,t,i,r){if(e*=1,t>>>=0,i>>>=0,!r){let r=Math.pow(2,8*i)-1;$(this,e,t,i,r,0)}let n=i-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+i},"writeUIntBE"),o.prototype.writeUint8=o.prototype.writeUInt8=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,1,255,0),this[t]=255&e,t+1},"writeUInt8"),o.prototype.writeUint16LE=o.prototype.writeUInt16LE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},"writeUInt16LE"),o.prototype.writeUint16BE=o.prototype.writeUInt16BE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},"writeUInt16BE"),o.prototype.writeUint32LE=o.prototype.writeUInt32LE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},"writeUInt32LE"),o.prototype.writeUint32BE=o.prototype.writeUInt32BE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},"writeUInt32BE"),d(F,"wrtBigUInt64LE"),d(j,"wrtBigUInt64BE"),o.prototype.writeBigUInt64LE=eu(d(function(e,t=0){return F(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),o.prototype.writeBigUInt64BE=eu(d(function(e,t=0){return j(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),o.prototype.writeIntLE=d(function(e,t,i,r){if(e*=1,t>>>=0,!r){let r=Math.pow(2,8*i-1);$(this,e,t,i,r-1,-r)}let n=0,s=1,o=0;for(this[t]=255&e;++n<i&&(s*=256);)e<0&&0===o&&0!==this[t+n-1]&&(o=1),this[t+n]=(e/s|0)-o&255;return t+i},"writeIntLE"),o.prototype.writeIntBE=d(function(e,t,i,r){if(e*=1,t>>>=0,!r){let r=Math.pow(2,8*i-1);$(this,e,t,i,r-1,-r)}let n=i-1,s=1,o=0;for(this[t+n]=255&e;--n>=0&&(s*=256);)e<0&&0===o&&0!==this[t+n+1]&&(o=1),this[t+n]=(e/s|0)-o&255;return t+i},"writeIntBE"),o.prototype.writeInt8=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},"writeInt8"),o.prototype.writeInt16LE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},"writeInt16LE"),o.prototype.writeInt16BE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},"writeInt16BE"),o.prototype.writeInt32LE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},"writeInt32LE"),o.prototype.writeInt32BE=d(function(e,t,i){return e*=1,t>>>=0,i||$(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},"writeInt32BE"),o.prototype.writeBigInt64LE=eu(d(function(e,t=0){return F(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),o.prototype.writeBigInt64BE=eu(d(function(e,t=0){return j(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE")),d(U,"checkIEEE754"),d(K,"writeFloat"),o.prototype.writeFloatLE=d(function(e,t,i){return K(this,e,t,!0,i)},"writeFloatLE"),o.prototype.writeFloatBE=d(function(e,t,i){return K(this,e,t,!1,i)},"writeFloatBE"),d(V,"writeDouble"),o.prototype.writeDoubleLE=d(function(e,t,i){return V(this,e,t,!0,i)},"writeDoubleLE"),o.prototype.writeDoubleBE=d(function(e,t,i){return V(this,e,t,!1,i)},"writeDoubleBE"),o.prototype.copy=d(function(e,t,i,r){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);let n=r-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,r):Uint8Array.prototype.set.call(e,this.subarray(i,r),t),n},"copy"),o.prototype.fill=d(function(e,t,i,r){let n;if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){let t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw RangeError("Out of range index");if(i<=t)return this;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(n=t;n<i;++n)this[n]=e;else{let s=o.isBuffer(e)?e:o.from(e,r),a=s.length;if(0===a)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<i-t;++n)this[n+t]=s[n%a]}return this},"fill");var z={};function W(e,t,i){var r;z[e]=(d(r=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}\
]: ${this.message}`}},"NodeError"),r)}function H(e){let t="",i=e.length,r=+("-"===e[0]);for(;i>=r+4;i-=3)t=`\
_${e.slice(i-3,i)}${t}`;return`${e.slice(0,i)}${t}`}function J(e,t,i){Y(t,"offset"),(void 0===e[t]||void 0===e[t+i])&&Z(t,e.length-(i+1))}function G(e,t,i,r,n,s){if(e>i||e<t){let r="bigint"==typeof t?"n":"",n;throw n=s>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r}\
 ** ${(s+1)*8}${r}`:`>= -(2${r} ** ${(s+1)*8-1}${r}) and < 2 ** ${(s+1)*8-1}${r}`:`>= ${t}${r} a\
nd <= ${i}${r}`,new z.ERR_OUT_OF_RANGE("value",n,e)}J(r,n,s)}function Y(e,t){if("number"!=typeof e)throw new z.ERR_INVALID_ARG_TYPE(t,"number",e)}function Z(e,t,i){throw Math.floor(e)!==e?(Y(e,i),new z.ERR_OUT_OF_RANGE(i||"offset","an integer",e)):t<0?new z.ERR_BUFFER_OUT_OF_BOUNDS:new z.ERR_OUT_OF_RANGE(i||"offset",`>= ${+!!i} and <= ${t}`,e)}d(W,"E"),W("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),W("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received typ\
e ${typeof t}`},TypeError),W("ERR_OUT_OF_RANGE",function(e,t,i){let r=`The value of "${e}" is out o\
f range.`,n=i;return Number.isInteger(i)&&Math.abs(i)>0x100000000?n=H(String(i)):"bigint"==typeof i&&(n=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(n=H(n)),n+="n"),r+=` It must be ${t}. Re\
ceived ${n}`},RangeError),d(H,"addNumericalSeparator"),d(J,"checkBounds"),d(G,"checkIntBI"),d(Y,"validateNumber"),d(Z,"boundsError");var X=/[^+/0-9A-Za-z-_]/g;function ee(e){if((e=(e=e.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function et(e,t){t=t||1/0;let i,r=e.length,n=null,s=[];for(let o=0;o<r;++o){if((i=e.charCodeAt(o))>55295&&i<57344){if(!n){if(i>56319||o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}n=i;continue}if(i<56320){(t-=3)>-1&&s.push(239,191,189),n=i;continue}i=(n-55296<<10|i-56320)+65536}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,i<128){if((t-=1)<0)break;s.push(i)}else if(i<2048){if((t-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else if(i<1114112){if((t-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else throw Error("Invalid code point")}return s}function ei(e){let t=[];for(let i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}function er(e,t){let i,r,n=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=(i=e.charCodeAt(s))>>8,n.push(i%256),n.push(r);return n}function en(e){return t.toByteArray(ee(e))}function es(e,t,i,r){let n;for(n=0;n<r&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}function eo(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ea(e){return e!=e}d(ee,"base64clean"),d(et,"utf8ToBytes"),d(ei,"asciiToBytes"),d(er,"utf16leToBytes"),d(en,"base64ToBytes"),d(es,"blitBuffer"),d(eo,"isInstance"),d(ea,"numberIsNaN");var el=function(){let e="0123456789abcdef",t=Array(256);for(let i=0;i<16;++i){let r=16*i;for(let n=0;n<16;++n)t[r+n]=e[i]+e[n]}return t}();function eu(e){return typeof BigInt>"u"?ec:e}function ec(){throw Error("BigInt not supported")}d(eu,"defineBigIntMethod"),d(ec,"BufferBigIntNotDefined")}),T=p(()=>{r=globalThis,n=globalThis.setImmediate??(e=>setTimeout(e,0)),globalThis.clearImmediate??(e=>clearTimeout(e)),s="function"==typeof globalThis.Buffer&&"function"==typeof globalThis.Buffer.allocUnsafe?globalThis.Buffer:P().Buffer,(o=globalThis.process??{}).env??(o.env={});try{o.nextTick(()=>{})}catch{let e=Promise.resolve();o.nextTick=e.then.bind(e)}}),x=g((e,t)=>{T();var i,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:d(function(e,t,i){return Function.prototype.apply.call(e,t,i)},"ReflectApply");function s(e){console&&console.warn&&console.warn(e)}i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?d(function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))},"ReflectOwnKeys"):d(function(e){return Object.getOwnPropertyNames(e)},"ReflectOwnKeys"),d(s,"ProcessEmitWarning");var o=Number.isNaN||d(function(e){return e!=e},"NumberIsNaN");function a(){a.init.call(this)}d(a,"EventEmitter"),t.exports=a,t.exports.once=v,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,i,r){var n,o,a;if(u(i),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),a=o[t]),void 0===a)a=o[t]=i,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[i,a]:[a,i]:r?a.unshift(i):a.push(i),(n=c(e))>0&&a.length>n&&!a.warned){a.warned=!0;var l=Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,s(l)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,i){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=f.bind(r);return n.listener=i,r.wrapFn=n,n}function g(e,t,i){var r=e._events;if(void 0===r)return[];var n=r[t];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?w(n):y(n,n.length)}function m(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function y(e,t){for(var i=Array(t),r=0;r<t;++r)i[r]=e[r];return i}function b(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function w(e){for(var t=Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}function v(e,t){return new Promise(function(i,r){function n(i){e.removeListener(t,s),r(i)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",n),i([].slice.call(arguments))}d(n,"errorListener"),d(s,"resolver"),C(e,t,s,{once:!0}),"error"!==t&&S(e,n,{once:!0})})}function S(e,t,i){"function"==typeof e.on&&C(e,"error",t,i)}function C(e,t,i,r){if("function"==typeof e.on)r.once?e.once(t,i):e.on(t,i);else if("function"==typeof e.addEventListener)e.addEventListener(t,d(function n(s){r.once&&e.removeEventListener(t,n),i(s)},"wrapListener"));else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}d(u,"checkListener"),Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:d(function(){return l},"get"),set:d(function(e){if("number"!=typeof e||e<0||o(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e},"set")}),a.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=d(function(e){if("number"!=typeof e||e<0||o(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},"setMaxListeners"),d(c,"_getMaxListeners"),a.prototype.getMaxListeners=d(function(){return c(this)},"getMaxListeners"),a.prototype.emit=d(function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var o,a=Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else for(var u=l.length,c=y(l,u),i=0;i<u;++i)n(c[i],this,t);return!0},"emit"),d(h,"_addListener"),a.prototype.addListener=d(function(e,t){return h(this,e,t,!1)},"addListener"),a.prototype.on=a.prototype.addListener,a.prototype.prependListener=d(function(e,t){return h(this,e,t,!0)},"prependListener"),d(f,"onceWrapper"),d(p,"_onceWrap"),a.prototype.once=d(function(e,t){return u(t),this.on(e,p(this,e,t)),this},"once"),a.prototype.prependOnceListener=d(function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},"prependOnceListener"),a.prototype.removeListener=d(function(e,t){var i,r,n,s,o;if(u(t),void 0===(r=this._events)||void 0===(i=r[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,s=i.length-1;s>=0;s--)if(i[s]===t||i[s].listener===t){o=i[s].listener,n=s;break}if(n<0)return this;0===n?i.shift():b(i,n),1===i.length&&(r[e]=i[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},"removeListener"),a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=d(function(e){var t,i,r;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0==arguments.length){var n,s=Object.keys(i);for(r=0;r<s.length;++r)"removeListener"!==(n=s[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},"removeAllListeners"),d(g,"_listeners"),a.prototype.listeners=d(function(e){return g(this,e,!0)},"listeners"),a.prototype.rawListeners=d(function(e){return g(this,e,!1)},"rawListeners"),a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,d(m,"listenerCount"),a.prototype.eventNames=d(function(){return this._eventsCount>0?i(this._events):[]},"eventNames"),d(y,"arrayClone"),d(b,"spliceOne"),d(w,"unwrapListeners"),d(v,"once"),d(S,"addErrorHandlerIfEventEmitter"),d(C,"eventTargetAgnosticAddListener")}),_={};function E(e){return 0}m(_,{Socket:()=>B,isIP:()=>E});var A,q,L,B,N=p(()=>{T(),A=b(x(),1),d(E,"isIP"),q=/^[^.]+\./,L=class e extends A.EventEmitter{constructor(){super(...arguments),v(this,"opts",{}),v(this,"connecting",!1),v(this,"pending",!0),v(this,"writable",!0),v(this,"encrypted",!1),v(this,"authorized",!1),v(this,"destroyed",!1),v(this,"ws",null),v(this,"writeBuffer"),v(this,"tlsState",0),v(this,"tlsRead"),v(this,"tlsWrite")}static get poolQueryViaFetch(){return e.opts.poolQueryViaFetch??e.defaults.poolQueryViaFetch}static set poolQueryViaFetch(t){e.opts.poolQueryViaFetch=t}static get fetchEndpoint(){return e.opts.fetchEndpoint??e.defaults.fetchEndpoint}static set fetchEndpoint(t){e.opts.fetchEndpoint=t}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(e){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return e.opts.fetchFunction??e.defaults.fetchFunction}static set fetchFunction(t){e.opts.fetchFunction=t}static get webSocketConstructor(){return e.opts.webSocketConstructor??e.defaults.webSocketConstructor}static set webSocketConstructor(t){e.opts.webSocketConstructor=t}get webSocketConstructor(){return this.opts.webSocketConstructor??e.webSocketConstructor}set webSocketConstructor(e){this.opts.webSocketConstructor=e}static get wsProxy(){return e.opts.wsProxy??e.defaults.wsProxy}static set wsProxy(t){e.opts.wsProxy=t}get wsProxy(){return this.opts.wsProxy??e.wsProxy}set wsProxy(e){this.opts.wsProxy=e}static get coalesceWrites(){return e.opts.coalesceWrites??e.defaults.coalesceWrites}static set coalesceWrites(t){e.opts.coalesceWrites=t}get coalesceWrites(){return this.opts.coalesceWrites??e.coalesceWrites}set coalesceWrites(e){this.opts.coalesceWrites=e}static get useSecureWebSocket(){return e.opts.useSecureWebSocket??e.defaults.useSecureWebSocket}static set useSecureWebSocket(t){e.opts.useSecureWebSocket=t}get useSecureWebSocket(){return this.opts.useSecureWebSocket??e.useSecureWebSocket}set useSecureWebSocket(e){this.opts.useSecureWebSocket=e}static get forceDisablePgSSL(){return e.opts.forceDisablePgSSL??e.defaults.forceDisablePgSSL}static set forceDisablePgSSL(t){e.opts.forceDisablePgSSL=t}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??e.forceDisablePgSSL}set forceDisablePgSSL(e){this.opts.forceDisablePgSSL=e}static get disableSNI(){return e.opts.disableSNI??e.defaults.disableSNI}static set disableSNI(t){e.opts.disableSNI=t}get disableSNI(){return this.opts.disableSNI??e.disableSNI}set disableSNI(e){this.opts.disableSNI=e}static get disableWarningInBrowsers(){return e.opts.disableWarningInBrowsers??e.defaults.disableWarningInBrowsers}static set disableWarningInBrowsers(t){e.opts.disableWarningInBrowsers=t}get disableWarningInBrowsers(){return this.opts.disableWarningInBrowsers??e.disableWarningInBrowsers}set disableWarningInBrowsers(e){this.opts.disableWarningInBrowsers=e}static get pipelineConnect(){return e.opts.pipelineConnect??e.defaults.pipelineConnect}static set pipelineConnect(t){e.opts.pipelineConnect=t}get pipelineConnect(){return this.opts.pipelineConnect??e.pipelineConnect}set pipelineConnect(e){this.opts.pipelineConnect=e}static get subtls(){return e.opts.subtls??e.defaults.subtls}static set subtls(t){e.opts.subtls=t}get subtls(){return this.opts.subtls??e.subtls}set subtls(e){this.opts.subtls=e}static get pipelineTLS(){return e.opts.pipelineTLS??e.defaults.pipelineTLS}static set pipelineTLS(t){e.opts.pipelineTLS=t}get pipelineTLS(){return this.opts.pipelineTLS??e.pipelineTLS}set pipelineTLS(e){this.opts.pipelineTLS=e}static get rootCerts(){return e.opts.rootCerts??e.defaults.rootCerts}static set rootCerts(t){e.opts.rootCerts=t}get rootCerts(){return this.opts.rootCerts??e.rootCerts}set rootCerts(e){this.opts.rootCerts=e}wsProxyAddrForHost(e,t){let i=this.wsProxy;if(void 0===i)throw Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return"function"==typeof i?i(e,t):`${i}?address=${e}:${t}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(e,t,i){this.connecting=!0,i&&this.once("connect",i);let r=d(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),n=d((e,t=!1)=>{e.binaryType="arraybuffer",e.addEventListener("error",e=>{this.emit("error",e),this.emit("close")}),e.addEventListener("message",e=>{if(0===this.tlsState){let t=s.from(e.data);this.emit("data",t)}}),e.addEventListener("close",()=>{this.emit("close")}),t?r():e.addEventListener("open",r)},"configureWebSocket"),o;try{o=this.wsProxyAddrForHost(t,"string"==typeof e?parseInt(e,10):e)}catch(e){this.emit("error",e),this.emit("close");return}try{let e=(this.useSecureWebSocket?"wss:":"ws:")+"//"+o;if(void 0!==this.webSocketConstructor)this.ws=new this.webSocketConstructor(e),n(this.ws);else try{this.ws=new WebSocket(e),n(this.ws)}catch{this.ws=new __unstable_WebSocket(e),n(this.ws)}}catch(e){fetch((this.useSecureWebSocket?"https:":"http:")+"//"+o,{headers:{Upgrade:"websocket"}}).then(t=>{if(this.ws=t.webSocket,null==this.ws)throw e;this.ws.accept(),n(this.ws,!0)}).catch(e=>{this.emit("error",Error(`All attempts to open a WebSocket to connect to the database failed. Please refer \
to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websoc\
ket--undefined. Details: ${e}`)),this.emit("close")})}}async startTls(e){if(void 0===this.subtls)throw Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let t=await this.subtls.TrustedCert.databaseFromPEM(this.rootCerts),i=new this.subtls.WebSocketReadQueue(this.ws),r=i.read.bind(i),n=this.rawWrite.bind(this),{read:s,write:o}=await this.subtls.startTls(e,t,r,n,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=s,this.tlsWrite=o,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let e=await this.tlsRead();if(void 0===e)break;{let t=s.from(e);this.emit("data",t)}}}rawWrite(e){if(!this.coalesceWrites){this.ws&&this.ws.send(e);return}if(void 0===this.writeBuffer)this.writeBuffer=e,setTimeout(()=>{this.ws&&this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let t=new Uint8Array(this.writeBuffer.length+e.length);t.set(this.writeBuffer),t.set(e,this.writeBuffer.length),this.writeBuffer=t}}write(e,t="utf8",i=e=>{}){return 0===e.length?i():("string"==typeof e&&(e=s.from(e,t)),0===this.tlsState?(this.rawWrite(e),i()):1===this.tlsState?this.once("secureConnection",()=>{this.write(e,t,i)}):(this.tlsWrite(e),i())),!0}end(e=s.alloc(0),t="utf8",i=()=>{}){return this.write(e,t,()=>{this.ws.close(),i()}),this}destroy(){return this.destroyed=!0,this.end()}},d(L,"Socket"),v(L,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:d((e,t,i)=>"https://"+(i?.jwtAuth?e.replace(q,"apiauth."):e.replace(q,"api."))+"/sql","fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:d(e=>e+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1,disableWarningInBrowsers:!1}),v(L,"opts",{}),B=L}),I={};function k(e,t=!1){let{protocol:i}=new URL(e),{username:r,password:n,host:s,hostname:o,port:a,pathname:l,search:u,searchParams:c,hash:h}=new URL("http:"+e.substring(i.length));n=decodeURIComponent(n),r=decodeURIComponent(r),l=decodeURIComponent(l);let f=r+":"+n,d=t?Object.fromEntries(c.entries()):u;return{href:e,protocol:i,auth:f,username:r,password:n,host:s,hostname:o,port:a,pathname:l,search:u,query:d,hash:h}}m(I,{parse:()=>k});var O=p(()=>{T(),d(k,"parse")}),M=g(e=>{T(),e.parse=function(e,t){return new i(e,t).parse()};var t=class e{constructor(e,t){this.source=e,this.transform=t||r,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return"\\"===e?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var t;(this.recorded.length>0||e)&&("NULL"!==(t=this.recorded.join(""))||e||(t=null),null!==t&&(t=this.transform(t)),this.entries.push(t),this.recorded=[])}consumeDimensions(){if("["===this.source[0])for(;!this.isEof()&&"="!==this.nextCharacter().value;);}parse(t){var i,r,n;for(this.consumeDimensions();!this.isEof();)if("{"!==(i=this.nextCharacter()).value||n){if("}"!==i.value||n)'"'!==i.value||i.escaped?","!==i.value||n?this.record(i.value):this.newEntry():(n&&this.newEntry(!0),n=!n);else if(this.dimension--,!this.dimension&&(this.newEntry(),t))return this.entries}else this.dimension++,this.dimension>1&&(r=new e(this.source.substr(this.position-1),this.transform),this.entries.push(r.parse(!0)),this.position+=r.position-2);if(0!==this.dimension)throw Error("array dimension not balanced");return this.entries}};d(t,"ArrayParser");var i=t;function r(e){return e}d(r,"identity")}),Q=g((e,t)=>{T();var i=M();t.exports={create:d(function(e,t){return{parse:d(function(){return i.parse(e,t)},"parse")}},"create")}}),D=g((e,t)=>{T();var i=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,r=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,n=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,s=/^-?infinity$/;function o(e){var t=r.exec(e);if(t){var i=parseInt(t[1],10);t[4]&&(i=l(i));var n=new Date(i,parseInt(t[2],10)-1,t[3]);return u(i)&&n.setFullYear(i),n}}function a(e){if(e.endsWith("+00"))return 0;var t=n.exec(e.split(" ")[1]);if(t){var i=t[1];return"Z"===i?0:(3600*parseInt(t[2],10)+60*parseInt(t[3]||0,10)+parseInt(t[4]||0,10))*("-"===i?-1:1)*1e3}}function l(e){return-(e-1)}function u(e){return e>=0&&e<100}t.exports=d(function(e){if(s.test(e))return Number(e.replace("i","I"));var t=i.exec(e);if(!t)return o(e)||null;var r=!!t[8],n=parseInt(t[1],10);r&&(n=l(n));var c=parseInt(t[2],10)-1,h=t[3],f=parseInt(t[4],10),d=parseInt(t[5],10),p=parseInt(t[6],10),g=t[7];g=g?1e3*parseFloat(g):0;var m,y=a(e);return null!=y?(m=new Date(Date.UTC(n,c,h,f,d,p,g)),u(n)&&m.setUTCFullYear(n),0!==y&&m.setTime(m.getTime()-y)):(m=new Date(n,c,h,f,d,p,g),u(n)&&m.setFullYear(n)),m},"parseDate"),d(o,"getDate"),d(a,"timeZoneOffset"),d(l,"bcYearToNegativeYear"),d(u,"is0To99")}),R=g((e,t)=>{T(),t.exports=r;var i=Object.prototype.hasOwnProperty;function r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)i.call(r,n)&&(e[n]=r[n])}return e}d(r,"extend")}),$=g((e,t)=>{T();var i=R();function r(e){if(!(this instanceof r))return new r(e);i(this,p(e))}t.exports=r,d(r,"PostgresInterval");var n=["seconds","minutes","hours","days","months","years"];r.prototype.toPostgres=function(){var e=n.filter(this.hasOwnProperty,this);return this.milliseconds&&0>e.indexOf("seconds")&&e.push("seconds"),0===e.length?"0":e.map(function(e){var t=this[e]||0;return"seconds"===e&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),t+" "+e},this).join(" ")};var s={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},o=["years","months","days"],a=["hours","minutes","seconds"];r.prototype.toISOString=r.prototype.toISO=function(){return"P"+o.map(e,this).join("")+"T"+a.map(e,this).join("");function e(e){var t=this[e]||0;return"seconds"===e&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),t+s[e]}};var l="([+-]?\\d+)",u=new RegExp([l+"\\s+years?",l+"\\s+mons?",l+"\\s+days?","([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?"].map(function(e){return"("+e+")?"}).join("\\s*")),c={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},h=["hours","minutes","seconds","milliseconds"];function f(e){return parseInt(e+"000000".slice(e.length),10)/1e3}function p(e){if(!e)return{};var t=u.exec(e),i="-"===t[8];return Object.keys(c).reduce(function(e,r){var n=t[c[r]];return n&&(n="milliseconds"===r?f(n):parseInt(n,10))&&(i&&~h.indexOf(r)&&(n*=-1),e[r]=n),e},{})}d(f,"parseMilliseconds"),d(p,"parse")}),F=g((e,t)=>{T(),t.exports=d(function(e){if(/^\\x/.test(e))return new s(e.substr(2),"hex");for(var t="",i=0;i<e.length;)if("\\"!==e[i])t+=e[i],++i;else if(/[0-7]{3}/.test(e.substr(i+1,3)))t+=String.fromCharCode(parseInt(e.substr(i+1,3),8)),i+=4;else{for(var r=1;i+r<e.length&&"\\"===e[i+r];)r++;for(var n=0;n<Math.floor(r/2);++n)t+="\\";i+=2*Math.floor(r/2)}return new s(t,"binary")},"parseBytea")}),j=g((e,t)=>{T();var i=M(),r=Q(),n=D(),s=$(),o=F();function a(e){return d(function(t){return null===t?t:e(t)},"nullAllowed")}function l(e){return null===e?e:"TRUE"===e||"t"===e||"true"===e||"y"===e||"yes"===e||"on"===e||"1"===e}function u(e){return e?i.parse(e,l):null}function c(e){return parseInt(e,10)}function h(e){return e?i.parse(e,a(c)):null}function f(e){return e?i.parse(e,a(function(e){return S(e).trim()})):null}d(a,"allowNull"),d(l,"parseBool"),d(u,"parseBoolArray"),d(c,"parseBaseTenInt"),d(h,"parseIntegerArray"),d(f,"parseBigIntegerArray");var p=d(function(e){return e?r.create(e,function(e){return null!==e&&(e=P(e)),e}).parse():null},"parsePointArray"),g=d(function(e){return e?r.create(e,function(e){return null!==e&&(e=parseFloat(e)),e}).parse():null},"parseFloatArray"),m=d(function(e){return e?r.create(e).parse():null},"parseStringArray"),y=d(function(e){return e?r.create(e,function(e){return null!==e&&(e=n(e)),e}).parse():null},"parseDateArray"),b=d(function(e){return e?r.create(e,function(e){return null!==e&&(e=s(e)),e}).parse():null},"parseIntervalArray"),w=d(function(e){return e?i.parse(e,a(o)):null},"parseByteAArray"),v=d(function(e){return parseInt(e,10)},"parseInteger"),S=d(function(e){var t=String(e);return/^\d+$/.test(t)?t:e},"parseBigInteger"),C=d(function(e){return e?i.parse(e,a(JSON.parse)):null},"parseJsonArray"),P=d(function(e){return"("!==e[0]?null:{x:parseFloat((e=e.substring(1,e.length-1).split(","))[0]),y:parseFloat(e[1])}},"parsePoint"),x=d(function(e){if("<"!==e[0]&&"("!==e[1])return null;for(var t="(",i="",r=!1,n=2;n<e.length-1;n++){if(r||(t+=e[n]),")"===e[n]){r=!0;continue}r&&","!==e[n]&&(i+=e[n])}var s=P(t);return s.radius=parseFloat(i),s},"parseCircle");t.exports={init:d(function(e){e(20,S),e(21,v),e(23,v),e(26,v),e(700,parseFloat),e(701,parseFloat),e(16,l),e(1082,n),e(1114,n),e(1184,n),e(600,P),e(651,m),e(718,x),e(1e3,u),e(1001,w),e(1005,h),e(1007,h),e(1028,h),e(1016,f),e(1017,p),e(1021,g),e(1022,g),e(1231,g),e(1014,m),e(1015,m),e(1008,m),e(1009,m),e(1040,m),e(1041,m),e(1115,y),e(1182,y),e(1185,y),e(1186,s),e(1187,b),e(17,o),e(114,JSON.parse.bind(JSON)),e(3802,JSON.parse.bind(JSON)),e(199,C),e(3807,C),e(3907,m),e(2951,m),e(791,m),e(1183,m),e(1270,m)},"init")}}),U=g((e,t)=>{function i(e){var t=e.readInt32BE(0),i=e.readUInt32BE(4),r="";t<0&&(t=~t+(0===i),i=~i+1>>>0,r="-");var n,s,o,a,l,u,c="";if(n=t%1e6,t=t/1e6>>>0,i=(s=0x100000000*n+i)/1e6>>>0,o=""+(s-1e6*i),0===i&&0===t)return r+o+c;for(a="",l=6-o.length,u=0;u<l;u++)a+="0";if(c=a+o+c,n=t%1e6,t=t/1e6>>>0,i=(s=0x100000000*n+i)/1e6>>>0,o=""+(s-1e6*i),0===i&&0===t)return r+o+c;for(a="",l=6-o.length,u=0;u<l;u++)a+="0";if(c=a+o+c,n=t%1e6,t=t/1e6>>>0,i=(s=0x100000000*n+i)/1e6>>>0,o=""+(s-1e6*i),0===i&&0===t)return r+o+c;for(a="",l=6-o.length,u=0;u<l;u++)a+="0";return c=a+o+c,r+(o=""+(s=0x100000000*(n=t%1e6)+i)%1e6)+c}T(),d(i,"readInt8"),t.exports=i}),K=g((e,t)=>{T();var i=U(),r=d(function(e,t,i,r,n){i=i||0,r=r||!1,n=n||function(e,t,i){return e*Math.pow(2,i)+t};var s=i>>3,o=d(function(e){return r?255&~e:e},"inv"),a=255,l=8-i%8;t<l&&(a=255<<8-t&255,l=t),i&&(a>>=i%8);var u=0;i%8+t>=8&&(u=n(0,o(e[s])&a,l));for(var c=t+i>>3,h=s+1;h<c;h++)u=n(u,o(e[h]),8);var f=(t+i)%8;return f>0&&(u=n(u,o(e[c])>>8-f,f)),u},"parseBits"),n=d(function(e,t,i){var n=Math.pow(2,i-1)-1,s=r(e,1),o=r(e,i,1);if(0===o)return 0;var a=1,l=r(e,t,i+1,!1,d(function(e,t,i){0===e&&(e=1);for(var r=1;r<=i;r++)a/=2,(t&1<<i-r)>0&&(e+=a);return e},"parsePrecisionBits"));return o==Math.pow(2,i+1)-1?0===l?0===s?1/0:-1/0:NaN:(0===s?1:-1)*Math.pow(2,o-n)*l},"parseFloatFromBits"),s=d(function(e){return 1==r(e,1)?-1*(r(e,15,1,!0)+1):r(e,15,1)},"parseInt16"),o=d(function(e){return 1==r(e,1)?-1*(r(e,31,1,!0)+1):r(e,31,1)},"parseInt32"),a=d(function(e){return n(e,23,8)},"parseFloat32"),l=d(function(e){return n(e,52,11)},"parseFloat64"),u=d(function(e){var t=r(e,16,32);if(49152==t)return NaN;for(var i=Math.pow(1e4,r(e,16,16)),n=0,s=r(e,16),o=0;o<s;o++)n+=r(e,16,64+16*o)*i,i/=1e4;var a=Math.pow(10,r(e,16,48));return(0===t?1:-1)*Math.round(n*a)/a},"parseNumeric"),c=d(function(e,t){var i=r(t,1),n=r(t,63,1),s=new Date((0===i?1:-1)*n/1e3+9466848e5);return e||s.setTime(s.getTime()+6e4*s.getTimezoneOffset()),s.usec=n%1e3,s.getMicroSeconds=function(){return this.usec},s.setMicroSeconds=function(e){this.usec=e},s.getUTCMicroSeconds=function(){return this.usec},s},"parseDate"),h=d(function(e){for(var t=r(e,32),i=(r(e,32,32),r(e,32,64)),n=96,s=[],o=0;o<t;o++)s[o]=r(e,32,n),n+=64;var a=d(function(t){var i,s=r(e,32,n);return(n+=32,0xffffffff==s)?null:23==t||20==t?(i=r(e,8*s,n),n+=8*s,i):25==t?e.toString(this.encoding,n>>3,(n+=s<<3)>>3):void console.log("ERROR: ElementType not implemented: "+t)},"parseElement"),l=d(function(e,t){var i,r=[];if(e.length>1){var n=e.shift();for(i=0;i<n;i++)r[i]=l(e,t);e.unshift(n)}else for(i=0;i<e[0];i++)r[i]=a(t);return r},"parse");return l(s,i)},"parseArray"),f=d(function(e){return e.toString("utf8")},"parseText"),p=d(function(e){return null===e?null:r(e,8)>0},"parseBool");t.exports={init:d(function(e){e(20,i),e(21,s),e(23,o),e(26,o),e(1700,u),e(700,a),e(701,l),e(16,p),e(1114,c.bind(null,!1)),e(1184,c.bind(null,!0)),e(1e3,h),e(1007,h),e(1016,h),e(1008,h),e(1009,h),e(25,f)},"init")}}),V=g((e,t)=>{T(),t.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),z=g(e=>{T();var t=j(),i=K(),r=Q(),n=V();e.getTypeParser=a,e.setTypeParser=l,e.arrayParser=r,e.builtins=n;var s={text:{},binary:{}};function o(e){return String(e)}function a(e,t){return s[t=t||"text"]&&s[t][e]||o}function l(e,t,i){"function"==typeof t&&(i=t,t="text"),s[t][e]=i}d(o,"noParse"),d(a,"getTypeParser"),d(l,"setTypeParser"),t.init(function(e,t){s.text[e]=t}),i.init(function(e,t){s.binary[e]=t})}),W=g((e,t)=>{T();var i=z();function r(e){this._types=e||i,this.text={},this.binary={}}d(r,"TypeOverrides"),r.prototype.getOverrides=function(e){switch(e){case"text":return this.text;case"binary":return this.binary;default:return{}}},r.prototype.setTypeParser=function(e,t,i){"function"==typeof t&&(i=t,t="text"),this.getOverrides(t)[e]=i},r.prototype.getTypeParser=function(e,t){return t=t||"text",this.getOverrides(t)[e]||this._types.getTypeParser(e,t)},t.exports=r});function H(e){let t=0x6a09e667,i=0xbb67ae85,r=0x3c6ef372,n=0xa54ff53a,s=0x510e527f,o=0x9b05688c,a=0x1f83d9ab,l=0x5be0cd19,u=0,c=0,h=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2],f=d((e,t)=>e>>>t|e<<32-t,"rrot"),p=new Uint32Array(64),g=new Uint8Array(64),m=d(()=>{for(let e=0,t=0;e<16;e++,t+=4)p[e]=g[t]<<24|g[t+1]<<16|g[t+2]<<8|g[t+3];for(let e=16;e<64;e++){let t=f(p[e-15],7)^f(p[e-15],18)^p[e-15]>>>3,i=f(p[e-2],17)^f(p[e-2],19)^p[e-2]>>>10;p[e]=p[e-16]+t+p[e-7]+i|0}let e=t,u=i,d=r,m=n,y=s,b=o,w=a,v=l;for(let t=0;t<64;t++){let i=v+(f(y,6)^f(y,11)^f(y,25))+(y&b^~y&w)+h[t]+p[t]|0,r=(f(e,2)^f(e,13)^f(e,22))+(e&u^e&d^u&d)|0;v=w,w=b,b=y,y=m+i|0,m=d,d=u,u=e,e=i+r|0}t=t+e|0,i=i+u|0,r=r+d|0,n=n+m|0,s=s+y|0,o=o+b|0,a=a+w|0,l=l+v|0,c=0},"process"),y=d(e=>{"string"==typeof e&&(e=new TextEncoder().encode(e));for(let t=0;t<e.length;t++)g[c++]=e[t],64===c&&m();u+=e.length},"add"),b=d(()=>{if(g[c++]=128,64==c&&m(),c+8>64){for(;c<64;)g[c++]=0;m()}for(;c<58;)g[c++]=0;let e=8*u;g[c++]=e/0x10000000000&255,g[c++]=e/0x100000000&255,g[c++]=e>>>24,g[c++]=e>>>16&255,g[c++]=e>>>8&255,g[c++]=255&e,m();let h=new Uint8Array(32);return h[0]=t>>>24,h[1]=t>>>16&255,h[2]=t>>>8&255,h[3]=255&t,h[4]=i>>>24,h[5]=i>>>16&255,h[6]=i>>>8&255,h[7]=255&i,h[8]=r>>>24,h[9]=r>>>16&255,h[10]=r>>>8&255,h[11]=255&r,h[12]=n>>>24,h[13]=n>>>16&255,h[14]=n>>>8&255,h[15]=255&n,h[16]=s>>>24,h[17]=s>>>16&255,h[18]=s>>>8&255,h[19]=255&s,h[20]=o>>>24,h[21]=o>>>16&255,h[22]=o>>>8&255,h[23]=255&o,h[24]=a>>>24,h[25]=a>>>16&255,h[26]=a>>>8&255,h[27]=255&a,h[28]=l>>>24,h[29]=l>>>16&255,h[30]=l>>>8&255,h[31]=255&l,h},"digest");return void 0===e?{add:y,digest:b}:(y(e),b())}var J,G,Y=p(()=>{T(),d(H,"sha256")}),Z=p(()=>{T(),d(J=class e{constructor(){v(this,"_dataLength",0),v(this,"_bufferLength",0),v(this,"_state",new Int32Array(4)),v(this,"_buffer",new ArrayBuffer(68)),v(this,"_buffer8"),v(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,t=!1){return this.onePassHasher.start().appendByteArray(e).end(t)}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(t){let i=e.hexChars,r=e.hexOut,n,s,o,a;for(a=0;a<4;a+=1)for(s=8*a,n=t[a],o=0;o<8;o+=2)r[s+1+o]=i.charAt(15&n),n>>>=4,r[s+0+o]=i.charAt(15&n),n>>>=4;return r.join("")}static _md5cycle(e,t){let i=e[0],r=e[1],n=e[2],s=e[3];i+=(r&n|~r&s)+t[0]-0x28955b88|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[1]-0x173848aa|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[2]+0x242070db|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[3]-0x3e423112|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[4]-0xa83f051|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[5]+0x4787c62a|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[6]-0x57cfb9ed|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[7]-0x2b96aff|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[8]+0x698098d8|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[9]-0x74bb0851|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[10]-42063|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[11]-0x76a32842|0,i+=((r=(r<<22|r>>>10)+n|0)&n|~r&s)+t[12]+0x6b901122|0,s+=((i=(i<<7|i>>>25)+r|0)&r|~i&n)+t[13]-0x2678e6d|0,n+=((s=(s<<12|s>>>20)+i|0)&i|~s&r)+t[14]-0x5986bc72|0,r+=((n=(n<<17|n>>>15)+s|0)&s|~n&i)+t[15]+0x49b40821|0,i+=((r=(r<<22|r>>>10)+n|0)&s|n&~s)+t[1]-0x9e1da9e|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[6]-0x3fbf4cc0|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[11]+0x265e5a51|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[0]-0x16493856|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[5]-0x29d0efa3|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[10]+0x2441453|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[15]-0x275e197f|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[4]-0x182c0438|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[9]+0x21e1cde6|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[14]-0x3cc8f82a|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[3]-0xb2af279|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[8]+0x455a14ed|0,i+=((r=(r<<20|r>>>12)+n|0)&s|n&~s)+t[13]-0x561c16fb|0,s+=((i=(i<<5|i>>>27)+r|0)&n|r&~n)+t[2]-0x3105c08|0,n+=((s=(s<<9|s>>>23)+i|0)&r|i&~r)+t[7]+0x676f02d9|0,r+=((n=(n<<14|n>>>18)+s|0)&i|s&~i)+t[12]-0x72d5b376|0,i+=((r=(r<<20|r>>>12)+n|0)^n^s)+t[5]-378558|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[8]-0x788e097f|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[11]+0x6d9d6122|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[14]-0x21ac7f4|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[1]-0x5b4115bc|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[4]+0x4bdecfa9|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[7]-0x944b4a0|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[10]-0x41404390|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[13]+0x289b7ec6|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[0]-0x155ed806|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[3]-0x2b10cf7b|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[6]+0x4881d05|0,i+=((r=(r<<23|r>>>9)+n|0)^n^s)+t[9]-0x262b2fc7|0,s+=((i=(i<<4|i>>>28)+r|0)^r^n)+t[12]-0x1924661b|0,n+=((s=(s<<11|s>>>21)+i|0)^i^r)+t[15]+0x1fa27cf8|0,r+=((n=(n<<16|n>>>16)+s|0)^s^i)+t[2]-0x3b53a99b|0,r=(r<<23|r>>>9)+n|0,i+=(n^(r|~s))+t[0]-0xbd6ddbc|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[7]+0x432aff97|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[14]-0x546bdc59|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[5]-0x36c5fc7|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[12]+0x655b59c3|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[3]-0x70f3336e|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[10]-1051523|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[1]-0x7a7ba22f|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[8]+0x6fa87e4f|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[15]-0x1d31920|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[6]-0x5cfebcec|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[13]+0x4e0811a1|0,r=(r<<21|r>>>11)+n|0,i+=(n^(r|~s))+t[4]-0x8ac817e|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~n))+t[11]-0x42c50dcb|0,s=(s<<10|s>>>22)+i|0,n+=(i^(s|~r))+t[2]+0x2ad7d2bb|0,n=(n<<15|n>>>17)+s|0,r+=(s^(n|~i))+t[9]-0x14792c6f|0,r=(r<<21|r>>>11)+n|0,e[0]=i+e[0]|0,e[1]=r+e[1]|0,e[2]=n+e[2]|0,e[3]=s+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(e.stateIdentity),this}appendStr(t){let i=this._buffer8,r=this._buffer32,n=this._bufferLength,s,o;for(o=0;o<t.length;o+=1){if((s=t.charCodeAt(o))<128)i[n++]=s;else if(s<2048)i[n++]=(s>>>6)+192,i[n++]=63&s|128;else if(s<55296||s>56319)i[n++]=(s>>>12)+224,i[n++]=s>>>6&63|128,i[n++]=63&s|128;else{if((s=(s-55296)*1024+(t.charCodeAt(++o)-56320)+65536)>1114111)throw Error("Unicode standard supports code points up to U+10FFFF");i[n++]=(s>>>18)+240,i[n++]=s>>>12&63|128,i[n++]=s>>>6&63|128,i[n++]=63&s|128}n>=64&&(this._dataLength+=64,e._md5cycle(this._state,r),n-=64,r[0]=r[16])}return this._bufferLength=n,this}appendAsciiStr(t){let i=this._buffer8,r=this._buffer32,n=this._bufferLength,s,o=0;for(;;){for(s=Math.min(t.length-o,64-n);s--;)i[n++]=t.charCodeAt(o++);if(n<64)break;this._dataLength+=64,e._md5cycle(this._state,r),n=0}return this._bufferLength=n,this}appendByteArray(t){let i=this._buffer8,r=this._buffer32,n=this._bufferLength,s,o=0;for(;;){for(s=Math.min(t.length-o,64-n);s--;)i[n++]=t[o++];if(n<64)break;this._dataLength+=64,e._md5cycle(this._state,r),n=0}return this._bufferLength=n,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t=e.buffer,i=e.state,r=this._state,n;for(this._dataLength=e.length,this._bufferLength=e.buflen,r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],n=0;n<t.length;n+=1)this._buffer8[n]=t.charCodeAt(n)}end(t=!1){let i=this._bufferLength,r=this._buffer8,n=this._buffer32,s=(i>>2)+1;this._dataLength+=i;let o=8*this._dataLength;if(r[i]=128,r[i+1]=r[i+2]=r[i+3]=0,n.set(e.buffer32Identity.subarray(s),s),i>55&&(e._md5cycle(this._state,n),n.set(e.buffer32Identity)),o<=0xffffffff)n[14]=o;else{let e=o.toString(16).match(/(.*?)(.{0,8})$/);if(null===e)return;let t=parseInt(e[2],16),i=parseInt(e[1],16)||0;n[14]=t,n[15]=i}return e._md5cycle(this._state,n),t?this._state:e._hex(this._state)}},"Md5"),v(J,"stateIdentity",new Int32Array([0x67452301,-0x10325477,-0x67452302,0x10325476])),v(J,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),v(J,"hexChars","0123456789abcdef"),v(J,"hexOut",[]),v(J,"onePassHasher",new J),G=J}),X={};function ee(e){return crypto.getRandomValues(s.alloc(e))}function et(e){if("sha256"===e)return{update:d(function(e){return{digest:d(function(){return s.from(H(e))},"digest")}},"update")};if("md5"===e)return{update:d(function(e){return{digest:d(function(){return"string"==typeof e?G.hashStr(e):G.hashByteArray(e)},"digest")}},"update")};throw Error(`Hash type '${e}' not supported`)}function ei(e,t){if("sha256"!==e)throw Error(`\
Only sha256 is supported (requested: '${e}')`);return{update:d(function(e){return{digest:d(function(){"string"==typeof t&&(t=new TextEncoder().encode(t)),"string"==typeof e&&(e=new TextEncoder().encode(e));let i=t.length;if(i>64)t=H(t);else if(i<64){let e=new Uint8Array(64);e.set(t),t=e}let r=new Uint8Array(64),n=new Uint8Array(64);for(let e=0;e<64;e++)r[e]=54^t[e],n[e]=92^t[e];let o=new Uint8Array(e.length+64);o.set(r,0),o.set(e,64);let a=new Uint8Array(96);return a.set(n,0),a.set(H(o),64),s.from(H(a))},"digest")}},"update")}}m(X,{createHash:()=>et,createHmac:()=>ei,randomBytes:()=>ee});var er=p(()=>{T(),Y(),Z(),d(ee,"randomBytes"),d(et,"createHash"),d(ei,"createHmac")}),en=g((e,t)=>{T(),t.exports={host:"localhost",user:"win32"===o.platform?o.env.USERNAME:o.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var i=z(),r=i.getTypeParser(20,"text"),n=i.getTypeParser(1016,"text");t.exports.__defineSetter__("parseInt8",function(e){i.setTypeParser(20,"text",e?i.getTypeParser(23,"text"):r),i.setTypeParser(1016,"text",e?i.getTypeParser(1007,"text"):n)})}),es=g((e,t)=>{T();var i=(er(),w(X)),r=en();function n(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}function o(e){for(var t="{",i=0;i<e.length;i++)i>0&&(t+=","),null===e[i]||typeof e[i]>"u"?t+="NULL":Array.isArray(e[i])?t+=o(e[i]):e[i]instanceof s?t+="\\\\x"+e[i].toString("hex"):t+=n(a(e[i]));return t+"}"}d(n,"escapeElement"),d(o,"arrayString");var a=d(function(e,t){if(null==e)return null;if(e instanceof s)return e;if(ArrayBuffer.isView(e)){var i=s.from(e.buffer,e.byteOffset,e.byteLength);return i.length===e.byteLength?i:i.slice(e.byteOffset,e.byteOffset+e.byteLength)}return e instanceof Date?r.parseInputDatesAsUTC?h(e):c(e):Array.isArray(e)?o(e):"object"==typeof e?l(e,t):e.toString()},"prepareValue");function l(e,t){if(e&&"function"==typeof e.toPostgres){if(-1!==(t=t||[]).indexOf(e))throw Error('circular reference detected while preparing "'+e+'" for query');return t.push(e),a(e.toPostgres(a),t)}return JSON.stringify(e)}function u(e,t){for(e=""+e;e.length<t;)e="0"+e;return e}function c(e){var t=-e.getTimezoneOffset(),i=e.getFullYear(),r=i<1;r&&(i=Math.abs(i)+1);var n=u(i,4)+"-"+u(e.getMonth()+1,2)+"-"+u(e.getDate(),2)+"T"+u(e.getHours(),2)+":"+u(e.getMinutes(),2)+":"+u(e.getSeconds(),2)+"."+u(e.getMilliseconds(),3);return t<0?(n+="-",t*=-1):n+="+",n+=u(Math.floor(t/60),2)+":"+u(t%60,2),r&&(n+=" BC"),n}function h(e){var t=e.getUTCFullYear(),i=t<1;i&&(t=Math.abs(t)+1);var r=u(t,4)+"-"+u(e.getUTCMonth()+1,2)+"-"+u(e.getUTCDate(),2)+"T"+u(e.getUTCHours(),2)+":"+u(e.getUTCMinutes(),2)+":"+u(e.getUTCSeconds(),2)+"."+u(e.getUTCMilliseconds(),3);return r+="+00:00",i&&(r+=" BC"),r}function f(e,t,i){return e="string"==typeof e?{text:e}:e,t&&("function"==typeof t?e.callback=t:e.values=t),i&&(e.callback=i),e}d(l,"prepareObject"),d(u,"pad"),d(c,"dateToString"),d(h,"dateToStringUTC"),d(f,"normalizeQueryConfig");var p=d(function(e){return i.createHash("md5").update(e,"utf-8").digest("hex")},"md5"),g=d(function(e,t,i){var r=p(t+e);return"md5"+p(s.concat([s.from(r),i]))},"postgresMd5PasswordHash");t.exports={prepareValue:d(function(e){return a(e)},"prepareValueWrapper"),normalizeQueryConfig:f,postgresMd5PasswordHash:g,md5:p}}),eo={};m(eo,{default:()=>ea});var ea,el=p(()=>{T(),ea={}}),eu=g((e,t)=>{T();var i=(er(),w(X));function r(e){if(-1===e.indexOf("SCRAM-SHA-256"))throw Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let t=i.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:t,response:"n,,n=*,r="+t,message:"SASLInitialResponse"}}function n(e,t,i){if("SASLInitialResponse"!==e.message)throw Error("SASL: Last message was not SASLInitialResponse");if("string"!=typeof t)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if("string"!=typeof i)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let r=c(i);if(r.nonce.startsWith(e.clientNonce)){if(r.nonce.length===e.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var n=m(t,s.from(r.salt,"base64"),r.iteration),o=g(n,"Client Key"),a=p(o),l="n=*,r="+e.clientNonce,u="r="+r.nonce+",s="+r.salt+",i="+r.iteration,h="c=biws,r="+r.nonce,d=l+","+u+","+h,y=f(o,g(a,d)).toString("base64"),b=g(n,"Server Key"),w=g(b,d);e.message="SASLResponse",e.serverSignature=w.toString("base64"),e.response=h+",p="+y}function o(e,t){if("SASLResponse"!==e.message)throw Error("SASL: Last message was not SASLResponse");if("string"!=typeof t)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:i}=h(t);if(i!==e.serverSignature)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function a(e){if("string"!=typeof e)throw TypeError("SASL: text must be a string");return e.split("").map((t,i)=>e.charCodeAt(i)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}function l(e){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(e)}function u(e){if("string"!=typeof e)throw TypeError("SASL: attribute pairs text must be a string");return new Map(e.split(",").map(e=>{if(!/^.=/.test(e))throw Error("SASL: Invalid attribute pair entry");return[e[0],e.substring(2)]}))}function c(e){let t=u(e),i=t.get("r");if(i){if(!a(i))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let r=t.get("s");if(r){if(!l(r))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let n=t.get("i");if(n){if(!/^[1-9][0-9]*$/.test(n))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");return{nonce:i,salt:r,iteration:parseInt(n,10)}}function h(e){let t=u(e).get("v");if(t){if(!l(t))throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:t}}function f(e,t){if(!s.isBuffer(e))throw TypeError("first argument must be a Buffer");if(!s.isBuffer(t))throw TypeError("second argument must be a Buffer");if(e.length!==t.length)throw Error("Buffer lengths must match");if(0===e.length)throw Error("Buffers cannot be empty");return s.from(e.map((i,r)=>e[r]^t[r]))}function p(e){return i.createHash("sha256").update(e).digest()}function g(e,t){return i.createHmac("sha256",e).update(t).digest()}function m(e,t,i){for(var r=g(e,s.concat([t,s.from([0,0,0,1])])),n=r,o=0;o<i-1;o++)n=f(n,r=g(e,r));return n}d(r,"startSession"),d(n,"continueSession"),d(o,"finalizeSession"),d(a,"isPrintableChars"),d(l,"isBase64"),d(u,"parseAttributePairs"),d(c,"parseServerFirstMessage"),d(h,"parseServerFinalMessage"),d(f,"xorBuffers"),d(p,"sha256"),d(g,"hmacSha256"),d(m,"Hi"),t.exports={startSession:r,continueSession:n,finalizeSession:o}}),ec={};function eh(...e){return e.join("/")}m(ec,{join:()=>eh});var ef=p(()=>{T(),d(eh,"join")}),ed={};function ep(e,t){t(Error("No filesystem"))}m(ed,{stat:()=>ep});var eg=p(()=>{T(),d(ep,"stat")}),em={};m(em,{default:()=>ey});var ey,eb=p(()=>{T(),ey={}}),ew={};m(ew,{StringDecoder:()=>eS});var ev,eS,eC=p(()=>{T(),d(ev=class{constructor(e){v(this,"td"),this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}},"StringDecoder"),eS=ev}),eP=g((e,t)=>{T();var{Transform:i}=(eb(),w(em)),{StringDecoder:r}=(eC(),w(ew)),n=Symbol("last"),s=Symbol("decoder");function o(e,t,i){let r;if(this.overflow){if(1===(r=this[s].write(e).split(this.matcher)).length)return i();r.shift(),this.overflow=!1}else this[n]+=this[s].write(e),r=this[n].split(this.matcher);this[n]=r.pop();for(let e=0;e<r.length;e++)try{l(this,this.mapper(r[e]))}catch(e){return i(e)}(this.overflow=this[n].length>this.maxLength,this.overflow&&!this.skipOverflow)?i(Error("maximum buffer reached")):i()}function a(e){if(this[n]+=this[s].end(),this[n])try{l(this,this.mapper(this[n]))}catch(t){return e(t)}e()}function l(e,t){void 0!==t&&e.push(t)}function u(e){return e}function c(e,t,l){switch(e=e||/\r?\n/,t=t||u,l=l||{},arguments.length){case 1:"function"==typeof e?(t=e,e=/\r?\n/):"object"!=typeof e||e instanceof RegExp||e[Symbol.split]||(l=e,e=/\r?\n/);break;case 2:"function"==typeof e?(l=t,t=e,e=/\r?\n/):"object"==typeof t&&(l=t,t=u)}(l=Object.assign({},l)).autoDestroy=!0,l.transform=o,l.flush=a,l.readableObjectMode=!0;let c=new i(l);return c[n]="",c[s]=new r("utf8"),c.matcher=e,c.mapper=t,c.maxLength=l.maxLength,c.skipOverflow=l.skipOverflow||!1,c.overflow=!1,c._destroy=function(e,t){this._writableState.errorEmitted=!1,t(e)},c}d(o,"transform"),d(a,"flush"),d(l,"push"),d(u,"noop"),d(c,"split"),t.exports=c}),eT=g((e,t)=>{T();var i=(ef(),w(ec)),r=(eb(),w(em)).Stream,n=eP(),s=(el(),w(eo)),a="win32"===o.platform,l=o.stderr;function u(e){return(61440&e)==32768}d(u,"isRegFile");var c=["host","port","database","user","password"],h=c.length,f=c[h-1];function p(){if(l instanceof r&&!0===l.writable){var e=Array.prototype.slice.call(arguments).concat(`
`);l.write(s.format.apply(s,e))}}d(p,"warn"),Object.defineProperty(t.exports,"isWin",{get:d(function(){return a},"get"),set:d(function(e){a=e},"set")}),t.exports.warnTo=function(e){var t=l;return l=e,t},t.exports.getFileName=function(e){var t=e||o.env;return t.PGPASSFILE||(a?i.join(t.APPDATA||"./","postgresql","pgpass.conf"):i.join(t.HOME||"./",".pgpass"))},t.exports.usePgPass=function(e,t){return!Object.prototype.hasOwnProperty.call(o.env,"PGPASSWORD")&&(!!a||(t=t||"<unkn>",u(e.mode)?!(63&e.mode)||(p('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',t),!1):(p('WARNING: password file "%s" is not a plain file',t),!1)))};var g=t.exports.match=function(e,t){return c.slice(0,-1).reduce(function(i,r,n){return 1==n&&Number(e[r]||5432)===Number(t[r])?i&&!0:i&&("*"===t[r]||t[r]===e[r])},!0)};t.exports.getPassword=function(e,t,i){var r,s=t.pipe(n());function o(t){var i=m(t);i&&y(i)&&g(e,i)&&(r=i[f],s.end())}d(o,"onLine");var a=d(function(){t.destroy(),i(r)},"onEnd"),l=d(function(e){t.destroy(),p("WARNING: error on reading file: %s",e),i(void 0)},"onErr");t.on("error",l),s.on("data",o).on("end",a).on("error",l)};var m=t.exports.parseLine=function(e){if(e.length<11||e.match(/^\s+#/))return null;for(var t="",i="",r=0,n=0,s={},a=d(function(t,i,r){var n=e.substring(i,r);Object.hasOwnProperty.call(o.env,"PGPASS_NO_DEESCAPE")||(n=n.replace(/\\([:\\])/g,"$1")),s[c[t]]=n},"addToObj"),l=0;l<e.length-1;l+=1){if(t=e.charAt(l+1),i=e.charAt(l),r==h-1){a(r,n);break}l>=0&&":"==t&&"\\"!==i&&(a(r,n,l+1),n=l+2,r+=1)}return s=Object.keys(s).length===h?s:null},y=t.exports.isValidEntry=function(e){for(var t={0:function(e){return e.length>0},1:function(e){return"*"===e||isFinite(e=Number(e))&&e>0&&e<0x20000000000000&&Math.floor(e)===e},2:function(e){return e.length>0},3:function(e){return e.length>0},4:function(e){return e.length>0}},i=0;i<c.length;i+=1)if(!(0,t[i])(e[c[i]]||""))return!1;return!0}}),ex=g((e,t)=>{T(),ef(),w(ec);var i=(eg(),w(ed)),r=eT();t.exports=function(e,t){var n=r.getFileName();i.stat(n,function(s,o){if(s||!r.usePgPass(o,n))return t(void 0);var a=i.createReadStream(n);r.getPassword(e,a,t)})},t.exports.warnTo=r.warnTo}),e_={};m(e_,{default:()=>eE});var eE,eA=p(()=>{T(),eE={}}),eq=g((e,t)=>{T();var i=(O(),w(I)),r=(eg(),w(ed));function n(e){if("/"===e.charAt(0)){var t=e.split(" ");return{host:t[0],database:t[1]}}var n=i.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(e)?encodeURI(e).replace(/\%25(\d\d)/g,"%$1"):e,!0),t=n.query;for(var s in t)Array.isArray(t[s])&&(t[s]=t[s][t[s].length-1]);var o=(n.auth||":").split(":");if(t.user=o[0],t.password=o.splice(1).join(":"),t.port=n.port,"socket:"==n.protocol)return t.host=decodeURI(n.pathname),t.database=n.query.db,t.client_encoding=n.query.encoding,t;t.host||(t.host=n.hostname);var a=n.pathname;if(!t.host&&a&&/^%2f/i.test(a)){var l=a.split("/");t.host=decodeURIComponent(l[0]),a=l.splice(1).join("/")}switch(a&&"/"===a.charAt(0)&&(a=a.slice(1)||null),t.database=a&&decodeURI(a),("true"===t.ssl||"1"===t.ssl)&&(t.ssl=!0),"0"===t.ssl&&(t.ssl=!1),(t.sslcert||t.sslkey||t.sslrootcert||t.sslmode)&&(t.ssl={}),t.sslcert&&(t.ssl.cert=r.readFileSync(t.sslcert).toString()),t.sslkey&&(t.ssl.key=r.readFileSync(t.sslkey).toString()),t.sslrootcert&&(t.ssl.ca=r.readFileSync(t.sslrootcert).toString()),t.sslmode){case"disable":t.ssl=!1;break;case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":t.ssl.rejectUnauthorized=!1}return t}d(n,"parse"),t.exports=n,n.parse=n}),eL=g((e,t)=>{T();var i=(eA(),w(e_)),r=en(),n=eq().parse,s=d(function(e,t,i){return void 0===i?i=o.env["PG"+e.toUpperCase()]:!1===i||(i=o.env[i]),t[e]||i||r[e]},"val"),a=d(function(){switch(o.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return r.ssl},"readSSLConfigFromEnvironment"),l=d(function(e){return"'"+(""+e).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),u=d(function(e,t,i){var r=t[i];null!=r&&e.push(i+"="+l(r))},"add"),c=class{constructor(e){(e="string"==typeof e?n(e):e||{}).connectionString&&(e=Object.assign({},e,n(e.connectionString))),this.user=s("user",e),this.database=s("database",e),void 0===this.database&&(this.database=this.user),this.port=parseInt(s("port",e),10),this.host=s("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:s("password",e)}),this.binary=s("binary",e),this.options=s("options",e),this.ssl=typeof e.ssl>"u"?a():e.ssl,"string"==typeof this.ssl&&"true"===this.ssl&&(this.ssl=!0),"no-verify"===this.ssl&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=s("client_encoding",e),this.replication=s("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=s("application_name",e,"PGAPPNAME"),this.fallback_application_name=s("fallback_application_name",e,!1),this.statement_timeout=s("statement_timeout",e,!1),this.lock_timeout=s("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=s("idle_in_transaction_session_timeout",e,!1),this.query_timeout=s("query_timeout",e,!1),void 0===e.connectionTimeoutMillis?this.connect_timeout=o.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),!1===e.keepAlive?this.keepalives=0:!0===e.keepAlive&&(this.keepalives=1),"number"==typeof e.keepAliveInitialDelayMillis&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var t=[];u(t,this,"user"),u(t,this,"password"),u(t,this,"port"),u(t,this,"application_name"),u(t,this,"fallback_application_name"),u(t,this,"connect_timeout"),u(t,this,"options");var r="object"==typeof this.ssl?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(u(t,r,"sslmode"),u(t,r,"sslca"),u(t,r,"sslkey"),u(t,r,"sslcert"),u(t,r,"sslrootcert"),this.database&&t.push("dbname="+l(this.database)),this.replication&&t.push("replication="+l(this.replication)),this.host&&t.push("host="+l(this.host)),this.isDomainSocket)return e(null,t.join(" "));this.client_encoding&&t.push("client_encoding="+l(this.client_encoding)),i.lookup(this.host,function(i,r){return i?e(i,null):(t.push("hostaddr="+l(r)),e(null,t.join(" ")))})}};d(c,"ConnectionParameters"),t.exports=c}),eB=g((e,t)=>{T();var i=z(),r=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,n=class{constructor(e,t){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=t,this.RowCtor=null,this.rowAsArray="array"===e,this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(e){var t;(t=e.text?r.exec(e.text):r.exec(e.command))&&(this.command=t[1],t[3]?(this.oid=parseInt(t[2],10),this.rowCount=parseInt(t[3],10)):t[2]&&(this.rowCount=parseInt(t[2],10)))}_parseRowAsArray(e){for(var t=Array(e.length),i=0,r=e.length;i<r;i++){var n=e[i];null!==n?t[i]=this._parsers[i](n):t[i]=null}return t}parseRow(e){for(var t={},i=0,r=e.length;i<r;i++){var n=e[i],s=this.fields[i].name;null!==n?t[s]=this._parsers[i](n):t[s]=null}return t}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=Array(e.length));for(var t=0;t<e.length;t++){var r=e[t];this._types?this._parsers[t]=this._types.getTypeParser(r.dataTypeID,r.format||"text"):this._parsers[t]=i.getTypeParser(r.dataTypeID,r.format||"text")}}};d(n,"Result"),t.exports=n}),eN=g((e,t)=>{T();var{EventEmitter:i}=x(),r=eB(),n=es(),s=class extends i{constructor(e,t,i){super(),e=n.normalizeQueryConfig(e,t,i),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,o.domain&&e.callback&&(this.callback=o.domain.bind(e.callback)),this._result=new r(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return!!this.name||!!this.rows||!!this.text&&!!this.values&&this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new r(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let t;if(!this._canceledDueToError){try{t=this._result.parseRow(e.fields)}catch(e){this._canceledDueToError=e;return}this.emit("row",t,this._result),this._accumulateRows&&this._result.addRow(t)}}handleCommandComplete(e,t){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&t.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,t){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(e){o.nextTick(()=>{throw e})}this.emit("end",this._results)}submit(e){if("string"!=typeof this.text&&"string"!=typeof this.name)return Error("A query must have either text or a name. Supplying neither is unsupported.");let t=e.parsedStatements[this.name];return this.text&&t&&this.text!==t?Error(`Prepared statements must be unique - '${this.name}\
' was used for a different statement`):this.values&&!Array.isArray(this.values)?Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(e):e.query(this.text),null)}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,t){e.execute({portal:this.portal,rows:t}),t?e.flush():e.sync()}prepare(e){this.isPreparedStatement=!0,this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:n.prepareValue})}catch(t){this.handleError(t,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,t){}};d(s,"Query"),t.exports=s}),eI=g(e=>{T(),Object.defineProperty(e,"__esModule",{value:!0}),e.NoticeMessage=e.DataRowMessage=e.CommandCompleteMessage=e.ReadyForQueryMessage=e.NotificationResponseMessage=e.BackendKeyDataMessage=e.AuthenticationMD5Password=e.ParameterStatusMessage=e.ParameterDescriptionMessage=e.RowDescriptionMessage=e.Field=e.CopyResponse=e.CopyDataMessage=e.DatabaseError=e.copyDone=e.emptyQuery=e.replicationStart=e.portalSuspended=e.noData=e.closeComplete=e.bindComplete=e.parseComplete=void 0,e.parseComplete={name:"parseComplete",length:5},e.bindComplete={name:"bindComplete",length:5},e.closeComplete={name:"closeComplete",length:5},e.noData={name:"noData",length:5},e.portalSuspended={name:"portalSuspended",length:5},e.replicationStart={name:"replicationStart",length:4},e.emptyQuery={name:"emptyQuery",length:4},e.copyDone={name:"copyDone",length:4};var t=class extends Error{constructor(e,t,i){super(e),this.length=t,this.name=i}};d(t,"DatabaseError"),e.DatabaseError=t;var i=class{constructor(e,t){this.length=e,this.chunk=t,this.name="copyData"}};d(i,"CopyDataMessage"),e.CopyDataMessage=i;var r=class{constructor(e,t,i,r){this.length=e,this.name=t,this.binary=i,this.columnTypes=Array(r)}};d(r,"CopyResponse"),e.CopyResponse=r;var n=class{constructor(e,t,i,r,n,s,o){this.name=e,this.tableID=t,this.columnID=i,this.dataTypeID=r,this.dataTypeSize=n,this.dataTypeModifier=s,this.format=o}};d(n,"Field"),e.Field=n;var s=class{constructor(e,t){this.length=e,this.fieldCount=t,this.name="rowDescription",this.fields=Array(this.fieldCount)}};d(s,"RowDescriptionMessage"),e.RowDescriptionMessage=s;var o=class{constructor(e,t){this.length=e,this.parameterCount=t,this.name="parameterDescription",this.dataTypeIDs=Array(this.parameterCount)}};d(o,"ParameterDescriptionMessage"),e.ParameterDescriptionMessage=o;var a=class{constructor(e,t,i){this.length=e,this.parameterName=t,this.parameterValue=i,this.name="parameterStatus"}};d(a,"ParameterStatusMessage"),e.ParameterStatusMessage=a;var l=class{constructor(e,t){this.length=e,this.salt=t,this.name="authenticationMD5Password"}};d(l,"AuthenticationMD5Password"),e.AuthenticationMD5Password=l;var u=class{constructor(e,t,i){this.length=e,this.processID=t,this.secretKey=i,this.name="backendKeyData"}};d(u,"BackendKeyDataMessage"),e.BackendKeyDataMessage=u;var c=class{constructor(e,t,i,r){this.length=e,this.processId=t,this.channel=i,this.payload=r,this.name="notification"}};d(c,"NotificationResponseMessage"),e.NotificationResponseMessage=c;var h=class{constructor(e,t){this.length=e,this.status=t,this.name="readyForQuery"}};d(h,"ReadyForQueryMessage"),e.ReadyForQueryMessage=h;var f=class{constructor(e,t){this.length=e,this.text=t,this.name="commandComplete"}};d(f,"CommandCompleteMessage"),e.CommandCompleteMessage=f;var p=class{constructor(e,t){this.length=e,this.fields=t,this.name="dataRow",this.fieldCount=t.length}};d(p,"DataRowMessage"),e.DataRowMessage=p;var g=class{constructor(e,t){this.length=e,this.message=t,this.name="notice"}};d(g,"NoticeMessage"),e.NoticeMessage=g}),ek=g(e=>{T(),Object.defineProperty(e,"__esModule",{value:!0}),e.Writer=void 0;var t=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=s.allocUnsafe(e)}ensure(e){if(this.buffer.length-this.offset<e){let t=this.buffer,i=t.length+(t.length>>1)+e;this.buffer=s.allocUnsafe(i),t.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(e){let t=s.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}else this.ensure(1);return this.buffer[this.offset++]=0,this}addString(e=""){let t=s.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(5*!e,this.offset)}flush(e){let t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=s.allocUnsafe(this.size),t}};d(t,"Writer"),e.Writer=t}),eO=g(e=>{T(),Object.defineProperty(e,"__esModule",{value:!0}),e.serialize=void 0;var t=ek(),i=new t.Writer,r=d(e=>{for(let t of(i.addInt16(3).addInt16(0),Object.keys(e)))i.addCString(t).addCString(e[t]);i.addCString("client_encoding").addCString("UTF8");let r=i.addCString("").flush(),n=r.length+4;return new t.Writer().addInt32(n).add(r).flush()},"startup"),n=d(()=>{let e=s.allocUnsafe(8);return e.writeInt32BE(8,0),e.writeInt32BE(0x4d2162f,4),e},"requestSsl"),o=d(e=>i.addCString(e).flush(112),"password"),a=d(function(e,t){return i.addCString(e).addInt32(s.byteLength(t)).addString(t),i.flush(112)},"sendSASLInitialResponseMessage"),l=d(function(e){return i.addString(e).flush(112)},"sendSCRAMClientFinalMessage"),u=d(e=>i.addCString(e).flush(81),"query"),c=[],h=d(e=>{let t=e.name||"";t.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",t,t.length),console.error("This can cause conflicts and silent errors executing queries"));let r=e.types||c,n=r.length,s=i.addCString(t).addCString(e.text).addInt16(n);for(let e=0;e<n;e++)s.addInt32(r[e]);return i.flush(80)},"parse"),f=new t.Writer,p=d(function(e,t){for(let r=0;r<e.length;r++){let n=t?t(e[r],r):e[r];null==n?(i.addInt16(0),f.addInt32(-1)):n instanceof s?(i.addInt16(1),f.addInt32(n.length),f.add(n)):(i.addInt16(0),f.addInt32(s.byteLength(n)),f.addString(n))}},"writeValues"),g=d((e={})=>{let t=e.portal||"",r=e.statement||"",n=e.binary||!1,s=e.values||c,o=s.length;return i.addCString(t).addCString(r),i.addInt16(o),p(s,e.valueMapper),i.addInt16(o),i.add(f.flush()),i.addInt16(+!!n),i.flush(66)},"bind"),m=s.from([69,0,0,0,9,0,0,0,0,0]),y=d(e=>{if(!e||!e.portal&&!e.rows)return m;let t=e.portal||"",i=e.rows||0,r=s.byteLength(t),n=4+r+1+4,o=s.allocUnsafe(1+n);return o[0]=69,o.writeInt32BE(n,1),o.write(t,5,"utf-8"),o[r+5]=0,o.writeUInt32BE(i,o.length-4),o},"execute"),b=d((e,t)=>{let i=s.allocUnsafe(16);return i.writeInt32BE(16,0),i.writeInt16BE(1234,4),i.writeInt16BE(5678,6),i.writeInt32BE(e,8),i.writeInt32BE(t,12),i},"cancel"),w=d((e,t)=>{let i=4+s.byteLength(t)+1,r=s.allocUnsafe(1+i);return r[0]=e,r.writeInt32BE(i,1),r.write(t,5,"utf-8"),r[i]=0,r},"cstringMessage"),v=i.addCString("P").flush(68),S=i.addCString("S").flush(68),C=d(e=>e.name?w(68,`${e.type}${e.name||""}`):"P"===e.type?v:S,"describe"),P=d(e=>w(67,`${e.type}${e.name||""}`),"close"),x=d(e=>i.add(e).flush(100),"copyData"),_=d(e=>w(102,e),"copyFail"),E=d(e=>s.from([e,0,0,0,4]),"codeOnlyBuffer"),A=E(72),q=E(83),L=E(88),B=E(99);e.serialize={startup:r,password:o,requestSsl:n,sendSASLInitialResponseMessage:a,sendSCRAMClientFinalMessage:l,query:u,parse:h,bind:g,execute:y,describe:C,close:P,flush:d(()=>A,"flush"),sync:d(()=>q,"sync"),end:d(()=>L,"end"),copyData:x,copyDone:d(()=>B,"copyDone"),copyFail:_,cancel:b}}),eM=g(e=>{T(),Object.defineProperty(e,"__esModule",{value:!0}),e.BufferReader=void 0;var t=s.allocUnsafe(0),i=class{constructor(e=0){this.offset=e,this.buffer=t,this.encoding="utf-8"}setBuffer(e,t){this.offset=e,this.buffer=t}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}uint32(){let e=this.buffer.readUInt32BE(this.offset);return this.offset+=4,e}string(e){let t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}cstring(){let e=this.offset,t=e;for(;0!==this.buffer[t++];);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}bytes(e){let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}};d(i,"BufferReader"),e.BufferReader=i}),eQ=g(e=>{T(),Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;var t=eI(),i=eM(),r=s.allocUnsafe(0),n=class{constructor(e){if(this.buffer=r,this.bufferLength=0,this.bufferOffset=0,this.reader=new i.BufferReader,e?.mode==="binary")throw Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,t){this.mergeBuffer(e);let i=this.bufferOffset+this.bufferLength,n=this.bufferOffset;for(;n+5<=i;){let e=this.buffer[n],r=this.buffer.readUInt32BE(n+1),s=1+r;if(s+n<=i)t(this.handlePacket(n+5,e,r,this.buffer)),n+=s;else break}n===i?(this.buffer=r,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=i-n,this.bufferOffset=n)}mergeBuffer(e){if(this.bufferLength>0){let t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){let e;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)e=this.buffer;else{let i=2*this.buffer.byteLength;for(;t>=i;)i*=2;e=s.allocUnsafe(i)}this.buffer.copy(e,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=e,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,i,r,n){switch(i){case 50:return t.bindComplete;case 49:return t.parseComplete;case 51:return t.closeComplete;case 110:return t.noData;case 115:return t.portalSuspended;case 99:return t.copyDone;case 87:return t.replicationStart;case 73:return t.emptyQuery;case 68:return this.parseDataRowMessage(e,r,n);case 67:return this.parseCommandCompleteMessage(e,r,n);case 90:return this.parseReadyForQueryMessage(e,r,n);case 65:return this.parseNotificationMessage(e,r,n);case 82:return this.parseAuthenticationResponse(e,r,n);case 83:return this.parseParameterStatusMessage(e,r,n);case 75:return this.parseBackendKeyData(e,r,n);case 69:return this.parseErrorMessage(e,r,n,"error");case 78:return this.parseErrorMessage(e,r,n,"notice");case 84:return this.parseRowDescriptionMessage(e,r,n);case 116:return this.parseParameterDescriptionMessage(e,r,n);case 71:return this.parseCopyInMessage(e,r,n);case 72:return this.parseCopyOutMessage(e,r,n);case 100:return this.parseCopyData(e,r,n);default:return new t.DatabaseError("received invalid response: "+i.toString(16),r,"error")}}parseReadyForQueryMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.string(1);return new t.ReadyForQueryMessage(i,n)}parseCommandCompleteMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.cstring();return new t.CommandCompleteMessage(i,n)}parseCopyData(e,i,r){let n=r.slice(e,e+(i-4));return new t.CopyDataMessage(i,n)}parseCopyInMessage(e,t,i){return this.parseCopyMessage(e,t,i,"copyInResponse")}parseCopyOutMessage(e,t,i){return this.parseCopyMessage(e,t,i,"copyOutResponse")}parseCopyMessage(e,i,r,n){this.reader.setBuffer(e,r);let s=0!==this.reader.byte(),o=this.reader.int16(),a=new t.CopyResponse(i,n,s,o);for(let e=0;e<o;e++)a.columnTypes[e]=this.reader.int16();return a}parseNotificationMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int32(),s=this.reader.cstring(),o=this.reader.cstring();return new t.NotificationResponseMessage(i,n,s,o)}parseRowDescriptionMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int16(),s=new t.RowDescriptionMessage(i,n);for(let e=0;e<n;e++)s.fields[e]=this.parseField();return s}parseField(){let e=this.reader.cstring(),i=this.reader.uint32(),r=this.reader.int16(),n=this.reader.uint32(),s=this.reader.int16(),o=this.reader.int32(),a=0===this.reader.int16()?"text":"binary";return new t.Field(e,i,r,n,s,o,a)}parseParameterDescriptionMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int16(),s=new t.ParameterDescriptionMessage(i,n);for(let e=0;e<n;e++)s.dataTypeIDs[e]=this.reader.int32();return s}parseDataRowMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int16(),s=Array(n);for(let e=0;e<n;e++){let t=this.reader.int32();s[e]=-1===t?null:this.reader.string(t)}return new t.DataRowMessage(i,s)}parseParameterStatusMessage(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.cstring(),s=this.reader.cstring();return new t.ParameterStatusMessage(i,n,s)}parseBackendKeyData(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int32(),s=this.reader.int32();return new t.BackendKeyDataMessage(i,n,s)}parseAuthenticationResponse(e,i,r){this.reader.setBuffer(e,r);let n=this.reader.int32(),s={name:"authenticationOk",length:i};switch(n){case 0:break;case 3:8===s.length&&(s.name="authenticationCleartextPassword");break;case 5:if(12===s.length){s.name="authenticationMD5Password";let e=this.reader.bytes(4);return new t.AuthenticationMD5Password(i,e)}break;case 10:{let e;s.name="authenticationSASL",s.mechanisms=[];do(e=this.reader.cstring())&&s.mechanisms.push(e);while(e)}break;case 11:s.name="authenticationSASLContinue",s.data=this.reader.string(i-8);break;case 12:s.name="authenticationSASLFinal",s.data=this.reader.string(i-8);break;default:throw Error("Unknown authenticationOk message type "+n)}return s}parseErrorMessage(e,i,r,n){this.reader.setBuffer(e,r);let s={},o=this.reader.string(1);for(;"\0"!==o;)s[o]=this.reader.cstring(),o=this.reader.string(1);let a=s.M,l="notice"===n?new t.NoticeMessage(i,a):new t.DatabaseError(a,i,n);return l.severity=s.S,l.code=s.C,l.detail=s.D,l.hint=s.H,l.position=s.P,l.internalPosition=s.p,l.internalQuery=s.q,l.where=s.W,l.schema=s.s,l.table=s.t,l.column=s.c,l.dataType=s.d,l.constraint=s.n,l.file=s.F,l.line=s.L,l.routine=s.R,l}};d(n,"Parser"),e.Parser=n}),eD=g(e=>{T(),Object.defineProperty(e,"__esModule",{value:!0}),e.DatabaseError=e.serialize=e.parse=void 0;var t=eI();Object.defineProperty(e,"DatabaseError",{enumerable:!0,get:d(function(){return t.DatabaseError},"get")});var i=eO();Object.defineProperty(e,"serialize",{enumerable:!0,get:d(function(){return i.serialize},"get")});var r=eQ();function n(e,t){let i=new r.Parser;return e.on("data",e=>i.parse(e,t)),new Promise(t=>e.on("end",()=>t()))}d(n,"parse"),e.parse=n}),eR={};function e$({socket:e,servername:t}){return e.startTls(t),e}m(eR,{connect:()=>e$});var eF=p(()=>{T(),d(e$,"connect")}),ej=g((e,t)=>{T();var i=(N(),w(_)),r=x().EventEmitter,{parse:n,serialize:s}=eD(),o=s.flush(),a=s.sync(),l=s.end(),u=class extends r{constructor(e){super(),e=e||{},this.stream=e.stream||new i.Socket,this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var t=this;this.on("newListener",function(e){"message"===e&&(t._emitMessage=!0)})}connect(e,t){var r=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,t),this.stream.once("connect",function(){r._keepAlive&&r.stream.setKeepAlive(!0,r._keepAliveInitialDelayMillis),r.emit("connect")});let n=d(function(e){r._ending&&("ECONNRESET"===e.code||"EPIPE"===e.code)||r.emit("error",e)},"reportStreamError");if(this.stream.on("error",n),this.stream.on("close",function(){r.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(e){switch(e.toString("utf8")){case"S":break;case"N":return r.stream.end(),r.emit("error",Error("The server does not support SSL connections"));default:return r.stream.end(),r.emit("error",Error("There was an error establishing an SSL connection"))}var s=(eF(),w(eR));let o={socket:r.stream};!0!==r.ssl&&(Object.assign(o,r.ssl),"key"in r.ssl&&(o.key=r.ssl.key)),0===i.isIP(t)&&(o.servername=t);try{r.stream=s.connect(o)}catch(e){return r.emit("error",e)}r.attachListeners(r.stream),r.stream.on("error",n),r.emit("sslconnect")})}attachListeners(e){e.on("end",()=>{this.emit("end")}),n(e,e=>{var t="error"===e.name?"errorMessage":e.name;this._emitMessage&&this.emit("message",e),this.emit(t,e)})}requestSsl(){this.stream.write(s.requestSsl())}startup(e){this.stream.write(s.startup(e))}cancel(e,t){this._send(s.cancel(e,t))}password(e){this._send(s.password(e))}sendSASLInitialResponseMessage(e,t){this._send(s.sendSASLInitialResponseMessage(e,t))}sendSCRAMClientFinalMessage(e){this._send(s.sendSCRAMClientFinalMessage(e))}_send(e){return!!this.stream.writable&&this.stream.write(e)}query(e){this._send(s.query(e))}parse(e){this._send(s.parse(e))}bind(e){this._send(s.bind(e))}execute(e){this._send(s.execute(e))}flush(){this.stream.writable&&this.stream.write(o)}sync(){this._ending=!0,this._send(o),this._send(a)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){return(this._ending=!0,this._connecting&&this.stream.writable)?this.stream.write(l,()=>{this.stream.end()}):void this.stream.end()}close(e){this._send(s.close(e))}describe(e){this._send(s.describe(e))}sendCopyFromChunk(e){this._send(s.copyData(e))}endCopyFrom(){this._send(s.copyDone())}sendCopyFail(e){this._send(s.copyFail(e))}};d(u,"Connection"),t.exports=u}),eU=g((e,t)=>{T();var i=x().EventEmitter,n=(el(),w(eo),es()),s=eu(),a=ex(),l=W(),u=eL(),c=eN(),h=en(),f=ej(),p=class extends i{constructor(e){super(),this.connectionParameters=new u(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var t=e||{};this._Promise=t.Promise||r.Promise,this._types=new l(t.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=t.connection||new f({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||h.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=d(t=>{o.nextTick(()=>{t.handleError(e,this.connection)})},"enqueueError");this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){var t=this,i=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let t=Error("Client has already been connected. You cannot reuse a client.");o.nextTick(()=>{e(t)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{i._ending=!0,i.stream.destroy(Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&0===this.host.indexOf("/")?i.connect(this.host+"/.s.PGSQL."+this.port):i.connect(this.port,this.host),i.on("connect",function(){t.ssl?i.requestSsl():i.startup(t.getStartupConf())}),i.on("sslconnect",function(){i.startup(t.getStartupConf())}),this._attachListeners(i),i.once("end",()=>{let e=this._ending?Error("Connection terminated"):Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(e),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(e):this._handleErrorEvent(e):this._connectionError||this._handleErrorEvent(e)),o.nextTick(()=>{this.emit("end")})})}connect(e){return e?void this._connect(e):new this._Promise((e,t)=>{this._connect(i=>{i?t(i):e()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;"function"==typeof this.password?this._Promise.resolve().then(()=>this.password()).then(i=>{if(void 0!==i){if("string"!=typeof i)return void t.emit("error",TypeError("Password must be a string"));this.connectionParameters.password=this.password=i}else this.connectionParameters.password=this.password=null;e()}).catch(e=>{t.emit("error",e)}):null!==this.password?e():a(this.connectionParameters,t=>{void 0!==t&&(this.connectionParameters.password=this.password=t),e()})}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(()=>{let t=n.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)})}_handleAuthSASL(e){this._checkPgPass(()=>{this.saslSession=s.startSession(e.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(e){s.continueSession(this.saslSession,this.password,e.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(e){s.finalizeSession(this.saslSession,e.data),this.saslSession=null}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;t?(this.activeQuery=null,t.handleError(e,this.connection)):this._handleErrorEvent(e)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(e){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,t={user:e.user,database:e.database},i=e.application_name||e.fallback_application_name;return i&&(t.application_name=i),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){var i=this.connection;this.host&&0===this.host.indexOf("/")?i.connect(this.host+"/.s.PGSQL."+this.port):i.connect(this.port,this.host),i.on("connect",function(){i.cancel(e.processID,e.secretKey)})}else -1!==e.queryQueue.indexOf(t)&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,i){return this._types.setTypeParser(e,t,i)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return'"'+e.replace(/"/g,'""')+'"'}escapeLiteral(e){for(var t=!1,i="'",r=0;r<e.length;r++){var n=e[r];"'"===n?i+=n+n:"\\"===n?(i+=n+n,t=!0):i+=n}return i+="'",!0===t&&(i=" E"+i),i}_pulseQueryQueue(){if(!0===this.readyForQuery)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&o.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,i){var r,n,s,a,l;if(null==e)throw TypeError("Client was passed a null or undefined query");return"function"==typeof e.submit?(s=e.query_timeout||this.connectionParameters.query_timeout,n=r=e,"function"==typeof t&&(r.callback=r.callback||t)):(s=this.connectionParameters.query_timeout,(r=new c(e,t,i)).callback||(n=new this._Promise((e,t)=>{r.callback=(i,r)=>i?t(i):e(r)}))),s&&(l=r.callback,a=setTimeout(()=>{var e=Error("Query read timeout");o.nextTick(()=>{r.handleError(e,this.connection)}),l(e),r.callback=()=>{};var t=this.queryQueue.indexOf(r);t>-1&&this.queryQueue.splice(t,1),this._pulseQueryQueue()},s),r.callback=(e,t)=>{clearTimeout(a),l(e,t)}),this.binary&&!r.binary&&(r.binary=!0),r._result&&!r._result._types&&(r._result._types=this._types),this._queryable?this._ending?o.nextTick(()=>{r.handleError(Error("Client was closed and is not queryable"),this.connection)}):(this.queryQueue.push(r),this._pulseQueryQueue()):o.nextTick(()=>{r.handleError(Error("Client has encountered a connection error and is not queryable"),this.connection)}),n}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting)if(!e)return this._Promise.resolve();else e();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),!e)return new this._Promise(e=>{this.connection.once("end",e)});this.connection.once("end",e)}};d(p,"Client"),p.Query=c,t.exports=p}),eK=g((e,t)=>{T();var i=x().EventEmitter,s=d(function(){},"NOOP"),a=d((e,t)=>{let i=e.findIndex(t);return -1===i?void 0:e.splice(i,1)[0]},"removeWhere"),l=class{constructor(e,t,i){this.client=e,this.idleListener=t,this.timeoutId=i}};d(l,"IdleItem");var u=class{constructor(e){this.callback=e}};function c(){throw Error("Release called on client which has already been released to the pool.")}function h(e,t){let i,r;return t?{callback:t,result:void 0}:{callback:d(function(e,t){e?i(e):r(t)},"cb"),result:new e(function(e,t){r=e,i=t}).catch(e=>{throw Error.captureStackTrace(e),e})}}function f(e,t){return d(function i(r){r.client=t,t.removeListener("error",i),t.on("error",()=>{e.log("additional client error after disconnection due to error",r)}),e._remove(t),e.emit("error",r,t)},"idleListener")}d(u,"PendingItem"),d(c,"throwOnDoubleRelease"),d(h,"promisify"),d(f,"makeIdleListener");var p=class extends i{constructor(e,t){super(),this.options=Object.assign({},e),null!=e&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),null!=e&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||eZ().Client,this.Promise=this.options.Promise||r.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended)return void this.log("pulse queue ended");if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(e=>{this._remove(e.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length)return void this.log("no queued requests");if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let i=t.client;i.ref&&i.ref();let r=t.idleListener;return this._acquireClient(i,e,r,!1)}if(!this._isFull())return this.newClient(e);throw Error("unexpected condition")}_remove(e){let t=a(this._idle,t=>t.client===e);void 0!==t&&clearTimeout(t.timeoutId),this._clients=this._clients.filter(t=>t!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let t=Error("Cannot use a pool after calling end on the pool");return e?e(t):this.Promise.reject(t)}let t=h(this.Promise,e),i=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&o.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new u(t.callback)),i;let e=d((e,i,r)=>{clearTimeout(n),t.callback(e,i,r)},"queueCallback"),r=new u(e),n=setTimeout(()=>{a(this._pendingQueue,t=>t.callback===e),r.timedOut=!0,t.callback(Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return n.unref&&n.unref(),this._pendingQueue.push(r),i}return this.newClient(new u(t.callback)),i}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let i=f(this,t);this.log("checking client timeout");let r,n=!1;this.options.connectionTimeoutMillis&&(r=setTimeout(()=>{this.log("ending client due to timeout"),n=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(o=>{if(r&&clearTimeout(r),t.on("error",i),o)this.log("client failed to connect",o),this._clients=this._clients.filter(e=>e!==t),n&&(o=Error("Connection terminated due to connection timeout",{cause:o})),this._pulseQueue(),e.timedOut||e.callback(o,void 0,s);else{if(this.log("new client connected"),0!==this.options.maxLifetimeSeconds){let e=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),-1!==this._idle.findIndex(e=>e.client===t)&&this._acquireClient(t,new u((e,t,i)=>i()),i,!1)},1e3*this.options.maxLifetimeSeconds);e.unref(),t.once("end",()=>clearTimeout(e))}return this._acquireClient(t,e,i,!0)}})}_acquireClient(e,t,i,r){r&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,i),e.removeListener("error",i),t.timedOut?r&&this.options.verify?this.options.verify(e,e.release):e.release():r&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),t.callback(i,void 0,s);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let i=!1;return r=>{i&&c(),i=!0,this._release(e,t,r)}}_release(e,t,i){let r;if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",i,e),i||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}if(this._expired.has(e)){this.log("remove expired client"),this._expired.delete(e),this._remove(e),this._pulseQueue();return}this.options.idleTimeoutMillis&&this._isAboveMin()&&(r=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&r.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new l(e,t,r)),this._pulseQueue()}query(e,t,i){if("function"==typeof e){let t=h(this.Promise,e);return n(function(){return t.callback(Error("Passing a function as the first parameter to pool.query is not supported"))}),t.result}"function"==typeof t&&(i=t,t=void 0);let r=h(this.Promise,i);return i=r.callback,this.connect((r,n)=>{if(r)return i(r);let s=!1,o=d(e=>{s||(s=!0,n.release(e),i(e))},"onError");n.once("error",o),this.log("dispatching query");try{n.query(e,t,(e,t)=>{if(this.log("query dispatched"),n.removeListener("error",o),!s)return s=!0,n.release(e),e?i(e):i(void 0,t)})}catch(e){return n.release(e),i(e)}}),r.result}end(e){if(this.log("ending"),this.ending){let t=Error("Called end on pool more than once");return e?e(t):this.Promise.reject(t)}this.ending=!0;let t=h(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+ +!!this._expired.has(t),0)}get totalCount(){return this._clients.length}};d(p,"Pool"),t.exports=p}),eV={};m(eV,{default:()=>ez});var ez,eW=p(()=>{T(),ez={}}),eH=g((e,t)=>{t.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),eJ=g((e,t)=>{T();var i=x().EventEmitter,r=(el(),w(eo)),s=es(),a=t.exports=function(e,t,r){i.call(this),e=s.normalizeQueryConfig(e,t,r),this.text=e.text,this.values=e.values,this.name=e.name,this.callback=e.callback,this.state="new",this._arrayMode="array"===e.rowMode,this._emitRowEvents=!1,this.on("newListener",(function(e){"row"===e&&(this._emitRowEvents=!0)}).bind(this))};r.inherits(a,i);var l={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};a.prototype.handleError=function(e){var t=this.native.pq.resultErrorFields();if(t)for(var i in t)e[l[i]||i]=t[i];this.callback?this.callback(e):this.emit("error",e),this.state="error"},a.prototype.then=function(e,t){return this._getPromise().then(e,t)},a.prototype.catch=function(e){return this._getPromise().catch(e)},a.prototype._getPromise=function(){return this._promise||(this._promise=new Promise((function(e,t){this._once("end",e),this._once("error",t)}).bind(this))),this._promise},a.prototype.submit=function(e){this.state="running";var t=this;this.native=e.native,e.native.arrayMode=this._arrayMode;var i=d(function(i,r,s){if(e.native.arrayMode=!1,n(function(){t.emit("_done")}),i)return t.handleError(i);t._emitRowEvents&&(s.length>1?r.forEach((e,i)=>{e.forEach(e=>{t.emit("row",e,s[i])})}):r.forEach(function(e){t.emit("row",e,s)})),t.state="end",t.emit("end",s),t.callback&&t.callback(null,s)},"after");if(o.domain&&(i=o.domain.bind(i)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var r=(this.values||[]).map(s.prepareValue);if(e.namedQueries[this.name]){if(this.text&&e.namedQueries[this.name]!==this.text){let e=Error(`Prepa\
red statements must be unique - '${this.name}' was used for a different statement`);return i(e)}return e.native.execute(this.name,r,i)}return e.native.prepare(this.name,this.text,r.length,function(n){return n?i(n):(e.namedQueries[t.name]=t.text,t.native.execute(t.name,r,i))})}if(this.values){if(!Array.isArray(this.values)){let e=Error("Query values must be an array");return i(e)}var a=this.values.map(s.prepareValue);e.native.query(this.text,a,i)}else e.native.query(this.text,i)}}),eG=g((e,t)=>{T();var i=(eW(),w(eV)),n=W(),s=(eH(),x().EventEmitter),a=(el(),w(eo)),l=eL(),u=eJ(),c=t.exports=function(e){s.call(this),e=e||{},this._Promise=e.Promise||r.Promise,this._types=new n(e.types),this.native=new i({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var t=this.connectionParameters=new l(e);this.user=t.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:t.password}),this.database=t.database,this.host=t.host,this.port=t.port,this.namedQueries={}};c.Query=u,a.inherits(c,s),c.prototype._errorAllQueries=function(e){let t=d(t=>{o.nextTick(()=>{t.native=this.native,t.handleError(e)})},"enqueueError");this._hasActiveQuery()&&(t(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(t),this._queryQueue.length=0},c.prototype._connect=function(e){var t=this;this._connecting?o.nextTick(()=>e(Error("Client has already been connected. You cannot reuse a client."))):(this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(i,r){if(i)return e(i);t.native.connect(r,function(i){if(i)return t.native.end(),e(i);t._connected=!0,t.native.on("error",function(e){t._queryable=!1,t._errorAllQueries(e),t.emit("error",e)}),t.native.on("notification",function(e){t.emit("notification",{channel:e.relname,payload:e.extra})}),t.emit("connect"),t._pulseQueryQueue(!0),e()})}))},c.prototype.connect=function(e){return e?void this._connect(e):new this._Promise((e,t)=>{this._connect(i=>{i?t(i):e()})})},c.prototype.query=function(e,t,i){var r,n,s,a,l;if(null==e)throw TypeError("Client was passed a null or undefined query");if("function"==typeof e.submit)s=e.query_timeout||this.connectionParameters.query_timeout,n=r=e,"function"==typeof t&&(e.callback=t);else if(s=this.connectionParameters.query_timeout,!(r=new u(e,t,i)).callback){let e,t;n=new this._Promise((i,r)=>{e=i,t=r}),r.callback=(i,r)=>i?t(i):e(r)}return s&&(l=r.callback,a=setTimeout(()=>{var e=Error("Query read timeout");o.nextTick(()=>{r.handleError(e,this.connection)}),l(e),r.callback=()=>{};var t=this._queryQueue.indexOf(r);t>-1&&this._queryQueue.splice(t,1),this._pulseQueryQueue()},s),r.callback=(e,t)=>{clearTimeout(a),l(e,t)}),this._queryable?this._ending?(r.native=this.native,o.nextTick(()=>{r.handleError(Error("Client was closed and is not queryable"))})):(this._queryQueue.push(r),this._pulseQueryQueue()):(r.native=this.native,o.nextTick(()=>{r.handleError(Error("Client has encountered a connection error and is not queryable"))})),n},c.prototype.end=function(e){var t,i=this;return this._ending=!0,this._connected||this.once("connect",this.end.bind(this,e)),e||(t=new this._Promise(function(t,i){e=d(e=>e?i(e):t(),"cb")})),this.native.end(function(){i._errorAllQueries(Error("Connection terminated")),o.nextTick(()=>{i.emit("end"),e&&e()})}),t},c.prototype._hasActiveQuery=function(){return this._activeQuery&&"error"!==this._activeQuery.state&&"end"!==this._activeQuery.state},c.prototype._pulseQueryQueue=function(e){if(this._connected&&!this._hasActiveQuery()){var t=this._queryQueue.shift();if(!t){e||this.emit("drain");return}this._activeQuery=t,t.submit(this);var i=this;t.once("_done",function(){i._pulseQueryQueue()})}},c.prototype.cancel=function(e){this._activeQuery===e?this.native.cancel(function(){}):-1!==this._queryQueue.indexOf(e)&&this._queryQueue.splice(this._queryQueue.indexOf(e),1)},c.prototype.ref=function(){},c.prototype.unref=function(){},c.prototype.setTypeParser=function(e,t,i){return this._types.setTypeParser(e,t,i)},c.prototype.getTypeParser=function(e,t){return this._types.getTypeParser(e,t)}}),eY=g((e,t)=>{T(),t.exports=eG()}),eZ=g((e,t)=>{T();var i=eU(),r=en(),n=ej(),s=eK(),{DatabaseError:a}=eD(),l=d(e=>{var t;return d(t=class extends s{constructor(t){super(t,e)}},"BoundPool"),t},"poolFactory"),u=d(function(e){this.defaults=r,this.Client=e,this.Query=this.Client.Query,this.Pool=l(this.Client),this._pools=[],this.Connection=n,this.types=z(),this.DatabaseError=a},"PG");"u">typeof o.env.NODE_PG_FORCE_NATIVE?t.exports=new u(eY()):(t.exports=new u(i),Object.defineProperty(t.exports,"native",{configurable:!0,enumerable:!1,get(){var e=null;try{e=new u(eY())}catch(e){if("MODULE_NOT_FOUND"!==e.code)throw e}return Object.defineProperty(t.exports,"native",{value:e}),e}}))});T(),T(),N(),O(),T();var eX=Object.defineProperty,e0=Object.defineProperties,e1=Object.getOwnPropertyDescriptors,e2=Object.getOwnPropertySymbols,e6=Object.prototype.hasOwnProperty,e5=Object.prototype.propertyIsEnumerable,e8=d((e,t,i)=>t in e?eX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,"__defNormalProp"),e3=d((e,t)=>{for(var i in t||(t={}))e6.call(t,i)&&e8(e,i,t[i]);if(e2)for(var i of e2(t))e5.call(t,i)&&e8(e,i,t[i]);return e},"__spreadValues"),e4=d((e,t)=>e0(e,e1(t)),"__spreadProps"),e7=2===new Uint8Array(new Uint16Array([258]).buffer)[0],e9=new TextDecoder,te=new TextEncoder,tt=te.encode("0123456789abcdef"),ti=te.encode("0123456789ABCDEF"),tr=te.encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/").slice();function tn(e,{alphabet:r,scratchArr:n}={}){if(!t)if(t=new Uint16Array(256),i=new Uint16Array(256),e7)for(let e=0;e<256;e++)t[e]=tt[15&e]<<8|tt[e>>>4],i[e]=ti[15&e]<<8|ti[e>>>4];else for(let e=0;e<256;e++)t[e]=tt[15&e]|tt[e>>>4]<<8,i[e]=ti[15&e]|ti[e>>>4]<<8;e.byteOffset%4!=0&&(e=new Uint8Array(e));let s=e.length,o=s>>>2,a=n||new Uint16Array(s),l=new Uint32Array(e.buffer,e.byteOffset,o),u=new Uint32Array(a.buffer,a.byteOffset,s>>>1),c="upper"===r?i:t,h=0,f=0,d;if(e7)for(;h<o;)d=l[h++],u[f++]=c[d>>>8&255]<<16|c[255&d],u[f++]=c[d>>>24]<<16|c[d>>>16&255];else for(;h<o;)d=l[h++],u[f++]=c[d>>>24]<<16|c[d>>>16&255],u[f++]=c[d>>>8&255]<<16|c[255&d];for(h<<=2;h<s;)a[h]=c[e[h++]];return e9.decode(a.subarray(0,s))}function ts(e,t={}){let i="",r=e.length,n=Math.ceil(r/504e3),s=new Uint16Array(n>1?504e3:r);for(let r=0;r<n;r++){let n=504e3*r,o=n+504e3;i+=tn(e.subarray(n,o),e4(e3({},t),{scratchArr:s}))}return i}function to(e,t={}){return"upper"!==t.alphabet&&"function"==typeof e.toHex?e.toHex():ts(e,t)}tr[62]=45,tr[63]=95,d(tn,"_toHex"),d(ts,"_toHexChunked"),d(to,"toHex"),T();var ta=class e{constructor(e,t){this.strings=e,this.values=t}toParameterizedQuery(t={query:"",params:[]}){let{strings:i,values:r}=this;for(let n=0,o=i.length;n<o;n++)if(t.query+=i[n],n<r.length){let i=r[n];if(i instanceof tu)t.query+=i.sql;else if(i instanceof tv)if(i.queryData instanceof e)i.queryData.toParameterizedQuery(t);else{if(i.queryData.params?.length)throw Error("This query is not composable");t.query+=i.queryData.query}else{let{params:e}=t;e.push(i),t.query+="$"+e.length,(i instanceof s||ArrayBuffer.isView(i))&&(t.query+="::bytea")}}return t}};d(ta,"SqlTemplate");var tl=class{constructor(e){this.sql=e}};d(tl,"UnsafeRawSql");var tu=tl;function tc(){}T(),d(tc,"warnIfBrowser"),N();var th=b(W()),tf=b(es()),td=class e extends Error{constructor(t){super(t),v(this,"name","NeonDbError"),v(this,"severity"),v(this,"code"),v(this,"detail"),v(this,"hint"),v(this,"position"),v(this,"internalPosition"),v(this,"internalQuery"),v(this,"where"),v(this,"schema"),v(this,"table"),v(this,"column"),v(this,"dataType"),v(this,"constraint"),v(this,"file"),v(this,"line"),v(this,"routine"),v(this,"sourceError"),"captureStackTrace"in Error&&"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}};d(td,"NeonDbError");var tp="transaction() expects an array of queries, or a function returning an array of queries",tg=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function tm(e){return e instanceof s?"\\x"+to(e):e}function ty(e){let{query:t,params:i}=e instanceof ta?e.toParameterizedQuery():e;return{query:t,params:i.map(e=>tm((0,tf.prepareValue)(e)))}}function tb(e,{arrayMode:t,fullResults:i,fetchOptions:r,isolationLevel:n,readOnly:s,deferrable:o,authToken:a,disableWarningInBrowsers:l}={}){let u;if(!e)throw Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");try{u=k(e)}catch{throw Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(e))}let{protocol:c,username:h,hostname:f,port:p,pathname:g}=u;if("postgres:"!==c&&"postgresql:"!==c||!h||!f||!g)throw Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function m(e,...t){if(!(Array.isArray(e)&&Array.isArray(e.raw)&&Array.isArray(t)))throw Error('This function can now be called only as a tagged-template function: sql`SELECT ${value}`, not sql("SELECT $1", [value], options). For a conventional function call with value placeholders ($1, $2, etc.), use sql.query("SELECT $1", [value], options).');return new tv(y,new ta(e,t))}async function y(u,c,h){let d,{fetchEndpoint:g,fetchFunction:m}=B,y=Array.isArray(u)?{queries:u.map(e=>ty(e))}:ty(u),b=r??{},w=t??!1,v=i??!1,S=n,C=s,P=o;void 0!==h&&(void 0!==h.fetchOptions&&(b={...b,...h.fetchOptions}),void 0!==h.arrayMode&&(w=h.arrayMode),void 0!==h.fullResults&&(v=h.fullResults),void 0!==h.isolationLevel&&(S=h.isolationLevel),void 0!==h.readOnly&&(C=h.readOnly),void 0!==h.deferrable&&(P=h.deferrable)),void 0===c||Array.isArray(c)||void 0===c.fetchOptions||(b={...b,...c.fetchOptions});let T=a;Array.isArray(c)||c?.authToken===void 0||(T=c.authToken);let x="function"==typeof g?g(f,p,{jwtAuth:void 0!==T}):g,_={"Neon-Connection-String":e,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},E=await tC(T);E&&(_.Authorization=`Bearer ${E}`),Array.isArray(u)&&(void 0!==S&&(_["Neon-Batch-Isolation-Level"]=S),void 0!==C&&(_["Neon-Batch-Read-Only"]=String(C)),void 0!==P&&(_["Neon-Batch-Deferrable"]=String(P))),l||B.disableWarningInBrowsers||tc();try{d=await (m??fetch)(x,{method:"POST",body:JSON.stringify(y),headers:_,...b})}catch(t){let e=new td(`Error connecting to database: ${t}`);throw e.sourceError=t,e}if(d.ok){let e=await d.json();if(Array.isArray(u)){let t=e.results;if(!Array.isArray(t))throw new td("Neon internal error: unexpected result format");return t.map((e,t)=>{let i=c[t]??{};return tS(e,{arrayMode:i.arrayMode??w,fullResults:i.fullResults??v,types:i.types})})}{let t=c??{};return tS(e,{arrayMode:t.arrayMode??w,fullResults:t.fullResults??v,types:t.types})}}{let{status:e}=d;if(400===e){let e=await d.json(),t=new td(e.message);for(let i of tg)t[i]=e[i]??void 0;throw t}{let t=await d.text();throw new td(`Server error (HTTP status ${e}): ${t}`)}}}return d(m,"templateFn"),m.query=(e,t,i)=>new tv(y,{query:e,params:t??[]},i),m.unsafe=e=>new tu(e),m.transaction=async(e,t)=>{if("function"==typeof e&&(e=e(m)),!Array.isArray(e))throw Error(tp);return e.forEach(e=>{if(!(e instanceof tv))throw Error(tp)}),y(e.map(e=>e.queryData),e.map(e=>e.opts??{}),t)},d(y,"execute"),m}d(tm,"encodeBuffersAsBytea"),d(ty,"prepareQuery"),d(tb,"neon");var tw=class{constructor(e,t,i){this.execute=e,this.queryData=t,this.opts=i}then(e,t){return this.execute(this.queryData,this.opts).then(e,t)}catch(e){return this.execute(this.queryData,this.opts).catch(e)}finally(e){return this.execute(this.queryData,this.opts).finally(e)}};d(tw,"NeonQueryPromise");var tv=tw;function tS(e,{arrayMode:t,fullResults:i,types:r}){let n=new th.default(r),s=e.fields.map(e=>e.name),o=e.fields.map(e=>n.getTypeParser(e.dataTypeID)),a=!0===t?e.rows.map(e=>e.map((e,t)=>null===e?null:o[t](e))):e.rows.map(e=>Object.fromEntries(e.map((e,t)=>[s[t],null===e?null:o[t](e)])));return i?(e.viaNeonFetch=!0,e.rowAsArray=t,e.rows=a,e._parsers=o,e._types=n,e):a}async function tC(e){if("string"==typeof e)return e;if("function"==typeof e)try{return await Promise.resolve(e())}catch(t){let e=new td("Error getting auth token.");throw t instanceof Error&&(e=new td(`Error getting auth token: ${t.message}`)),e}}d(tS,"processQueryResult"),d(tC,"getAuthToken"),T();var tP=b(eZ());T();var tT=b(eZ()),tx=class extends tT.Client{constructor(e){super(e),this.config=e}get neonConfig(){return this.connection.stream}connect(e){let{neonConfig:t}=this;t.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&t.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let i="string"!=typeof this.config&&this.config?.host!==void 0||"string"!=typeof this.config&&this.config?.connectionString!==void 0||void 0!==o.env.PGHOST,r=o.env.USER??o.env.USERNAME;if(!i&&"localhost"===this.host&&this.user===r&&this.database===r&&null===this.password)throw Error(`No database host or connection string wa\
s set, and key parameters have default values (host: localhost, user: ${r}, db: ${r}, password: null\
). Is an environment variable missing? Alternatively, if you intended to connect with these paramete\
rs, please set the host to 'localhost' explicitly.`);let n=super.connect(e),s=t.pipelineTLS&&this.ssl,a="password"===t.pipelineConnect;if(!s&&!t.pipelineConnect)return n;let l=this.connection;if(s&&l.on("connect",()=>l.stream.emit("data","S")),a){l.removeAllListeners("authenticationCleartextPassword"),l.removeAllListeners("readyForQuery"),l.once("readyForQuery",()=>l.on("readyForQuery",this._handleReadyForQuery.bind(this)));let e=this.ssl?"sslconnect":"connect";l.on(e,()=>{this.neonConfig.disableWarningInBrowsers||tc(),this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return n}async _handleAuthSASLContinue(e){if(typeof crypto>"u"||void 0===crypto.subtle||void 0===crypto.subtle.importKey)throw Error("Cannot use SASL auth when `crypto.subtle` is not defined");let t=crypto.subtle,i=this.saslSession,r=this.password,n=e.data;if("SASLInitialResponse"!==i.message||"string"!=typeof r||"string"!=typeof n)throw Error("SASL: protocol error");let o=Object.fromEntries(n.split(",").map(e=>{if(!/^.=/.test(e))throw Error("SASL: Invalid attribute pair entry");return[e[0],e.substring(2)]})),a=o.r,l=o.s,u=o.i;if(!a||!/^[!-+--~]+$/.test(a))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!l||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(l))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!u||!/^[1-9][0-9]*$/.test(u))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!a.startsWith(i.clientNonce))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(a.length===i.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let c=parseInt(u,10),h=s.from(l,"base64"),f=new TextEncoder,d=f.encode(r),p=await t.importKey("raw",d,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),g=new Uint8Array(await t.sign("HMAC",p,s.concat([h,s.from([0,0,0,1])]))),m=g;for(var y=0;y<c-1;y++)g=new Uint8Array(await t.sign("HMAC",p,g)),m=s.from(m.map((e,t)=>m[t]^g[t]));let b=m,w=await t.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),v=new Uint8Array(await t.sign("HMAC",w,f.encode("Client Key"))),S=await t.digest("SHA-256",v),C="n=*,r="+i.clientNonce,P="r="+a+",s="+l+",i="+c,T="c=biws,r="+a,x=C+","+P+","+T,_=await t.importKey("raw",S,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var E=new Uint8Array(await t.sign("HMAC",_,f.encode(x))),A=s.from(v.map((e,t)=>v[t]^E[t])).toString("base64");let q=await t.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),L=await t.sign("HMAC",q,f.encode("Server Key")),B=await t.importKey("raw",L,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var N=s.from(await t.sign("HMAC",B,f.encode(x)));i.message="SASLResponse",i.serverSignature=N.toString("base64"),i.response=T+",p="+A,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};d(tx,"NeonClient"),N();var t_=b(eL());function tE(e,t){let i,r;return t?{callback:t,result:void 0}:{callback:d(function(e,t){e?i(e):r(t)},"cb"),result:new e(function(e,t){r=e,i=t})}}d(tE,"promisify"),d(class extends tP.Pool{constructor(){super(...arguments),v(this,"Client",tx),v(this,"hasFetchUnsupportedListeners",!1),v(this,"addListener",this.on)}on(e,t){return"error"!==e&&(this.hasFetchUnsupportedListeners=!0),super.on(e,t)}query(e,t,i){if(!B.poolQueryViaFetch||this.hasFetchUnsupportedListeners||"function"==typeof e)return super.query(e,t,i);"function"==typeof t&&(i=t,t=void 0);let r=tE(this.Promise,i);i=r.callback;try{let r=new t_.default(this.options),n=encodeURIComponent,s=encodeURI,o=`postgresql://${n(r.user)}:${n(r.password)}@${n(r.host)}\
/${s(r.database)}`,a="string"==typeof e?e:e.text,l=t??e.values??[];tb(o,{fullResults:!0,arrayMode:"array"===e.rowMode}).query(a,l,{types:e.types??this.options?.types}).then(e=>i(void 0,e)).catch(e=>i(e))}catch(e){i(e)}return r.result}},"NeonPool"),N();var tA=b(eZ());tA.DatabaseError,tA.defaults,tA.escapeIdentifier,tA.escapeLiteral;var tq=tA.types,tL=e.i(44988);class tB{static [tL.entityKind]="ConsoleLogWriter";write(e){console.log(e)}}class tN{static [tL.entityKind]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new tB}logQuery(e,t){let i=t.map(e=>{try{return JSON.stringify(e)}catch{return String(e)}}),r=i.length?` -- params: [${i.join(", ")}]`:"";this.writer.write(`Query: ${e}${r}`)}}class tI{static [tL.entityKind]="NoopLogger";logQuery(){}}class tk{static [tL.entityKind]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}}var tO=e.i(56325),tM=e.i(18899),tQ=e.i(69e3),tD=e.i(88274);class tR{constructor(e){this.table=e}static [tL.entityKind]="ColumnAliasProxyHandler";get(e,t){return"table"===t?this.table:e[t]}}class t${constructor(e,t){this.alias=e,this.replaceOriginalName=t}static [tL.entityKind]="TableAliasProxyHandler";get(e,t){if(t===tQ.Table.Symbol.IsAlias)return!0;if(t===tQ.Table.Symbol.Name||this.replaceOriginalName&&t===tQ.Table.Symbol.OriginalName)return this.alias;if(t===tD.ViewBaseConfig)return{...e[tD.ViewBaseConfig],name:this.alias,isAlias:!0};if(t===tQ.Table.Symbol.Columns){let t=e[tQ.Table.Symbol.Columns];if(!t)return t;let i={};return Object.keys(t).map(r=>{i[r]=new Proxy(t[r],new tR(new Proxy(e,this)))}),i}let i=e[t];return(0,tL.is)(i,tO.Column)?new Proxy(i,new tR(new Proxy(e,this))):i}}class tF{constructor(e){this.alias=e}static [tL.entityKind]="RelationTableAliasProxyHandler";get(e,t){return"sourceTable"===t?tj(e.sourceTable,this.alias):e[t]}}function tj(e,t){return new Proxy(e,new t$(t,!1))}function tU(e,t){return new Proxy(e,new tR(new Proxy(e.table,new t$(t,!1))))}function tK(e,t){return new tM.SQL.Aliased(tV(e.sql,t),e.fieldAlias)}function tV(e,t){return tM.sql.join(e.queryChunks.map(e=>(0,tL.is)(e,tO.Column)?tU(e,t):(0,tL.is)(e,tM.SQL)?tV(e,t):(0,tL.is)(e,tM.SQL.Aliased)?tK(e,t):e))}var tz=e.i(92352);class tW{static [tL.entityKind]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if("_"===t)return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===tD.ViewBaseConfig)return{...e[tD.ViewBaseConfig],selectedFields:new Proxy(e[tD.ViewBaseConfig].selectedFields,this)};if("symbol"==typeof t)return e[t];let i=((0,tL.is)(e,tz.Subquery)?e._.selectedFields:(0,tL.is)(e,tM.View)?e[tD.ViewBaseConfig].selectedFields:e)[t];if((0,tL.is)(i,tM.SQL.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!i.isSelectionField)return i.sql;let e=i.clone();return e.isSelectionField=!0,e}if((0,tL.is)(i,tM.SQL)){if("sql"===this.config.sqlBehavior)return i;throw Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return(0,tL.is)(i,tO.Column)?this.config.alias?new Proxy(i,new tR(new Proxy(i.table,new t$(this.config.alias,this.config.replaceOriginalName??!1)))):i:"object"!=typeof i||null===i?i:new Proxy(i,new tW(this.config))}}var tH=e.i(22360),tJ=e.i(4313),tG=e.i(94093);class tY{constructor(e,t){this.name=e,this.value=t}static [tL.entityKind]="PgCheckBuilder";brand;build(e){return new tZ(e,this)}}class tZ{constructor(e,t){this.table=e,this.name=t.name,this.value=t.value}static [tL.entityKind]="PgCheck";name;value}e.i(63411);var tX=e.i(4775);class t0{constructor(e,t){this.unique=e,this.name=t}static [tL.entityKind]="PgIndexBuilderOn";on(...e){return new t1(e.map(e=>{if((0,tL.is)(e,tM.SQL))return e;let t=new tX.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),t}),this.unique,!1,this.name)}onOnly(...e){return new t1(e.map(e=>{if((0,tL.is)(e,tM.SQL))return e;let t=new tX.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=e.defaultConfig,t}),this.unique,!0,this.name)}using(e,...t){return new t1(t.map(e=>{if((0,tL.is)(e,tM.SQL))return e;let t=new tX.IndexedColumn(e.name,!!e.keyAsName,e.columnType,e.indexConfig);return e.indexConfig=JSON.parse(JSON.stringify(e.defaultConfig)),t}),this.unique,!0,this.name,e)}}class t1{static [tL.entityKind]="PgIndexBuilder";config;constructor(e,t,i,r,n="btree"){this.config={name:r,columns:e,unique:t,only:i,method:n}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new t2(this.config,e)}}class t2{static [tL.entityKind]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}}class t6{constructor(e,t){this.name=e,t&&(this.as=t.as,this.for=t.for,this.to=t.to,this.using=t.using,this.withCheck=t.withCheck)}static [tL.entityKind]="PgPolicy";as;for;to;using;withCheck;_linkedTable;link(e){return this._linkedTable=e,this}}class t5{static [tL.entityKind]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new t8(e,this.columns,this.name)}}class t8{constructor(e,t,i){this.table=e,this.columns=t,this.name=i}static [tL.entityKind]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[tG.PgTable.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}e.i(43233);let t3=Symbol.for("drizzle:PgViewConfig");function t4(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(e=>e.toLowerCase()).join("_")}function t7(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((e,t,i)=>e+(0===i?t.toLowerCase():`${t[0].toUpperCase()}${t.slice(1)}`),"")}function t9(e){return e}class ie{static [tL.entityKind]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert="snake_case"===e?t4:"camelCase"===e?t7:t9}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[tQ.Table.Symbol.Schema]??"public",i=e.table[tQ.Table.Symbol.OriginalName],r=`${t}.${i}.${e.name}`;return this.cache[r]||this.cacheTable(e.table),this.cache[r]}cacheTable(e){let t=e[tQ.Table.Symbol.Schema]??"public",i=e[tQ.Table.Symbol.OriginalName],r=`${t}.${i}`;if(!this.cachedTables[r]){for(let t of Object.values(e[tQ.Table.Symbol.Columns])){let e=`${r}.${t.name}`;this.cache[e]=this.convert(t.name)}this.cachedTables[r]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class it extends Error{static [tL.entityKind]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}}class ii extends Error{constructor(e,t,i){super(`Failed query: ${e}
params: ${t}`),this.query=e,this.params=t,this.cause=i,Error.captureStackTrace(this,ii),i&&(this.cause=i)}}class ir extends it{static [tL.entityKind]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}var is=e.i(56923),io=e.i(1727),ia=e.i(38257),il=e.i(48209),iu=e.i(93486),ic=e.i(3090),ih=e.i(67751),id=e.i(75225);function ip(e){return tM.sql`${e} asc`}function ig(e){return tM.sql`${e} desc`}class im{constructor(e,t,i){this.sourceTable=e,this.referencedTable=t,this.relationName=i,this.referencedTableName=t[tQ.Table.Symbol.Name]}static [tL.entityKind]="Relation";referencedTableName;fieldName}class iy{constructor(e,t){this.table=e,this.config=t}static [tL.entityKind]="Relations"}class ib extends im{constructor(e,t,i,r){super(e,t,i?.relationName),this.config=i,this.isNullable=r}static [tL.entityKind]="One";withFieldName(e){let t=new ib(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}}class iw extends im{constructor(e,t,i){super(e,t,i?.relationName),this.config=i}static [tL.entityKind]="Many";withFieldName(e){let t=new iw(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}}function iv(e){return{one:function(t,i){return new ib(e,t,i,i?.fields.reduce((e,t)=>e&&t.notNull,!0)??!1)},many:function(t,i){return new iw(e,t,i)}}}var iS=tM;class iC extends iS.View{static [tL.entityKind]="PgViewBase"}class iP{static [tL.entityKind]="PgDialect";casing;constructor(e){this.casing=new ie(e?.casing)}async migrate(e,t,i){let r="string"==typeof i?"__drizzle_migrations":i.migrationsTable??"__drizzle_migrations",n="string"==typeof i?"drizzle":i.migrationsSchema??"drizzle",s=tM.sql`
			CREATE TABLE IF NOT EXISTS ${tM.sql.identifier(n)}.${tM.sql.identifier(r)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(tM.sql`CREATE SCHEMA IF NOT EXISTS ${tM.sql.identifier(n)}`),await t.execute(s);let o=(await t.all(tM.sql`select id, hash, created_at from ${tM.sql.identifier(n)}.${tM.sql.identifier(r)} order by created_at desc limit 1`))[0];await t.transaction(async t=>{for await(let i of e)if(!o||Number(o.created_at)<i.folderMillis){for(let e of i.sql)await t.execute(tM.sql.raw(e));await t.execute(tM.sql`insert into ${tM.sql.identifier(n)}.${tM.sql.identifier(r)} ("hash", "created_at") values(${i.hash}, ${i.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[tM.sql`with `];for(let[i,r]of e.entries())t.push(tM.sql`${tM.sql.identifier(r._.alias)} as (${r._.sql})`),i<e.length-1&&t.push(tM.sql`, `);return t.push(tM.sql` `),tM.sql.join(t)}buildDeleteQuery({table:e,where:t,returning:i,withList:r}){let n=this.buildWithCTE(r),s=i?tM.sql` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,o=t?tM.sql` where ${t}`:void 0;return tM.sql`${n}delete from ${e}${o}${s}`}buildUpdateSet(e,t){let i=e[tQ.Table.Symbol.Columns],r=Object.keys(i).filter(e=>void 0!==t[e]||i[e]?.onUpdateFn!==void 0),n=r.length;return tM.sql.join(r.flatMap((e,r)=>{let s=i[e],o=s.onUpdateFn?.(),a=t[e]??((0,tL.is)(o,tM.SQL)?o:tM.sql.param(o,s)),l=tM.sql`${tM.sql.identifier(this.casing.getColumnCasing(s))} = ${a}`;return r<n-1?[l,tM.sql.raw(", ")]:[l]}))}buildUpdateQuery({table:e,set:t,where:i,returning:r,withList:n,from:s,joins:o}){let a=this.buildWithCTE(n),l=e[tG.PgTable.Symbol.Name],u=e[tG.PgTable.Symbol.Schema],c=e[tG.PgTable.Symbol.OriginalName],h=l===c?void 0:l,f=tM.sql`${u?tM.sql`${tM.sql.identifier(u)}.`:void 0}${tM.sql.identifier(c)}${h&&tM.sql` ${tM.sql.identifier(h)}`}`,d=this.buildUpdateSet(e,t),p=s&&tM.sql.join([tM.sql.raw(" from "),this.buildFromTable(s)]),g=this.buildJoins(o),m=r?tM.sql` returning ${this.buildSelection(r,{isSingleTable:!s})}`:void 0,y=i?tM.sql` where ${i}`:void 0;return tM.sql`${a}update ${f} set ${d}${p}${g}${y}${m}`}buildSelection(e,{isSingleTable:t=!1}={}){let i=e.length,r=e.flatMap(({field:e},r)=>{let n=[];if((0,tL.is)(e,tM.SQL.Aliased)&&e.isSelectionField)n.push(tM.sql.identifier(e.fieldAlias));else if((0,tL.is)(e,tM.SQL.Aliased)||(0,tL.is)(e,tM.SQL)){let i=(0,tL.is)(e,tM.SQL.Aliased)?e.sql:e;t?n.push(new tM.SQL(i.queryChunks.map(e=>(0,tL.is)(e,tX.PgColumn)?tM.sql.identifier(this.casing.getColumnCasing(e)):e))):n.push(i),(0,tL.is)(e,tM.SQL.Aliased)&&n.push(tM.sql` as ${tM.sql.identifier(e.fieldAlias)}`)}else if((0,tL.is)(e,tO.Column))t?n.push(tM.sql.identifier(this.casing.getColumnCasing(e))):n.push(e);else if((0,tL.is)(e,tz.Subquery)){let t=Object.entries(e._.selectedFields);if(1===t.length){let i=t[0][1],r=(0,tL.is)(i,tM.SQL)?i.decoder:(0,tL.is)(i,tO.Column)?{mapFromDriverValue:e=>i.mapFromDriverValue(e)}:i.sql.decoder;r&&(e._.sql.decoder=r)}n.push(e)}return r<i-1&&n.push(tM.sql`, `),n});return tM.sql.join(r)}buildJoins(e){if(!e||0===e.length)return;let t=[];for(let[i,r]of e.entries()){0===i&&t.push(tM.sql` `);let n=r.table,s=r.lateral?tM.sql` lateral`:void 0,o=r.on?tM.sql` on ${r.on}`:void 0;if((0,tL.is)(n,tG.PgTable)){let e=n[tG.PgTable.Symbol.Name],i=n[tG.PgTable.Symbol.Schema],a=n[tG.PgTable.Symbol.OriginalName],l=e===a?void 0:r.alias;t.push(tM.sql`${tM.sql.raw(r.joinType)} join${s} ${i?tM.sql`${tM.sql.identifier(i)}.`:void 0}${tM.sql.identifier(a)}${l&&tM.sql` ${tM.sql.identifier(l)}`}${o}`)}else if((0,tL.is)(n,tM.View)){let e=n[tD.ViewBaseConfig].name,i=n[tD.ViewBaseConfig].schema,a=n[tD.ViewBaseConfig].originalName,l=e===a?void 0:r.alias;t.push(tM.sql`${tM.sql.raw(r.joinType)} join${s} ${i?tM.sql`${tM.sql.identifier(i)}.`:void 0}${tM.sql.identifier(a)}${l&&tM.sql` ${tM.sql.identifier(l)}`}${o}`)}else t.push(tM.sql`${tM.sql.raw(r.joinType)} join${s} ${n}${o}`);i<e.length-1&&t.push(tM.sql` `)}return tM.sql.join(t)}buildFromTable(e){if((0,tL.is)(e,tQ.Table)&&e[tQ.Table.Symbol.IsAlias]){let t=tM.sql`${tM.sql.identifier(e[tQ.Table.Symbol.OriginalName])}`;return e[tQ.Table.Symbol.Schema]&&(t=tM.sql`${tM.sql.identifier(e[tQ.Table.Symbol.Schema])}.${t}`),tM.sql`${t} ${tM.sql.identifier(e[tQ.Table.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:i,where:r,having:n,table:s,joins:o,orderBy:a,groupBy:l,limit:u,offset:c,lockingClause:h,distinct:f,setOperators:d}){let p,g,m,y=i??(0,tJ.orderSelectedFields)(t);for(let e of y){let t;if((0,tL.is)(e.field,tO.Column)&&(0,tQ.getTableName)(e.field.table)!==((0,tL.is)(s,tz.Subquery)?s._.alias:(0,tL.is)(s,iC)?s[tD.ViewBaseConfig].name:(0,tL.is)(s,tM.SQL)?void 0:(0,tQ.getTableName)(s))&&(t=e.field.table,!o?.some(({alias:e})=>e===(t[tQ.Table.Symbol.IsAlias]?(0,tQ.getTableName)(t):t[tQ.Table.Symbol.BaseName])))){let t=(0,tQ.getTableName)(e.field.table);throw Error(`Your "${e.path.join("->")}" field references a column "${t}"."${e.field.name}", but the table "${t}" is not part of the query! Did you forget to join it?`)}}let b=!o||0===o.length,w=this.buildWithCTE(e);f&&(p=!0===f?tM.sql` distinct`:tM.sql` distinct on (${tM.sql.join(f.on,tM.sql`, `)})`);let v=this.buildSelection(y,{isSingleTable:b}),S=this.buildFromTable(s),C=this.buildJoins(o),P=r?tM.sql` where ${r}`:void 0,T=n?tM.sql` having ${n}`:void 0;a&&a.length>0&&(g=tM.sql` order by ${tM.sql.join(a,tM.sql`, `)}`),l&&l.length>0&&(m=tM.sql` group by ${tM.sql.join(l,tM.sql`, `)}`);let x="object"==typeof u||"number"==typeof u&&u>=0?tM.sql` limit ${u}`:void 0,_=c?tM.sql` offset ${c}`:void 0,E=tM.sql.empty();if(h){let e=tM.sql` for ${tM.sql.raw(h.strength)}`;h.config.of&&e.append(tM.sql` of ${tM.sql.join(Array.isArray(h.config.of)?h.config.of:[h.config.of],tM.sql`, `)}`),h.config.noWait?e.append(tM.sql` nowait`):h.config.skipLocked&&e.append(tM.sql` skip locked`),E.append(e)}let A=tM.sql`${w}select${p} ${v} from ${S}${C}${P}${m}${T}${g}${x}${_}${E}`;return d.length>0?this.buildSetOperations(A,d):A}buildSetOperations(e,t){let[i,...r]=t;if(!i)throw Error("Cannot pass undefined values to any set operator");return 0===r.length?this.buildSetOperationQuery({leftSelect:e,setOperator:i}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:i}),r)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:i,rightSelect:r,limit:n,orderBy:s,offset:o}}){let a,l=tM.sql`(${e.getSQL()}) `,u=tM.sql`(${r.getSQL()})`;if(s&&s.length>0){let e=[];for(let t of s)if((0,tL.is)(t,tX.PgColumn))e.push(tM.sql.identifier(t.name));else if((0,tL.is)(t,tM.SQL)){for(let e=0;e<t.queryChunks.length;e++){let i=t.queryChunks[e];(0,tL.is)(i,tX.PgColumn)&&(t.queryChunks[e]=tM.sql.identifier(i.name))}e.push(tM.sql`${t}`)}else e.push(tM.sql`${t}`);a=tM.sql` order by ${tM.sql.join(e,tM.sql`, `)} `}let c="object"==typeof n||"number"==typeof n&&n>=0?tM.sql` limit ${n}`:void 0,h=tM.sql.raw(`${t} ${i?"all ":""}`),f=o?tM.sql` offset ${o}`:void 0;return tM.sql`${l}${h}${u}${a}${c}${f}`}buildInsertQuery({table:e,values:t,onConflict:i,returning:r,withList:n,select:s,overridingSystemValue_:o}){let a=[],l=Object.entries(e[tQ.Table.Symbol.Columns]).filter(([e,t])=>!t.shouldDisableInsert()),u=l.map(([,e])=>tM.sql.identifier(this.casing.getColumnCasing(e)));if(s)(0,tL.is)(t,tM.SQL)?a.push(t):a.push(t.getSQL());else for(let[e,i]of(a.push(tM.sql.raw("values ")),t.entries())){let r=[];for(let[e,t]of l){let n=i[e];if(void 0===n||(0,tL.is)(n,tM.Param)&&void 0===n.value)if(void 0!==t.defaultFn){let e=t.defaultFn(),i=(0,tL.is)(e,tM.SQL)?e:tM.sql.param(e,t);r.push(i)}else if(t.default||void 0===t.onUpdateFn)r.push(tM.sql`default`);else{let e=t.onUpdateFn(),i=(0,tL.is)(e,tM.SQL)?e:tM.sql.param(e,t);r.push(i)}else r.push(n)}a.push(r),e<t.length-1&&a.push(tM.sql`, `)}let c=this.buildWithCTE(n),h=tM.sql.join(a),f=r?tM.sql` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,d=i?tM.sql` on conflict ${i}`:void 0,p=!0===o?tM.sql`overriding system value `:void 0;return tM.sql`${c}insert into ${e} ${u} ${p}${h}${d}${f}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:i}){let r=t?tM.sql` concurrently`:void 0,n=i?tM.sql` with no data`:void 0;return tM.sql`refresh materialized view${r} ${e}${n}`}prepareTyping(e){if((0,tL.is)(e,ia.PgJsonb)||(0,tL.is)(e,io.PgJson))return"json";if((0,tL.is)(e,il.PgNumeric))return"decimal";if((0,tL.is)(e,iu.PgTime))return"time";if((0,tL.is)(e,ic.PgTimestamp)||(0,tL.is)(e,ic.PgTimestampString))return"timestamp";if((0,tL.is)(e,is.PgDate)||(0,tL.is)(e,is.PgDateString))return"date";else if((0,tL.is)(e,ih.PgUUID))return"uuid";else return"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:i,table:r,tableConfig:n,queryConfig:s,tableAlias:o,nestedQueryRelation:a,joinOn:l}){let u,c=[],h,f,d=[],p,g=[];if(!0===s)c=Object.entries(n.columns).map(([e,t])=>({dbKey:t.name,tsKey:e,field:tU(t,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let r=Object.fromEntries(Object.entries(n.columns).map(([e,t])=>[e,tU(t,o)]));if(s.where){let e="function"==typeof s.where?s.where(r,{and:id.and,between:id.between,eq:id.eq,exists:id.exists,gt:id.gt,gte:id.gte,ilike:id.ilike,inArray:id.inArray,isNull:id.isNull,isNotNull:id.isNotNull,like:id.like,lt:id.lt,lte:id.lte,ne:id.ne,not:id.not,notBetween:id.notBetween,notExists:id.notExists,notLike:id.notLike,notIlike:id.notIlike,notInArray:id.notInArray,or:id.or,sql:tM.sql}):s.where;p=e&&tV(e,o)}let a=[],l=[];if(s.columns){let e=!1;for(let[t,i]of Object.entries(s.columns))void 0!==i&&t in n.columns&&(e||!0!==i||(e=!0),l.push(t));l.length>0&&(l=e?l.filter(e=>s.columns?.[e]===!0):Object.keys(n.columns).filter(e=>!l.includes(e)))}else l=Object.keys(n.columns);for(let e of l){let t=n.columns[e];a.push({tsKey:e,value:t})}let u=[];if(s.with&&(u=Object.entries(s.with).filter(e=>!!e[1]).map(([e,t])=>({tsKey:e,queryConfig:t,relation:n.relations[e]}))),s.extras)for(let[e,t]of Object.entries("function"==typeof s.extras?s.extras(r,{sql:tM.sql}):s.extras))a.push({tsKey:e,value:tK(t,o)});for(let{tsKey:e,value:t}of a)c.push({dbKey:(0,tL.is)(t,tM.SQL.Aliased)?t.fieldAlias:n.columns[e].name,tsKey:e,field:(0,tL.is)(t,tO.Column)?tU(t,o):t,relationTableTsKey:void 0,isJson:!1,selection:[]});let m="function"==typeof s.orderBy?s.orderBy(r,{sql:tM.sql,asc:ip,desc:ig}):s.orderBy??[];for(let{tsKey:r,queryConfig:n,relation:a}of(Array.isArray(m)||(m=[m]),d=m.map(e=>(0,tL.is)(e,tO.Column)?tU(e,o):tV(e,o)),h=s.limit,f=s.offset,u)){let s=function(e,t,i){if((0,tL.is)(i,ib)&&i.config)return{fields:i.config.fields,references:i.config.references};let r=t[(0,tQ.getTableUniqueName)(i.referencedTable)];if(!r)throw Error(`Table "${i.referencedTable[tQ.Table.Symbol.Name]}" not found in schema`);let n=e[r];if(!n)throw Error(`Table "${r}" not found in schema`);let s=i.sourceTable,o=t[(0,tQ.getTableUniqueName)(s)];if(!o)throw Error(`Table "${s[tQ.Table.Symbol.Name]}" not found in schema`);let a=[];for(let e of Object.values(n.relations))(i.relationName&&i!==e&&e.relationName===i.relationName||!i.relationName&&e.referencedTable===i.sourceTable)&&a.push(e);if(a.length>1)throw i.relationName?Error(`There are multiple relations with name "${i.relationName}" in table "${r}"`):Error(`There are multiple relations between "${r}" and "${i.sourceTable[tQ.Table.Symbol.Name]}". Please specify relation name`);if(a[0]&&(0,tL.is)(a[0],ib)&&a[0].config)return{fields:a[0].config.references,references:a[0].config.fields};throw Error(`There is not enough information to infer relation "${o}.${i.fieldName}"`)}(t,i,a),l=i[(0,tQ.getTableUniqueName)(a.referencedTable)],u=`${o}_${r}`,h=(0,id.and)(...s.fields.map((e,t)=>(0,id.eq)(tU(s.references[t],u),tU(e,o)))),f=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:i,table:e[l],tableConfig:t[l],queryConfig:(0,tL.is)(a,ib)?!0===n?{limit:1}:{...n,limit:1}:n,tableAlias:u,joinOn:h,nestedQueryRelation:a}),d=tM.sql`${tM.sql.identifier(u)}.${tM.sql.identifier("data")}`.as(r);g.push({on:tM.sql`true`,table:new tz.Subquery(f.sql,{},u),alias:u,joinType:"left",lateral:!0}),c.push({dbKey:r,tsKey:r,field:d,relationTableTsKey:l,isJson:!0,selection:f.selection})}}if(0===c.length)throw new it({message:`No fields selected for table "${n.tsName}" ("${o}")`});if(p=(0,id.and)(l,p),a){let e=tM.sql`json_build_array(${tM.sql.join(c.map(({field:e,tsKey:t,isJson:i})=>i?tM.sql`${tM.sql.identifier(`${o}_${t}`)}.${tM.sql.identifier("data")}`:(0,tL.is)(e,tM.SQL.Aliased)?e.sql:e),tM.sql`, `)})`;(0,tL.is)(a,iw)&&(e=tM.sql`coalesce(json_agg(${e}${d.length>0?tM.sql` order by ${tM.sql.join(d,tM.sql`, `)}`:void 0}), '[]'::json)`);let t=[{dbKey:"data",tsKey:"data",field:e.as("data"),isJson:!0,relationTableTsKey:n.tsName,selection:c}];void 0!==h||void 0!==f||d.length>0?(u=this.buildSelectQuery({table:tj(r,o),fields:{},fieldsFlat:[{path:[],field:tM.sql.raw("*")}],where:p,limit:h,offset:f,orderBy:d,setOperators:[]}),p=void 0,h=void 0,f=void 0,d=[]):u=tj(r,o),u=this.buildSelectQuery({table:(0,tL.is)(u,tG.PgTable)?u:new tz.Subquery(u,{},o),fields:{},fieldsFlat:t.map(({field:e})=>({path:[],field:(0,tL.is)(e,tO.Column)?tU(e,o):e})),joins:g,where:p,limit:h,offset:f,orderBy:d,setOperators:[]})}else u=this.buildSelectQuery({table:tj(r,o),fields:{},fieldsFlat:c.map(({field:e})=>({path:[],field:(0,tL.is)(e,tO.Column)?tU(e,o):e})),joins:g,where:p,limit:h,offset:f,orderBy:d,setOperators:[]});return{tableTsKey:n.tsName,sql:u,selection:c}}}class iT{static [tL.entityKind]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class ix{static [tL.entityKind]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let t,i=!!this.fields;return t=this.fields?this.fields:(0,tL.is)(e,tz.Subquery)?Object.fromEntries(Object.keys(e._.selectedFields).map(t=>[t,e[t]])):(0,tL.is)(e,iC)?e[tD.ViewBaseConfig].selectedFields:(0,tL.is)(e,tM.SQL)?{}:(0,tJ.getTableColumns)(e),new iE({table:e,fields:t,isPartialSelect:i,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class i_ extends iT{static [tL.entityKind]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:e,fields:t,isPartialSelect:i,session:r,dialect:n,withList:s,distinct:o}){for(const a of(super(),this.config={withList:s,table:e,fields:{...t},distinct:o,setOperators:[]},this.isPartialSelect=i,this.session=r,this.dialect=n,this._={selectedFields:t,config:this.config},this.tableName=(0,tJ.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},iz(e)))this.usedTables.add(a)}getUsedTables(){return[...this.usedTables]}createJoin(e,t){return(i,r)=>{let n=this.tableName,s=(0,tJ.getTableLikeName)(i);for(let e of iz(i))this.usedTables.add(e);if("string"==typeof s&&this.config.joins?.some(e=>e.alias===s))throw Error(`Alias "${s}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof n&&(this.config.fields={[n]:this.config.fields}),"string"==typeof s&&!(0,tL.is)(i,tM.SQL))){let e=(0,tL.is)(i,tz.Subquery)?i._.selectedFields:(0,tL.is)(i,tM.View)?i[tD.ViewBaseConfig].selectedFields:i[tQ.Table.Symbol.Columns];this.config.fields[s]=e}if("function"==typeof r&&(r=r(new Proxy(this.config.fields,new tW({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:r,table:i,joinType:e,alias:s,lateral:t}),"string"==typeof s)switch(e){case"left":this.joinsNotNullableMap[s]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[s]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[s]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[s]=!1}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);fullJoin=this.createJoin("full",!1);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(e,t){return i=>{let r="function"==typeof i?i(iq()):i;if(!(0,tJ.haveSameKeys)(this.getSelectedFields(),r.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:r}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new tW({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return"function"==typeof e&&(e=e(new Proxy(this.config.fields,new tW({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new tW({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if("function"==typeof e[0]){let t=e[0](new Proxy(this.config.fields,new tW({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=e:this.config.orderBy=e;return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){let t=[];if(t.push(...iz(this.config.table)),this.config.joins)for(let e of this.config.joins)t.push(...iz(e.table));return new Proxy(new tz.Subquery(this.getSQL(),this.config.fields,e,!1,[...new Set(t)]),new tW({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new tW({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(e){return this.cacheConfig=void 0===e?{config:{},enable:!0,autoInvalidate:!0}:!1===e?{enable:!1}:{enable:!0,autoInvalidate:!0,...e},this}}class iE extends i_{static [tL.entityKind]="PgSelect";_prepare(e){let{session:t,config:i,dialect:r,joinsNotNullableMap:n,authToken:s,cacheConfig:o,usedTables:a}=this;if(!t)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let{fields:l}=i;return tH.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let i=(0,tJ.orderSelectedFields)(l),u=t.prepareQuery(r.sqlToQuery(this.getSQL()),i,e,!0,void 0,{type:"select",tables:[...a]},o);return u.joinsNotNullableMap=n,u.setToken(s)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tH.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}function iA(e,t){return(i,r,...n)=>{let s=[r,...n].map(i=>({type:e,isAll:t,rightSelect:i}));for(let e of s)if(!(0,tJ.haveSameKeys)(i.getSelectedFields(),e.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return i.addSetOperators(s)}}(0,tJ.applyMixins)(iE,[tk]);let iq=()=>({union:iL,unionAll:iB,intersect:iN,intersectAll:iI,except:ik,exceptAll:iO}),iL=iA("union",!1),iB=iA("union",!0),iN=iA("intersect",!1),iI=iA("intersect",!0),ik=iA("except",!1),iO=iA("except",!0);class iM{static [tL.entityKind]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=(0,tL.is)(e,iP)?e:void 0,this.dialectConfig=(0,tL.is)(e,iP)?void 0:e}$with=(e,t)=>{let i=this;return{as:r=>("function"==typeof r&&(r=r(i)),new Proxy(new tz.WithSubquery(r.getSQL(),t??("getSelectedFields"in r?r.getSelectedFields()??{}:{}),e,!0),new tW({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let t=this;return{select:function(i){return new ix({fields:i??void 0,session:void 0,dialect:t.getDialect(),withList:e})},selectDistinct:function(e){return new ix({fields:e??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})},selectDistinctOn:function(e,i){return new ix({fields:i??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:e}})}}}select(e){return new ix({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new ix({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new ix({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new iP(this.dialectConfig)),this.dialect}}class iQ{constructor(e,t){this.name=e,this.schema=t}static [tL.entityKind]="PgDefaultViewBuilderCore";config={};with(e){return this.config.with=e,this}}class iD extends iQ{static [tL.entityKind]="PgViewBuilder";as(e){"function"==typeof e&&(e=e(new iM));let t=new tW({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),i=new Proxy(e.getSelectedFields(),t);return new Proxy(new iU({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:i,query:e.getSQL().inlineParams()}}),t)}}class iR extends iQ{static [tL.entityKind]="PgManualViewBuilder";columns;constructor(e,t,i){super(e,i),this.columns=(0,tJ.getTableColumns)((0,tG.pgTable)(e,t))}existing(){return new Proxy(new iU({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new tW({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new iU({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new tW({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}class i${constructor(e,t){this.name=e,this.schema=t}static [tL.entityKind]="PgMaterializedViewBuilderCore";config={};using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}}class iF extends i${static [tL.entityKind]="PgMaterializedViewBuilder";as(e){"function"==typeof e&&(e=e(new iM));let t=new tW({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),i=new Proxy(e.getSelectedFields(),t);return new Proxy(new iV({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:i,query:e.getSQL().inlineParams()}}),t)}}class ij extends i${static [tL.entityKind]="PgManualMaterializedViewBuilder";columns;constructor(e,t,i){super(e,i),this.columns=(0,tJ.getTableColumns)((0,tG.pgTable)(e,t))}existing(){return new Proxy(new iV({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new tW({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new iV({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new tW({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}class iU extends iC{static [tL.entityKind]="PgView";[t3];constructor({pgConfig:e,config:t}){super(t),e&&(this[t3]={with:e.with})}}let iK=Symbol.for("drizzle:PgMaterializedViewConfig");class iV extends iC{static [tL.entityKind]="PgMaterializedView";[iK];constructor({pgConfig:e,config:t}){super(t),this[iK]={with:e?.with,using:e?.using,tablespace:e?.tablespace,withNoData:e?.withNoData}}}function iz(e){return(0,tL.is)(e,tG.PgTable)?[e[tQ.Schema]?`${e[tQ.Schema]}.${e[tQ.Table.Symbol.BaseName]}`:e[tQ.Table.Symbol.BaseName]]:(0,tL.is)(e,tz.Subquery)?e._.usedTables??[]:(0,tL.is)(e,tM.SQL)?e.usedTables??[]:[]}class iW extends tk{constructor(e,t,i,r){super(),this.session=t,this.dialect=i,this.config={table:e,withList:r}}static [tL.entityKind]="PgDelete";config;cacheConfig;where(e){return this.config.where=e,this}returning(e=this.config.table[tQ.Table.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=(0,tJ.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return tH.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"delete",tables:iz(this.config.table)},this.cacheConfig))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tH.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new tW({alias:(0,tQ.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class iH{constructor(e,t,i,r,n){this.table=e,this.session=t,this.dialect=i,this.withList=r,this.overridingSystemValue_=n}static [tL.entityKind]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(0===(e=Array.isArray(e)?e:[e]).length)throw Error("values() must be called with at least one value");let t=e.map(e=>{let t={},i=this.table[tQ.Table.Symbol.Columns];for(let r of Object.keys(e)){let n=e[r];t[r]=(0,tL.is)(n,tM.SQL)?n:new tM.Param(n,i[r])}return t});return new iJ(this.table,t,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let t="function"==typeof e?e(new iM):e;if(!(0,tL.is)(t,tM.SQL)&&!(0,tJ.haveSameKeys)(this.table[tQ.Columns],t._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new iJ(this.table,t,this.session,this.dialect,this.withList,!0)}}class iJ extends tk{constructor(e,t,i,r,n,s,o){super(),this.session=i,this.dialect=r,this.config={table:e,values:t,withList:n,select:s,overridingSystemValue_:o}}static [tL.entityKind]="PgInsert";config;cacheConfig;returning(e=this.config.table[tQ.Table.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=(0,tJ.orderSelectedFields)(e),this}onConflictDoNothing(e={}){if(void 0===e.target)this.config.onConflict=tM.sql`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let i=e.where?tM.sql` where ${e.where}`:void 0;this.config.onConflict=tM.sql`(${tM.sql.raw(t)})${i} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?tM.sql` where ${e.where}`:void 0,i=e.targetWhere?tM.sql` where ${e.targetWhere}`:void 0,r=e.setWhere?tM.sql` where ${e.setWhere}`:void 0,n=this.dialect.buildUpdateSet(this.config.table,(0,tJ.mapUpdateSet)(this.config.table,e.set)),s="";return s=Array.isArray(e.target)?e.target.map(e=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(e))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=tM.sql`(${tM.sql.raw(s)})${i} do update set ${n}${t}${r}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return tH.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"insert",tables:iz(this.config.table)},this.cacheConfig))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tH.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new tW({alias:(0,tQ.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class iG{constructor(e,t,i,r){this.table=e,this.session=t,this.dialect=i,this.withList=r}static [tL.entityKind]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new iY(this.table,(0,tJ.mapUpdateSet)(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}}class iY extends tk{constructor(e,t,i,r,n){super(),this.session=i,this.dialect=r,this.config={set:t,table:e,withList:n,joins:[]},this.tableName=(0,tJ.getTableLikeName)(e),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [tL.entityKind]="PgUpdate";config;tableName;joinsNotNullableMap;cacheConfig;from(e){let t=(0,tJ.getTableLikeName)(e);return"string"==typeof t&&(this.joinsNotNullableMap[t]=!0),this.config.from=e,this}getTableLikeFields(e){return(0,tL.is)(e,tG.PgTable)?e[tQ.Table.Symbol.Columns]:(0,tL.is)(e,tz.Subquery)?e._.selectedFields:e[tD.ViewBaseConfig].selectedFields}createJoin(e){return(t,i)=>{let r=(0,tJ.getTableLikeName)(t);if("string"==typeof r&&this.config.joins.some(e=>e.alias===r))throw Error(`Alias "${r}" is already used in this query`);if("function"==typeof i){let e=this.config.from&&!(0,tL.is)(this.config.from,tM.SQL)?this.getTableLikeFields(this.config.from):void 0;i=i(new Proxy(this.config.table[tQ.Table.Symbol.Columns],new tW({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),e&&new Proxy(e,new tW({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:i,table:t,joinType:e,alias:r}),"string"==typeof r)switch(e){case"left":this.joinsNotNullableMap[r]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[r]=!0;break;case"inner":this.joinsNotNullableMap[r]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([e])=>[e,!1])),this.joinsNotNullableMap[r]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[tQ.Table.Symbol.Columns]),this.config.from)){let t=(0,tJ.getTableLikeName)(this.config.from);if("string"==typeof t&&this.config.from&&!(0,tL.is)(this.config.from,tM.SQL)){let i=this.getTableLikeFields(this.config.from);e[t]=i}for(let t of this.config.joins){let i=(0,tJ.getTableLikeName)(t.table);if("string"==typeof i&&!(0,tL.is)(t.table,tM.SQL)){let r=this.getTableLikeFields(t.table);e[i]=r}}}return this.config.returningFields=e,this.config.returning=(0,tJ.orderSelectedFields)(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"insert",tables:iz(this.config.table)},this.cacheConfig);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new tW({alias:(0,tQ.getTableName)(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}var iZ=tM;class iX extends iZ.SQL{constructor(e){super(iX.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=iX.buildCount(e.source,e.filters)}sql;token;static [tL.entityKind]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return iZ.sql`(select count(*) from ${e}${iZ.sql.raw(" where ").if(t)}${t})`}static buildCount(e,t){return iZ.sql`select count(*) as count from ${e}${iZ.sql.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}}class i0{constructor(e,t,i,r,n,s,o){this.fullSchema=e,this.schema=t,this.tableNamesMap=i,this.table=r,this.tableConfig=n,this.dialect=s,this.session=o}static [tL.entityKind]="PgRelationalQueryBuilder";findMany(e){return new i1(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new i1(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}class i1 extends tk{constructor(e,t,i,r,n,s,o,a,l){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=i,this.table=r,this.tableConfig=n,this.dialect=s,this.session=o,this.config=a,this.mode=l}static [tL.entityKind]="PgRelationalQuery";_prepare(e){return tH.tracer.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:i}=this._toSQL();return this.session.prepareQuery(i,void 0,e,!0,(e,i)=>{let r=e.map(e=>(function e(t,i,r,n,s=e=>e){let o={};for(let[a,l]of n.entries())if(l.isJson){let n=i.relations[l.tsKey],u=r[a],c="string"==typeof u?JSON.parse(u):u;o[l.tsKey]=(0,tL.is)(n,ib)?c&&e(t,t[l.relationTableTsKey],c,l.selection,s):c.map(i=>e(t,t[l.relationTableTsKey],i,l.selection,s))}else{let e,t=s(r[a]),i=l.field;e=(0,tL.is)(i,tO.Column)?i:(0,tL.is)(i,tM.SQL)?i.decoder:i.sql.decoder,o[l.tsKey]=null===t?null:e.mapFromDriverValue(t)}return o})(this.schema,this.tableConfig,e,t.selection,i));return"first"===this.mode?r[0]:r})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return tH.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}class i2 extends tk{constructor(e,t,i,r){super(),this.execute=e,this.sql=t,this.query=i,this.mapBatchResult=r}static [tL.entityKind]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}class i6 extends tk{constructor(e,t,i){super(),this.session=t,this.dialect=i,this.config={view:e}}static [tL.entityKind]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return tH.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tH.tracer.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))}class i5{constructor(e,t,i){if(this.dialect=e,this.session=t,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(const[r,n]of Object.entries(this._.schema))this.query[r]=new i0(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[r],n,e,t);this.$cache={invalidate:async e=>{}}}static [tL.entityKind]="PgDatabase";query;$with=(e,t)=>{let i=this;return{as:r=>("function"==typeof r&&(r=r(new iM(i.dialect))),new Proxy(new tz.WithSubquery(r.getSQL(),t??("getSelectedFields"in r?r.getSelectedFields()??{}:{}),e,!0),new tW({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new iX({source:e,filters:t,session:this.session})}$cache;with(...e){let t=this;return{select:function(i){return new ix({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e})},selectDistinct:function(i){return new ix({fields:i??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})},selectDistinctOn:function(i,r){return new ix({fields:r??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:i}})},update:function(i){return new iG(i,t.session,t.dialect,e)},insert:function(i){return new iH(i,t.session,t.dialect,e)},delete:function(i){return new iW(i,t.session,t.dialect,e)}}}select(e){return new ix({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new ix({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new ix({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new iG(e,this.session,this.dialect)}insert(e){return new iH(e,this.session,this.dialect)}delete(e){return new iW(e,this.session,this.dialect)}refreshMaterializedView(e){return new i6(e,this.session,this.dialect)}authToken;execute(e){let t="string"==typeof e?tM.sql.raw(e):e.getSQL(),i=this.dialect.sqlToQuery(t),r=this.session.prepareQuery(i,void 0,void 0,!1);return new i2(()=>r.execute(void 0,this.authToken),t,i,e=>r.mapResult(e,!0))}transaction(e,t){return this.session.transaction(e,t)}}class i8{static [tL.entityKind]="Cache"}class i3 extends i8{strategy(){return"all"}static [tL.entityKind]="NoopCache";async get(e){}async put(e,t,i,r){}async onMutate(e){}}async function i4(e,t){let i=`${e}-${JSON.stringify(t)}`,r=new TextEncoder().encode(i);return[...new Uint8Array(await crypto.subtle.digest("SHA-256",r))].map(e=>e.toString(16).padStart(2,"0")).join("")}class i7{constructor(e,t,i,r){this.query=e,this.cache=t,this.queryMetadata=i,this.cacheConfig=r,t&&"all"===t.strategy()&&void 0===r&&(this.cacheConfig={enable:!0,autoInvalidate:!0}),this.cacheConfig?.enable||(this.cacheConfig=void 0)}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static [tL.entityKind]="PgPreparedQuery";joinsNotNullableMap;async queryWithCache(e,t,i){if(void 0===this.cache||(0,tL.is)(this.cache,i3)||void 0===this.queryMetadata||this.cacheConfig&&!this.cacheConfig.enable)try{return await i()}catch(i){throw new ii(e,t,i)}if(("insert"===this.queryMetadata.type||"update"===this.queryMetadata.type||"delete"===this.queryMetadata.type)&&this.queryMetadata.tables.length>0)try{let[e]=await Promise.all([i(),this.cache.onMutate({tables:this.queryMetadata.tables})]);return e}catch(i){throw new ii(e,t,i)}if(!this.cacheConfig)try{return await i()}catch(i){throw new ii(e,t,i)}if("select"===this.queryMetadata.type){let r=await this.cache.get(this.cacheConfig.tag??await i4(e,t),this.queryMetadata.tables,void 0!==this.cacheConfig.tag,this.cacheConfig.autoInvalidate);if(void 0===r){let r;try{r=await i()}catch(i){throw new ii(e,t,i)}return await this.cache.put(this.cacheConfig.tag??await i4(e,t),r,this.cacheConfig.autoInvalidate?this.queryMetadata.tables:[],void 0!==this.cacheConfig.tag,this.cacheConfig.config),r}return r}try{return await i()}catch(i){throw new ii(e,t,i)}}}class i9{constructor(e){this.dialect=e}static [tL.entityKind]="PgSession";execute(e,t){return tH.tracer.startActiveSpan("drizzle.operation",()=>tH.tracer.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){return Number((await this.execute(e,t))[0].count)}}class re extends i5{constructor(e,t,i,r=0){super(e,t,i),this.schema=i,this.nestedIndex=r}static [tL.entityKind]="PgTransaction";rollback(){throw new ir}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),"boolean"==typeof e.deferrable&&t.push(e.deferrable?"deferrable":"not deferrable"),tM.sql.raw(t.join(" "))}setTransaction(e){return this.session.execute(tM.sql`set transaction ${this.getTransactionConfigSQL(e)}`)}}let rt={arrayMode:!1,fullResults:!0},ri={arrayMode:!0,fullResults:!0};class rr extends i7{constructor(e,t,i,r,n,s,o,a,l){super(t,r,n,s),this.client=e,this.logger=i,this.fields=o,this._isResponseInArrayMode=a,this.customResultMapper=l,this.clientQuery=e.query??e}static [tL.entityKind]="NeonHttpPreparedQuery";clientQuery;async execute(e={},t=this.authToken){let i=(0,tM.fillPlaceholders)(this.query.params,e);this.logger.logQuery(this.query.sql,i);let{fields:r,clientQuery:n,query:s,customResultMapper:o}=this;if(!r&&!o)return this.queryWithCache(s.sql,i,async()=>n(s.sql,i,void 0===t?rt:{...rt,authToken:t}));let a=await this.queryWithCache(s.sql,i,async()=>await n(s.sql,i,void 0===t?ri:{...ri,authToken:t}));return this.mapResult(a)}mapResult(e){if(!this.fields&&!this.customResultMapper)return e;let t=e.rows;return this.customResultMapper?this.customResultMapper(t):t.map(e=>(0,tJ.mapResultRow)(this.fields,e,this.joinsNotNullableMap))}all(e={}){let t=(0,tM.fillPlaceholders)(this.query.params,e);return this.logger.logQuery(this.query.sql,t),this.clientQuery(this.query.sql,t,void 0===this.authToken?rt:{...rt,authToken:this.authToken}).then(e=>e.rows)}values(e={},t){let i=(0,tM.fillPlaceholders)(this.query.params,e);return this.logger.logQuery(this.query.sql,i),this.clientQuery(this.query.sql,i,{arrayMode:!0,fullResults:!0,authToken:t}).then(e=>e.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}}class rn extends i9{constructor(e,t,i,r={}){super(t),this.client=e,this.schema=i,this.options=r,this.clientQuery=e.query??e,this.logger=r.logger??new tI,this.cache=r.cache??new i3}static [tL.entityKind]="NeonHttpSession";clientQuery;logger;cache;prepareQuery(e,t,i,r,n,s,o){return new rr(this.client,e,this.logger,this.cache,s,o,t,r,n)}async batch(e){let t=[],i=[];for(let r of e){let e=r._prepare(),n=e.getQuery();t.push(e),i.push(this.clientQuery(n.sql,n.params,{fullResults:!0,arrayMode:e.isResponseInArrayMode()}))}return(await this.client.transaction(i,ri)).map((e,i)=>t[i].mapResult(e,!0))}async query(e,t){return this.logger.logQuery(e,t),await this.clientQuery(e,t,{arrayMode:!0,fullResults:!0})}async queryObjects(e,t){return this.clientQuery(e,t,{arrayMode:!1,fullResults:!0})}async count(e,t){return Number((await this.execute(e,t)).rows[0].count)}async transaction(e,t={}){throw Error("No transactions support in neon-http driver")}}class rs extends re{static [tL.entityKind]="NeonHttpTransaction";async transaction(e){throw Error("No transactions support in neon-http driver")}}class ro{constructor(e,t,i={}){this.client=e,this.dialect=t,this.options=i,this.initMappers()}static [tL.entityKind]="NeonHttpDriver";createSession(e){return new rn(this.client,this.dialect,e,{logger:this.options.logger,cache:this.options.cache})}initMappers(){tq.setTypeParser(tq.builtins.TIMESTAMPTZ,e=>e),tq.setTypeParser(tq.builtins.TIMESTAMP,e=>e),tq.setTypeParser(tq.builtins.DATE,e=>e),tq.setTypeParser(tq.builtins.INTERVAL,e=>e),tq.setTypeParser(1231,e=>e),tq.setTypeParser(1115,e=>e),tq.setTypeParser(1185,e=>e),tq.setTypeParser(1187,e=>e),tq.setTypeParser(1182,e=>e)}}function ra(e,t,i,r){return new Proxy(e,{get(e,n){let s=e[n];return"function"!=typeof s&&("object"!=typeof s||null===s)?s:r?ra(s,t,i):"query"===n?ra(s,t,i,!0):new Proxy(s,{apply(e,r,s){let o=e.call(r,...s);return"object"==typeof o&&null!==o&&"setToken"in o&&"function"==typeof o.setToken&&o.setToken(t),i(e,n,o)}})}})}class rl extends i5{static [tL.entityKind]="NeonHttpDatabase";$withAuth(e){return this.authToken=e,ra(this,e,(t,i,r)=>"with"===i?ra(r,e,(e,t,i)=>i):r)}async batch(e){return this.session.batch(e)}}function ru(e,t={}){let i,r,n=new iP({casing:t.casing});if(!0===t.logger?i=new tN:!1!==t.logger&&(i=t.logger),t.schema){let e=function(e,t){1===Object.keys(e).length&&"default"in e&&!(0,tL.is)(e.default,tQ.Table)&&(e=e.default);let i={},r={},n={};for(let[s,o]of Object.entries(e))if((0,tL.is)(o,tQ.Table)){let e=(0,tQ.getTableUniqueName)(o),t=r[e];for(let r of(i[e]=s,n[s]={tsName:s,dbName:o[tQ.Table.Symbol.Name],schema:o[tQ.Table.Symbol.Schema],columns:o[tQ.Table.Symbol.Columns],relations:t?.relations??{},primaryKey:t?.primaryKey??[]},Object.values(o[tQ.Table.Symbol.Columns])))r.primary&&n[s].primaryKey.push(r);let a=o[tQ.Table.Symbol.ExtraConfigBuilder]?.(o[tQ.Table.Symbol.ExtraConfigColumns]);if(a)for(let e of Object.values(a))(0,tL.is)(e,t5)&&n[s].primaryKey.push(...e.columns)}else if((0,tL.is)(o,iy)){let e,s=(0,tQ.getTableUniqueName)(o.table),a=i[s];for(let[i,l]of Object.entries(o.config(t(o.table))))if(a){let t=n[a];t.relations[i]=l,e&&t.primaryKey.push(...e)}else s in r||(r[s]={relations:{},primaryKey:e}),r[s].relations[i]=l}return{tables:n,tableNamesMap:i}}(t.schema,iv);r={fullSchema:t.schema,schema:e.tables,tableNamesMap:e.tableNamesMap}}let s=new ro(e,n,{logger:i,cache:t.cache}).createSession(r),o=new rl(n,s,r);return o.$client=e,o.$cache=t.cache,o.$cache&&(o.$cache.invalidate=t.cache?.onMutate),o}function rc(...e){if("string"==typeof e[0])return ru(tb(e[0]),e[1]);if((0,tJ.isConfig)(e[0])){let{connection:t,client:i,...r}=e[0];if(i)return ru(i,r);if("object"==typeof t){let{connectionString:e,...i}=t;return ru(tb(e,i),r)}return ru(tb(t),r)}return ru(e[0],e[1])}(rc||(rc={})).mock=function(e){return ru({},e)};var rh=e.i(18612);let rf=rc(tb(process.env.DATABASE_URL),{schema:rh});e.s(["db",0,rf],77035)},24836,(e,t,i)=>{t.exports=e.x("https",()=>require("https"))},21517,(e,t,i)=>{t.exports=e.x("http",()=>require("http"))},92509,(e,t,i)=>{t.exports=e.x("url",()=>require("url"))},6461,(e,t,i)=>{t.exports=e.x("zlib",()=>require("zlib"))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__725e72e2._.js.map